<!doctype html><html lang=zh-CN><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Webhooks in Kubernetes | wd and cc</title>
<link rel=canonical href=https://wdicc.com/webhooks-in-kubernetes/><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:url" content="https://wdicc.com/webhooks-in-kubernetes/"><meta property="og:site_name" content="wd and cc"><meta property="og:title" content="Webhooks in Kubernetes"><meta property="og:description" content="Kubernetes allows us to hook on API request chain to do some specific checks or modifies.
Kubernetes API access control There are two types of control. One is to control which user(token, group) is allowed to access, the other one is to control which resource a user could access. The kube-apiserver has two arguments to allow users to define that."><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-28T09:38:59+08:00"><meta property="article:modified_time" content="2022-08-28T09:38:59+08:00"><meta property="article:tag" content="Kubernetes"><meta property="article:tag" content="Webhook"><meta name=twitter:card content="summary"><meta name=twitter:title content="Webhooks in Kubernetes"><meta name=twitter:description content="Kubernetes allows us to hook on API request chain to do some specific checks or modifies.
Kubernetes API access control There are two types of control. One is to control which user(token, group) is allowed to access, the other one is to control which resource a user could access. The kube-apiserver has two arguments to allow users to define that."><link rel=stylesheet href=https://wdicc.com/css/styles.94f653e9e151e28067a7c5dbbc4600cbd5a3c721e79faaf971e523c40f3b249b8e4f20bb57810dfffa8d559ca5c140fd56eb4cd9c0853113ad08e66afdb08bdd.css integrity="sha512-lPZT6eFR4oBnp8XbvEYAy9WjxyHnn6r5ceUjxA87JJuOTyC7V4EN//qNVZylwUD9VutM2cCFMROtCOZq/bCL3Q=="><link rel=stylesheet href=https://wdicc.com/wdicc.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://wdicc.com/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/tags>Tags</a></li><li><a href="https://www.google.com.hk/search?sitesearch=https%3A%2F%2Fwdicc.com%2F&amp;q=">Search</a></li><li><a href=/atom.xml>Subscribe</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://wdicc.com/debugging-iptables/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=https://wdicc.com/use-kubeconform-to-validate-manifests-locally/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f&text=Webhooks%20in%20Kubernetes" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f&title=Webhooks%20in%20Kubernetes" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f&is_video=false&description=Webhooks%20in%20Kubernetes" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Webhooks%20in%20Kubernetes&body=Check out this article: https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f&title=Webhooks%20in%20Kubernetes" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f&title=Webhooks%20in%20Kubernetes" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f&name=Webhooks%20in%20Kubernetes&description=Kubernetes%20allows%20us%20to%20hook%20on%20API%20request%20chain%20to%20do%20some%20specific%20checks%20or%20modifies.%0aKubernetes%20API%20access%20control%20There%20are%20two%20types%20of%20control.%20One%20is%20to%20control%20which%20user%28token%2c%20group%29%20is%20allowed%20to%20access%2c%20the%20other%20one%20is%20to%20control%20which%20resource%20a%20user%20could%20access.%20The%20kube-apiserver%20has%20two%20arguments%20to%20allow%20users%20to%20define%20that." aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f&t=Webhooks%20in%20Kubernetes" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Webhooks in Kubernetes</h1><div class=meta><span class=author itemprop=author itemscope itemtype=http://schema.org/Person><span itemprop=name>wd</span></span><div class=postdate><time datetime="2022-08-28 09:38:59 +0800 +0800" itemprop=datePublished>2022-08-28</time></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/kubernetes rel=tag>kubernetes</a>
,
<a class=tag-link href=/tags/webhook rel=tag>webhook</a></div></div></header><div id=toc><nav id=TableOfContents><ul><li><a href=#headline-1>Kubernetes API access control</a></li><li><a href=#headline-2>Admission webhook</a></li><li><a href=#headline-3>Conversion webhook for CRD</a></li></ul></nav></div><div class=content itemprop=articleBody><p>Kubernetes allows us to hook on API request chain to do some specific checks or modifies.</p><div id=outline-container-headline-1 class=outline-2><h2 id=headline-1>Kubernetes API access control</h2><div id=outline-text-headline-1 class=outline-text-2><p>There are two types of control. One is to control which user(token, group) is allowed to access, the other one is to control which resource a user could access. The kube-apiserver has two arguments to allow users to define that.</p><ul><li>Authentication: <a href=https://kubernetes.io/docs/reference/access-authn-authz/authentication/#webhook-token-authentication>–authentication-token-webhook-config-file</a></li><li>Authorization: <a href=https://kubernetes.io/docs/reference/access-authn-authz/webhook/>–authorization-webhook-config-file</a></li></ul></div></div><div id=outline-container-headline-2 class=outline-2><h2 id=headline-2>Admission webhook</h2><div id=outline-text-headline-2 class=outline-text-2><p><a href=https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#what-are-admission-webhooks>Here</a> is the definition about what admission webhook could do.</p><blockquote><p>Admission webhooks are HTTP callbacks that receive admission requests and do something with them. You can define two types of admission webhooks, validating admission webhook and mutating admission webhook. Mutating admission webhooks are invoked first, and can modify objects sent to the API server to enforce custom defaults. After all object modifications are complete, and after the incoming object is validated by the API server, validating admission webhooks are invoked and can reject requests to enforce custom policies.</p></blockquote><p>So, basically there are two types of admission webhook you could use</p><ul><li>Validating admission webhook</li><li>Mutating admission webhook</li></ul></div></div><div id=outline-container-headline-3 class=outline-2><h2 id=headline-3>Conversion webhook for CRD</h2><div id=outline-text-headline-3 class=outline-text-2><p>Sometimes multiple versions of CRD will be supported at the same time. However, we usually will only allow one version to be stored in ETCD. Because we don't want to maintain the consistency between different versions. Kubernetes allows us to define a <a href=https://kubernetes.io/docs/tasks/extend-kubernetes/custom-resources/custom-resource-definition-versioning/#webhook-conversion>webhook to convert between versions</a> on the fly.</p></div></div></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/tags>Tags</a></li><li><a href="https://www.google.com.hk/search?sitesearch=https%3A%2F%2Fwdicc.com%2F&amp;q=">Search</a></li><li><a href=/atom.xml>Subscribe</a></li></ul></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f&text=Webhooks%20in%20Kubernetes" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f&title=Webhooks%20in%20Kubernetes" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f&is_video=false&description=Webhooks%20in%20Kubernetes" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Webhooks%20in%20Kubernetes&body=Check out this article: https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f&title=Webhooks%20in%20Kubernetes" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f&title=Webhooks%20in%20Kubernetes" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f&name=Webhooks%20in%20Kubernetes&description=Kubernetes%20allows%20us%20to%20hook%20on%20API%20request%20chain%20to%20do%20some%20specific%20checks%20or%20modifies.%0aKubernetes%20API%20access%20control%20There%20are%20two%20types%20of%20control.%20One%20is%20to%20control%20which%20user%28token%2c%20group%29%20is%20allowed%20to%20access%2c%20the%20other%20one%20is%20to%20control%20which%20resource%20a%20user%20could%20access.%20The%20kube-apiserver%20has%20two%20arguments%20to%20allow%20users%20to%20define%20that." aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fwdicc.com%2fwebhooks-in-kubernetes%2f&t=Webhooks%20in%20Kubernetes" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2024 wd and cc</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/tags>Tags</a></li><li><a href="https://www.google.com.hk/search?sitesearch=https%3A%2F%2Fwdicc.com%2F&amp;q=">Search</a></li><li><a href=/atom.xml>Subscribe</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script><script src=/js/code-copy.js></script></html>