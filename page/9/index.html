<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
    
	<title>wd and cc</title>
    <meta name="author" content="wd">
    
	<meta name="description" content="undefined"> <!-- TODO: truncate -->
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="atom.xml" rel="alternate" title="wd and cc" type="application/atom+xml">
	<link href="/favicon.ico" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/custom.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/hljs.css" media="screen, projection" rel="stylesheet" type="text/css">

    <link href='//fonts.googleapis.com/css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Amethysta' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![}]-->

    <script type="text/javascript" src="/javascripts/jquery-tapir.js"></script>

    <!-- remove or comment it to disable ajaxification -->   
    <!-- <script src="/javascripts/ajaxify.js"></script> -->

    

    

</head>


<body>
    <div id="wrapper">
    <header id="header" class="inner"><!-- for more effects see _animate.scss -->
<h1 class="animated bounceInDown">
    <div id="headerbg">
        wd and cc
    </div>
</h1>
<span class="subtitle">happy everyday</span>
<br>

<ul id="social-links" style="text-align:center; clear:both;">
  
  <!-- GitHub -->
  <li>
  <a href="https://github.com/wd" class="github" title="Github"></a>
  </li>
  
  
  
  
  <!-- Twitter -->
  <li>
  <a href="http://www.twitter.com/wd" class="twitter" title="Twitter"></a>
  </li>
  
  
  
  
  
</ul>


<!-- use full url including 'index.html' for navigation bar if you are using ajax -->
<ul id="nav">
	<li id="ajax"><a href="/index.html">Home</a></li>
	<li id="ajax"><a href="/archives/index.html">Archives</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    
    <li>
    <div id="dark">
        <form method="get" action="/search.html" id="search">
            <input name="query" type="text" placeholder="Search..." x-webkit-speech />
        </form>
    </div>
    </li>
        
</ul>




</header>

<div id="toload">
<!-- begin toload -->
    <div id="content" class="inner">
        

    
        <script id="dsq-count-scr" src="//wdicc.disqus.com/count.js" async></script>
    



  <article class="post">
	<h2 class="title">
		<a href="party-with-sssslang-and-xwl/">昨天和 sssslang 和 xwl 聚了个会</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-11-28T16:00:00.000Z" itemprop="datePublished">Nov 29, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/linux/">linux</a> <a href="../tags/mac/">mac</a> <a href="../tags/emacs/">emacs</a>
</div>
    </div>
      
        和 sssslang 倒是很早就见面来着，好像是他那会刚回北京？聊了聊 linux 相关的东西，呵呵。

说起来 linux 用户也挺郁闷的，平时旁边没几个用的，就算是用的，好像也都是 ubuntu 用户，基本就是当 windows 用的，很少主动去挖掘 linux 的一些东西，这些用户比较务实，主要还是在工作方面，开发的东西也都是工作相关的，比较少去做一些无聊的开发。。。所以和他们好像也没什么好聊的。

前两天 #emacs-cn 的 xwl 提议聚会，大家一拍即合，呵呵，定了时间地点，那就聚一个。 :D

聊的东西基本围绕在 emacs， linux， mac 上面。最主要的是 xwl 秀了下他的小黑 macbook 和他的 emacs，sssslang 倒是很详细的问了下 xwl 用的 elisp 扩展，可我对那些不是很明白，我觉得 elisp 就是一个变态的语言。。。对我来说，还记得的可能有下面几个吧。

1 他的 emacs 的标题会显示宋词，会定时变化。
2 有个渐变的扩展，叫做 highlight tail 的，很 cool 吸引小 mm 的必备啊，呵呵。
3 他用了很多定时器，比如执行完编译后，会 split 出来一个新的窗口显示一些编译信息，如果没有错误，那等 3 秒，这个窗口就会自动关掉。还有 1 里面说的那个，也是定时器弄的。
4 有个叫 woman 的东西不错。
5 xwl 和 sssslang 一直强调 ido 是个很不错的东西，不过我是不太明白的。呵呵。
6 xwl 设置打开文件默认就进只读，因为一般来说打开文件都是看看，同时也不可能写很多文件。只读后，还能设置很多单键的快捷键，比如 vim 里面的 hjkli 这些，这样让 emacs 变的有模式起来，我觉得很 cool。不过居然没有别人想到么？那应该有个 vimoper-mod 吧。。。
7 还有个用来画图的 graphviz 很 cool 的。

因为 xwl 用的是 mac，linux 也就是我和 ssslang 了，ssslang 没有本带，基本就是我秀了下我的 kde，openbox，conky 这些，好像也没别的了。<del datetime="2009-11-29T06:17:37+00:00">说到 linux 有个郁闷的，就是我没使用什么 networkmanager，wicd 之类，都是手动配置的 wpa_supplicant ，这样就需要知道 wifi 的 key 的类型什么的，没办法得到的话就只能猜，很不方便。人家 mac， windows， s60 都连上 wifi 上网了，我这还在猜 key 的类型。。。</del> 刚发现，iwlist 实际是能显示 key 信息的。

mac 的效果还是很不错的，国内的很多 mac 用户真是白瞎了这个尤物了，装什么 windows。xwl 可真是 apple 的忠实 fans，花 200 块钱升级系统。。。

说了这么多，我感觉我很像是去打酱油的。。。

说实话 Starbuck 的咖啡好像也不怎么样。。。尤其一会就凉了。。很郁闷，不过回来和老婆说，老婆说：你个傻子，就不知道点一个冰的啊。。。是啊，我为什么没点一个冰的呢？。。。。

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/party-with-sssslang-and-xwl/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="solved-ktorrent-dht-problem/">ktorrent dht 不能用的问题</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-10-30T16:00:00.000Z" itemprop="datePublished">Oct 31, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/linux/">linux</a> <a href="../tags/dht/">dht</a> <a href="../tags/ktorrent/">ktorrent</a>
</div>
    </div>
      
        在国内，没有 dht 的 bt 客户端是混不下去的。

我一直就怀疑国内的 tracker 和那些国内的 bt 客户端是一个利益共同体，那些 tracker 根本就不让别的 client 连的。比如从 ydy 下的 heroes，里面三个 tracker 都是 btfans.3322.org 的，可全部都是 connection refused，虽然从 web 能看到这个这个 torrent 的种子很多，可是我这就是下不了。

这也是国内用户总抱怨 linux 下面的 bt 客户端下载速度慢，或者根本下不了的原因。因为他根本就不能从 tracker 获得信息。要不可以试试看从 mininova 下国外的 torrent，不过好像 thepiratebay 被 gfw 后，这些种子也不好下了。mininova 好多 torrent 的 tracker 是这个。不过好像可以找替代的 tracker 来替换。

一直以来就发现 ktorrent 的 dht 显示的 DHT: 0 nodes, 0 tasks。搜了后发现用户说的都是 ktorrent 2 的，都是 06 年的事情了。之前搜了好几次，都没有结果。

今天为了下 heroes，就又看了下。找到问题在哪里了。

可以去看看 ~/.kde4/share/apps/ktorrent/log 文件，我这里有个 dht bind faild 的错误。原因是设置里面的 network interface 选的是 all，改选一下实际使用的 eth0 就好了。再看看 log 是不是就没错误了？

然后找一个火热的种子下一个，dht 那应该有数了吧？

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/solved-ktorrent-dht-problem/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="kde-openbox-works-perfect/">KDE+openbox 实在太赞了</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-10-12T16:00:00.000Z" itemprop="datePublished">Oct 13, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/linux/">linux</a> <a href="../tags/openbox/">openbox</a> <a href="../tags/kde/">kde</a> <a href="../tags/desktop/">desktop</a>
</div>
    </div>
      
        好像我一闲了就总喜欢换de玩。。可能因为这个最花时间。。汗。。

第一次用 kde 还是过年的时候，那会是 kde 4.1? 好像是，那会还装了一个 kde live , 就是 svn 版的 kde，花了 n 多的时间。。。结果最后实在受不了 kde 的一些 bug，就换回 gnome 了。下面列几个我觉得不能忍的 bug（有些 bug 是在 dualhead 里面才有的）。
1 kconsole 的 tab title 截断居然是从前面开始的？emerge 的时候只能看到最后的几个字符。kconsole 里面居然还不能用 shift 增加选区，如果要选几个屏幕的东西，只能慢慢拖。
2 部分 gtk 程序(比如 roxterm)在 kde 里面最大化的时候居然下面还留一条？
3 我想在最上面加一条监控信息，开始试着用 conky, 发现不能控制不让别的程序不复盖他，让他一直显示。那就加了一条 panel，写了一个 applet 来监控。结果发现经常出现正常重启之后，上面的 panel 没了，下面的 panel 做的调整也没了。回复到了最初的状态。日啊。
4 pidgin 什么的，有时候一些程序不能用快捷键弄到前台。好像有最大化窗口的时候容易出现。
5 还没想起来，不过上面那几个已经让我不能忍了。

kde 换了 gnome 之后用了一段时候，又换用了一下 kde 4.2 好像还是不习惯，直接就换用 openbox+tint2 了。一直到前几天又闲了。。

openbox + tint2 其实也挺好用的，自定义性很强。可有点郁闷的是，他倒底不是 DE，我就懒的去弄那个 ivman ... 

还好有 kde+openbox.用了 openbox 后，上面说的 1,2,3,4 都没问题了。term 用 roxterm , 监控用 conky， 不是一般的爽。

之前 openbox 有个 bug，http://bugzilla.icculus.org/show_bug.cgi?id=3792 和 
http://bugzilla.icculus.org/show_bug.cgi?id=3773 ，那个 patch 可以用。所以现在 kde+openbox 不是一般的爽啊。哈哈。

openbox 那么多的自定义功能，还有 kde 强大的 DE 功能。现在我的桌面如下
<img src="http://paste.ubuntu.org.cn/i45608" alt="dekstop">

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/kde-openbox-works-perfect/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="radeon-kms-in-kernel-2-6-31/">kernel 2.6.31 给 radeon 用上 kms</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-09-12T16:00:00.000Z" itemprop="datePublished">Sep 13, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/linux/">linux</a> <a href="../tags/kms/">kms</a> <a href="../tags/radeon/">radeon</a>
</div>
    </div>
      
        intel 显卡用户享受 gem 已经很久了，kernel 2.6.31 总算给 ati 卡的用户带来了福音。

首先得在 kernel 里面打开相关的选项
Generic Driver Options --> Graphics support --> 这下面 dri 相关的和几个 fb 相关的，看着选吧。
Staging drivers --> 取消Exclude Staging drivers from being built --> Enable modesetting on radeon by default

编好后重启下，然后看看 dmesg |grep -i drm 看看，有下面这行就好了。
[drm] Initialized radeon 2.0.0 20080528 for 0000:01:00.0 on minor 0

然后再看看 /var/log/Xorg.0.log ，有没有这个，这个应该表示相关的 x 软件还没有支持。
(EE) RADEON(0): [dri] RADEONDRIGetVersion failed because of a version mismatch.
[dri] radeon kernel module version is 2.0.0 but version 1.17.0 or newer is needed.
[dri] Disabling DRI.

$ glxinfo |grep -i render
direct rendering: Yes
OpenGL renderer string: Software Rasterizer

接下来就升级几个包的 9999 版本，这几个 ebuild 在 x11 overlay 里面有
# x11-drivers/xf86-video-ati-9999
# media-libs/mesa-9999
# x11-libs/libdrm-9999 

装好后，重启下 x ，看看上面那几个信息。/var/log/Xorg.0.log 里面应该有 KMS 相关的信息了，glxinfo 如下
$ glxinfo |grep -i render
direct rendering: Yes
OpenGL renderer string: Mesa DRI R300 (RV380 5460) 20090101 x86/MMX/SSE2 TCL DRI2


好，o 了。不过我怎么觉得窗口切换好像没那么流畅了？。。。等会看看，不行还得换回去。。。汗。。。
update:  找到一个 bug url , 不知道是不是一样的 http://bugs.freedesktop.org/show_bug.cgi?id=23085 不过里面说应该已经解决了才对。。xf86-video-ati 我用的也是最新版的呀

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/radeon-kms-in-kernel-2-6-31/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="fonts-in-gentoo/">gentoo 里面字体</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-08-30T16:00:00.000Z" itemprop="datePublished">Aug 31, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/linux/">linux</a>
</div>
    </div>
      
        ubuntu 做了一个好事，给好几个包打了个补丁，让字体效果达到了空前的好效果。在 gentoo 里面也可以用这几个补丁。

这几个包是下面这几个。在 devnull 这个 overlay 里面有打了补丁的包，版本更新也能跟得上 portage ，建议直接加这个 overlay。
media-libs/fontconfig
media-libs/freetype
x11-libs/libXft
x11-libs/cairo

加了 devnull overlay 后，加一个全局的 ubuntu 的 use（或许再加一个-cleartype 的use, 这两个 use 是互相冲突的，效果好像差不多）。

然后重新 emerge 那几个包，要注意看装的是不是都是 overlay 里面的。

装好后，执行 eselect fontconfig list 看看，应该多了一些东东。
  [1]   10-antialias.conf *
  [2]   10-autohint.conf
  [3]   10-hinting.conf *
  [4]   10-hinting-full.conf
  [5]   10-hinting-medium.conf *
  [6]   10-hinting-slight.conf
  [7]   10-no-sub-pixel.conf
  [8]   10-sub-pixel-bgr.conf
  [9]   10-sub-pixel-rgb.conf *
  [10]  10-sub-pixel-vbgr.conf
  [11]  10-sub-pixel-vrgb.conf
  [12]  10-unhinted.conf

最主要就这几个了吧，看看那个 *，按照这个选了，然后程序启动一下 fx 看看效果。
<del datetime="2009-11-29T15:06:28+00:00">那个 10-hinting-* 可以试试看 full 和 slight，看喜欢哪种效果了。</del> 见鬼了，今天又发现字体好像不怎么好看了，然后折腾了会，发现用 autohint 的效果是最好的。。。晕了。。 2008-11-29.

这样设置好之后，就不需要在 local.conf 里面设置相关的了。我的 local.conf 里面只是修改了一下 sans sans-serif 等的排序。对了我用的是雅黑+consolas ，效果大概就是这个吧 http://twitpic.com/7dg2q 。抓这个图后好像还改了些东西，还是有些变化的。

建议还是用这个 eselect 来调整字体吧。

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/fonts-in-gentoo/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="post-use-my-g1/">post use my g1</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-08-15T16:00:00.000Z" itemprop="datePublished">Aug 16, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/heart/">heart</a> <a href="../tags/test/">test</a>
</div>
    </div>
      
        好像还是不错的 呵呵

信<strong>春哥</strong>

<blockquote>得永生</blockquote>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/post-use-my-g1/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="use-pdnsd-cache-you-dns-record/">使用 pdnsd 来缓存 dns</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-07-27T16:00:00.000Z" itemprop="datePublished">Jul 28, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/linux/">linux</a> <a href="../tags/dns/">dns</a> <a href="../tags/pdnsd/">pdnsd</a>
</div>
    </div>
      
        如果你的网络实在很快，好像也没这个必要。当然我用他还有一个目的就是我的 dns 我做主，省的被劫持。

打开一个网页有时候 dns 查询就占了一些时间，如果想把这个时间也节省下来，那可以试试看这个。类似的软件还有 dnsmasq，我觉得 dnsmasq 没 pdnsd 灵活一点，反正基本的缓存功能肯定是都有的。。。我这还有同事用 bind 做缓存，呵呵，选什么看各自喜好了。

我用的 wicd, 他会修改 /etc/resolv.conf 这个文件，就算在他的设置里面设置了全局 dns 也没用。不过还好他提供了一个 /etc/resolv.conf.head 文件。这个文件里面的东西会被放到 /etc/resolv.conf 的开头。所以我在那里面写上了 nameserver 127.0.0.1。

具体到 pdns 的设置，好像我也没改什么。
<pre class="prettyprint lang-conf">
server {
	label = "opendns";
	ip = 202.181.224.2, 202.181.202.140;
	#ip = 208.67.222.222, 208.67.220.220;
#	reject = 208.69.32.0/24,  # You may need to add additional address ranges
#	         208.69.34.0/24,  # here if the addresses of their search engines
#	         208.67.219.0/24; # change.
	reject_policy = fail;     # If you do not provide any alternative server
	                          # sections, like the following root-server
	                          # example, "negate" may be more appropriate here.
	timeout = 4;
	uptest = ping;            # Test availability using ICMP echo requests.
   ping_timeout = 100;       # ping test will time out after 10 seconds.
	interval = 15m;           # Test every 15 minutes.
	preset = off;
	policy=included;
	exclude=".abc.com";
}

server {
	label = "yahoo";
	ip = 10.62.163.4, 10.62.163.9;
	timeout = 4;
	uptest = ping;
	ping_timeout = 100;
	interval = 15m;
}
</pre>

我设置两个 server。第一个解析除了 .abc.com 之外的，第二个解析 .abc.com 。这个 abc.com 实际上是我们内网的一个地址，只能在内网 dns 解析。

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/use-pdnsd-cache-you-dns-record/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="fbsplash-howto/">给系统加上 fbsplash 支持</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-07-24T16:00:00.000Z" itemprop="datePublished">Jul 25, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/linux/">linux</a> <a href="../tags/fbsplash/">fbsplash</a>
</div>
    </div>
      
        先贴几个参考文章。
<li>1 <a href="http://forums.gentoo.org/viewtopic-t-728450-highlight-grub2.html" target="_blank" rel="external">HOWTO: Fancy Grub and fbsplash on a machine with Intel graphic chipsets</a></li>
<li>2 <a href="http://www.gentoo-wiki.info/Fbsplash" target="_blank" rel="external">Fbsplash</a></li>
<br>
这两个文章里面最重要是那些内核选项的支持，弄好了那些才有下面的内容。里面有个要注意的是 General Setup ---> Initial RAM filesystem and RAM disk (initramfs/initrd) support ---> Built-in initramfs compression mode 这个选项，好像是从 2.6.30 出来的。这个压缩模式选的是什么，关系到后面的工作。

安装 splashutils[fbcondecor] 和 media-gfx/splash-themes-gentoo 或 media-gfx/splash-themes-livecd 这两个都是提供一些 theme，在 /etc/splash 目录下面。

我的 kernel 没有 initrd 文件，是编译到内核的，所以这么做。
<pre class="prettyprint lang-bash">
cd /usr/src/linux && make && make install # recompile kernel, this is my way
</pre>

然后就是设置内核参数，下面是我的。那个 quiet 会让 kernel 不显示信息，如果你不想，那就去掉。
video=uvesafb:1024x768-32,mtrr:3,ywrap quiet splash=silent,theme:natural_gentoo console=tty1 fbcon=scrollback:64K

如果用的是 tuxonice 内核，那还可以给 sys-apps/tuxonice-userui 加上 fbsplash use，装好后会提示你 ln 一个 splash theme 为 tuxonice ，照做就是了。另外还需要在内核里面 Power management and ACPI options ---> Enhanced Hibernation (TuxOnIce) ---> Default userui program location 设置为 /sbin/tuxoniceui_fbsplash ，重编内核。。。

这么弄完之后会发现，休眠后再启动的时候会显示一个没找到 /sbin/tuoniceui_fbsplash 的错误，还有一些百分比，这些实际上不影响正常启动。不过好像有点影响美观。我琢磨了下，觉得那个错误可能是没有把那个文件弄到 initramfs 里面的缘故，弄进去之后果然没了，不过还是有那个百分比出来。

先 cp 一份这个文件 /usr/src/linux/usr/initramfs_data.cpio[看压缩设置] 到临时目录，file 看看属性，我的是 gzip 压缩的，那就解压一下。然后用 cpio 看下里面的文件。
<pre class="prettyprint lang-bash">
$ file initramfs_data.cpio 
initramfs_data.cpio: gzip compressed data, was "initramfs_data.cpio", from Unix, last modified: Sat Jul 25 19:26:29 2009
$ mv initramfs_data.cpio initramfs_data.cpio.gz
$ gzip -d initramfs_data.cpio.gz 
$ file initramfs_data.cpio 
initramfs_data.cpio: ASCII cpio archive (SVR4 with no CRC)
$ cpio --list < initramfs_data.cpio
.
lib
lib/splash
lib/splash/sys
lib/splash/proc
sbin
sbin/v86d
sbin/fbcondecor_helper
sbin/splash_helper
root
dev
dev/mem
dev/tty1
dev/fb
dev/tty0
dev/zero
dev/misc
dev/null
dev/vc
dev/console
etc
etc/splash
etc/splash/luxisri.ttf
etc/splash/natural_gentoo
etc/splash/natural_gentoo/1024x768.cfg
etc/splash/natural_gentoo/images
etc/splash/natural_gentoo/images/silent-1024x768.jpg
etc/splash/natural_gentoo/images/verbose-1024x768.jpg
xxx blocks
$ cat f
sbin/tuxoniceui_fbsplash
$ ls sbin
tuxoniceui_fbsplash
$ cpio -ov --format=newc -A -O initramfs_data.cpio < f
sbin/tuxoniceui_fbsplash
xxx blocks
$ gzip -c initramfs_data.cpio initramfs_data.cpio.gz
$ mv initramfs_data.cpio.gz /usr/src/linux/usr/initramfs_data.cpio
</pre>

ok， 这里你可以再看看文件里面的东西。没问题就可以复制过去了，要注意压缩格式。

回头录一个视频放上来玩玩，呵呵。

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/fbsplash-howto/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="grub2-fbsplash-in-gentoo/">grub2 fbsplash in gentoo</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-07-24T16:00:00.000Z" itemprop="datePublished">Jul 25, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/linux/">linux</a> <a href="../tags/hibernate/">hibernate</a> <a href="../tags/fbsplash/">fbsplash</a> <a href="../tags/grub2/">grub2</a>
</div>
    </div>
      
        http://v.youku.com/v_show/id_XMTA4MDAwMjI0.html

<embed src="http://player.youku.com/player.php/sid/XMTA4MDAwMjI0/v.swf" quality="high" width="480" height="400" align="middle" allowscriptaccess="sameDomain" type="application/x-shockwave-flash">

具体方法参考下面的文章
<li>1 <a href="http://wdicc.com/fbsplash-howto/">给系统加上 fbsplash 支持</a></li>
<li>2 <a href="http://wdicc.com/how-to-use-grub2/">使用 grub2</a></li>

视频最后从 休眠 启动后，提示了一个 xtrlock 的错误，应该是刚进桌面就休眠引起的，正常情况应该是启动后会锁定屏幕。

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/grub2-fbsplash-in-gentoo/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="how-to-use-grub2/">使用 grub2</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-07-23T16:00:00.000Z" itemprop="datePublished">Jul 24, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/linux/">linux</a> <a href="../tags/grub/">grub</a>
</div>
    </div>
      
        看到 ub 要默认用 grub2 了，看来这个东西够稳定了，就折腾了下。过程还有点头大，呵呵。这个东西最大的问题就是文档怎么那么少？。。。

国内的大都是抄的 <a href="http://linuxtoy.org/archives/grub-2-installation-and-configuration.html" target="_blank" rel="external">这个</a> ，里面不知道为什么没有排版，那个样例用的是 debian，我用的 gentoo，有点小区别。

gentoo 里面先 keyword unmask grub 1.96，然后安装他。
<pre class="prettyprint lang-bash">echo "=sys-boot/grub-1.96 **">

安装之后，先重新生成 device.map。然后执行 update-grub 生成 grub 的一些配置文件，这个生成是根据的 /etc/grub.d 下面的文件，如果有兴趣可以去配置，我反正没配置，我手动修改的配置文件。
<pre class="prettyprint lang-bash">
sudo update-grub # 不是必须，可以手动生成配置文件</pre>

现在去看看 /boot/grub/grub.cfg 文件，里面应该会根据你的系统生成了一些东西。再改巴改巴，下面是我的。对了这个文件是只读的，改一下属性就好了。
<pre class="prettyprint lang-conf">
set default=0
set timeout=5
set root=(hd0,1)

insmod terminal
insmod gfxterm
insmod vbe
insmod font
insmod png

font /boot/grub/unifont.pff
set gfxmode=1024x768
terminal gfxterm

set menu_color_normal=white/black
set menu_color_highlight=white/dark-gray

#background_image /boot/grub/bg.tga
background_image /boot/grub/dev2.png


### END /etc/grub.d/00_header ###

### BEGIN /etc/grub.d/10_hurd ###
### END /etc/grub.d/10_hurd ###

### BEGIN /etc/grub.d/10_linux ###
menuentry "无敌Gentoo" {
	linux	/vmlinuz root=/dev/hda5 ro video=uvesafb:1024x768-32,mtrr:3,ywrap
}

menuentry "Gentoo (old kernel)" {
	linux /vmlinuz-old root=/dev/hda5 ro video=uvesafb:1024x768-32,mtrr:3,ywrap
}

menuentry "测试JPEG背景图片" {
  background_image /boot/grub/dev.tga
}


#title		Gentoo bootchartd
#root		(hd0,0)
#kernel		/vmlinuz root=/dev/hda5 video=uvesafb:1024x768-32,mtrr:3,ywrap init=/sbin/bootchartd
#savedefault
#
#
#title		Gentoo (rescue)
#root		(hd0,0)
#kernel		/vmlinuz root=/dev/hda5 init=/bin/bb
#savedefault
</pre>

注意后面两个注释，其实就是老的 grub 用的，对照一下就应该知道怎么改了。原来的 hd0,0 变成了 hd0,1 ，这个是需要注意的。

那个背景图片是有要求的，我的用 file 查看是这样的 "dev.png: PNG image, 800 x 600, 8-bit/color RGBA, non-interlaced"，具体对 png jpg tga 的要求，还是去看 <a href="http://grub.enbug.org/FranklinPiat/grub.cfg.manpage" target="_blank" rel="external">man</a> 吧。我试了 tga 文件，好像有点慢，我那个 png 速度还行。

那个 font 是从 <a href="http://grub4dos.sourceforge.net/grub2/unifont.pff" target="_blank" rel="external">这里</a> 下的，支持中文。

配置好之后执行 sudo grub-install /dev/hda 就安装好了，没什么错误的话就可以重启看效果了。
</pre>
      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/how-to-use-grub2/#disqus_thread">Comments</a></span>
	
</div>
</article>


  <nav id="pagenavi">
    
        <a href="/page/8/" class="prev">Prev</a>
    
    
        <a href="/page/10/" class="next">Next</a>
    
  <div class="center"><a href="/archives/index.html">Blog Archives</a></div>
  </nav>


    </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2016

    wd
. Powered by <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> |
    Theme is <a href="https://github.com/wd/hexo-fabric">hexo-fabric</a>, fork from <a href="http://github.com/panks/fabric">fabric</a> by <a href="http://panks.me">Pankaj Kumar</a>
</div>


    </footer>
    <script src="/javascripts/fabric.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script>
 <!-- Delete or comment this line to disable Fancybox -->



<!-- end toload --> 
</div>
</div>
<script src="/javascripts/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery); 
/*]]>*/
</script><!-- remove it to remove the scroll to top button -->
</body>
</html>
