<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
    
	<title>wd and cc</title>
    <meta name="author" content="wd">
    
	<meta name="description" content="undefined"> <!-- TODO: truncate -->
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="atom.xml" rel="alternate" title="wd and cc" type="application/atom+xml">
	<link href="/favicon.ico" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/custom.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/hljs.css" media="screen, projection" rel="stylesheet" type="text/css">

    <link href='//fonts.googleapis.com/css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Amethysta' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![}]-->

    <script type="text/javascript" src="/javascripts/jquery-tapir.js"></script>

    <!-- remove or comment it to disable ajaxification -->   
    <!-- <script src="/javascripts/ajaxify.js"></script> -->

    

    

</head>


<body>
    <div id="wrapper">
    <header id="header" class="inner"><!-- for more effects see _animate.scss -->
<h1 class="animated bounceInDown">
    <div id="headerbg">
        wd and cc
    </div>
</h1>
<span class="subtitle">happy everyday</span>
<br>

<ul id="social-links" style="text-align:center; clear:both;">
  
  <!-- GitHub -->
  <li>
  <a href="https://github.com/wd" class="github" title="Github"></a>
  </li>
  
  
  
  
  <!-- Twitter -->
  <li>
  <a href="http://www.twitter.com/wd" class="twitter" title="Twitter"></a>
  </li>
  
  
  
  
  
</ul>


<!-- use full url including 'index.html' for navigation bar if you are using ajax -->
<ul id="nav">
	<li id="ajax"><a href="/index.html">Home</a></li>
	<li id="ajax"><a href="/archives/index.html">Archives</a></li>
	<li id="ajax"><a href="/tags/index.html">Tags</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    
    <li>
    <div id="dark">
        <form action="//www.google.com.hk/search" method="get" accept-charset="UTF-8" id="search">
            <input type="hidden" name="sitesearch" value="https://wdicc.com" />
            <input type="text" name="q" results="0" placeholder="Search..." x-webkit-speech />
        </form>
    </div>
    </li>
        
</ul>




</header>

<div id="toload">
<!-- begin toload -->
    <div id="content" class="inner">
        

    
        <script id="dsq-count-scr" src="//wdicc.disqus.com/count.js" async></script>
    



  <article class="post">
	<h2 class="title">
		<a href="sendmail-pm/">无聊又写一个用来发邮件的 pm..</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2010-07-08T16:00:00.000Z" itemprop="datePublished">Jul 9, 2010</time>
</div>
      <div class="tags">Tags: 

<a href="/tags/linux/">linux</a> <a href="/tags/sendmail/">sendmail</a> <a href="/tags/perl/">perl</a>
</div>
    </div>
      
        
继使用 perl 发<a href="http://wdicc.com/sendmail-use-perl/">中文标题邮件</a>，和<a href="http://wdicc.com/sned-mail-with-attachment/">中文附件邮件</a>后，又把他们整合了一下写了一个 pm 干这个事。

其实发带附件的邮件应该是有现成的 pm 干这个事的，比如 MIME::Lite 之类，没特殊需求还是用那个吧，这个纯属无聊写的。

文件前面有使用方法。。

<pre class="prettyprint">
package SendMail;

use strict;
use warnings;
use Data::Dumper;
use Encode;
use MIME::Base64;

=head1 Examples
use SendMail;

my $sm = SendMail->new( {
    To => 'you@foo.com, other@bar.com',
    Subject => 'just a test 中文',
    });

-- or --

my $sm = SendMail->new( {
    From => 'me@abc.com',
    To => 'you@foo.com, other@bar.com',
    Subject => 'just a test 中文',
    } );

-- or --

my $sm = SendMail->new( {
    From => 'me@abc.com',
    To => 'you@foo.com, other@bar.com',
    Cc => 'cc@foobar.com',
    Subject => 'just a test 中文',
    } );


$sm->attach( {
    Type => "text/plain",
    Data => "只是一个测试..a test"
    });

$sm->attach( {
    Type => 'application/octet-stream',
    Filename => 'test 中文.txt',
    Data => "只是一个 test ..."
    });

$sm->test;

-- or --

$sm->send;

=cut



use vars qw($VERSION);
$VERSION = '0.01';

our $boundary = "FFFFFFFFKKKKKK";
our $from = 'no-reply@abc.com';
our $subject = "No subject";

our $to;
our $cc;
our @body;


sub new {
    my $package = shift;
    my $info = shift;

    $subject = $info->{Subject} || $subject;
    $subject = encode('MIME-B', decode('utf8', $subject));
    $from = $info->{From} || $from;
    $to = $info->{To} || die "Need to set MailTo 'To'!";
    $cc = $info->{Cc} || "";

    push @body, "MIME-Version: 1.0";
    push @body, "Content-Type: multipart/mixed; boundary=\"$boundary\"";
    push @body, "";

    return bless( {}, $package);
}

sub attach {
    my $self = shift;
    my $f_hash = shift;

    die "Need data when attach!" if ( not defined $f_hash->{Data} );

    my $type = "text/plain";
    $type = $f_hash->{Type} if defined $f_hash->{Type};

    my @t;
    push @t, "--$boundary";
    if ( $type eq "text/plain" ) {
        push @t, "Content-Type: $type; charset=utf-8";
    } else {
        my $filename = "file1.txt";
        $filename = encode('MIME-B', decode('utf8', $f_hash->{Filename})) if defined $f_hash->{Filename};
        push @t, "Content-Type: $type";
        push @t, "Content-Disposition: attachment; filename=$filename";
    }
    push @t, "Content-Transfer-Encoding: base64";
    push @t, "";
    push @t, encode_base64($f_hash->{Data});

    push @body, @t;
}

sub send {
    my $self = shift;

    open(my $fh, '|/usr/sbin/sendmail -t');
    $self->print_to($fh);
    close($fh);
}

sub print_to {
    my $self = shift;
    my $fh = shift;

    push @body, "--$boundary--";

    print $fh "From: $from\r\n";
    print $fh "To: $to\r\n";
    print $fh "Cc: $cc\r\n" if $cc;
    print $fh "Subject: $subject\r\n";

    for ( @body ) {
        print $fh "$_\r\n";
    }
}

sub test {
    my $self = shift;

    open ( my $fh, '>-');
    $self->print_to($fh);
    close($fh);
}

1;
</pre>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="https://wdicc.com/sendmail-pm/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="sned-mail-with-attachment/">使用 perl 发带附件的邮件</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2010-07-04T16:00:00.000Z" itemprop="datePublished">Jul 5, 2010</time>
</div>
      <div class="tags">Tags: 

<a href="/tags/linux/">linux</a> <a href="/tags/sendmail/">sendmail</a> <a href="/tags/perl/">perl</a>
</div>
    </div>
      
        继 <a href="http://wdicc.com/sendmail-use-perl/">上篇</a> 使用 perl 发带中文标题的邮件后，又研究了下发带附件的。

基本差别不大，主要是那个 Content-type 要变一下。那个 boundary 可以自己随便写，和后面的统一就行了。

<pre class="prettyprint lang-perl">
my $title = encode_base64("标题", "");
my $body = encode_base64("邮件正文");
my $attach = encode_base64("附件内容");
my $filename = encode('MIME-B', decode('utf8', "文件中文.txt"))

open(MAIL, '|/usr/sbin/sendmail -t');
 
print MAIL "From: test\@abs.com\r\n";
print MAIL "To: test\@abs.com\r\n";
print MAIL "Subject: =?UTF-8?B?$title?=\r\n";
print MAIL "MIME-Version: 1.0\r\n";
# print MAIL "Content-type: text/plain; charset=utf-8\r\n";
print MAIL <<eof; content-type:="" multipart="" mixed;="" boundary="\"FFFFFFFFKKKKKK\"" --ffffffffkkkkkk="" text="" plain;="" charset="utf-8" content-transfer-encoding:="" base64="" $body="" application="" octet-stream="" content-disposition:="" attachment;="" filename="$filename.csv" $attach="" --ffffffffkkkkkk--="" eof="" close(mail);="" <="" pre="">
</eof;></pre>
      
	</div>

<div class="meta">
	
		<span class="comments"><a href="https://wdicc.com/sned-mail-with-attachment/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="sendmail-use-perl/">使用 perl 发送中文邮件标题乱码</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2010-06-29T16:00:00.000Z" itemprop="datePublished">Jun 30, 2010</time>
</div>
      <div class="tags">Tags: 

<a href="/tags/linux/">linux</a> <a href="/tags/sendmail/">sendmail</a> <a href="/tags/perl/">perl</a>
</div>
    </div>
      
        
代码如下面，解决乱码的方法是使用 base64 编码。

<pre class="prettyprint lang-perl">
use MIME::Base64::Perl;

open(MAIL, '|/usr/sbin/sendmail -t');

my $recver = 'wangdong@abc.com';
my $alertTitle = "中文 asdfsdf sdfsdf sdf sdf s df sd fsd f sd fsd f sdf sdf sdf";
my $alertText = "body ";

my $encoded = encode_base64($alertTitle, "");

print MAIL "From: alert\@abc.com\r\n";
print MAIL "To: $recver\r\n";
print MAIL "Subject: =?UTF-8?B?" . $encoded . "?=\r\n";
print MAIL "MIME-Version: 1.0\r\n";
print MAIL "Content-type: text/plain; charset=utf-8\r\n";
print MAIL "\n";
print MAIL "$alertText";

close(MAIL);
</pre>

这里面 encode_base64 可以把文本做 base64 编码，要注意的是这个方法的第二个参数，是用来把编码结果进行格式化的，会每 76 个字符插入一个这个参数，默认是换行。

如果不是 utf8 的文本，那把里面的 utf8 改一下就好了。

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="https://wdicc.com/sendmail-use-perl/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="emms-coding-system/">emacs 的 emms 里面的乱码</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2010-06-18T16:00:00.000Z" itemprop="datePublished">Jun 19, 2010</time>
</div>
      <div class="tags">Tags: 

<a href="/tags/linux/">linux</a> <a href="/tags/emacs/">emacs</a> <a href="/tags/emms/">emms</a>
</div>
    </div>
      
        <a href="http://www.gnu.org/software/emms/" target="_blank" rel="external">emms</a> 是基于 emacs 的一个播放器，不过其它他做的应该只是管理音乐，具体播放还是靠 mpg123 或 mplayer 这样的程序。

前几天下了一些 mp3, 这两天就又搞了搞 emms。emacser.cn 有篇<a href="http://emacser.com/emms.htm" target="_blank" rel="external">文章</a>就是介绍这个的，就不多说了。主要是被编码问题搞死了。

下载的 mp3 的 tag 是 gbk 的，可是设置了 emms-info-mp3info-coding-system 为 gbk 没效果，而用 mp3info 程序看了 mp3 的 tag，确实是 gbk 的，奇怪了就。后来发现 emms 还带了一个 emms-print-metadata 这个程序，这个程序貌似不需要设置编码，他会出来的结果直接就是 utf8, 可就算用这个 (通过设置 (setq emms-info-functions '(emms-info-libtag)) )，出来的结果还是乱码。

后来突然想起来是不是 cache 的问题，然后就发现有两个地方可能有 cache，一个是 emms-cache.el 一个是 emms-history.el，把这两个对应的 cache 文件删掉，再运行一次 emms 就没问题了。我还设置了下下面的。
<pre class="prettyprint">
(setq emms-cache-file "~/.emacs.d/emms/emms-cache"
      emms-history-file "~/.emacs.d/emms/emms-history")
</pre>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="https://wdicc.com/emms-coding-system/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="backup-gentoo/">备份 gentoo</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2010-05-27T16:00:00.000Z" itemprop="datePublished">May 28, 2010</time>
</div>
      <div class="tags">Tags: 

<a href="/tags/linux/">linux</a> <a href="/tags/gentoo/">gentoo</a> <a href="/tags/backup/">backup</a>
</div>
    </div>
      
        

前段时间换本子，把 gentoo 重装了一遍，记下来一些需要备份的东西。

rc-update
启动列表，从这里面能找到你之前随机启动的东西

world
主动安装的程序列表

kernel
内核的配置文件，换机器后可能需要调整里面的磁盘 cpu 什么的配置

layman
加了什么 overlay

etc.tar.gz
程序的配置文件基本都在这下面，好在这个目录也还不算大

home.tar.gz
有些程序的配置文件在这里面，比如 firefox 什么的，另外比如 kmail 把邮件也存这里面

/opt
我把自己安装的一些程序放到了这里面，这些程序基本都是不依赖别的程序的。如果是需要 make 安装的，一般会写一个 ebuild。

fonts
自己安装的字体，一般放在 /usr/share/fonts/ 下面，看习惯了

stardict dicts
这个一般在 /usr/share/stardict/dic/ 下面，好像放 home 下面也可以，没试过。。

我自己的大概就上面这些了吧，另外还有就是自己的 overlay

备份了这么多东西完全弄好好像也花了好几天时间，当时是在 5.1 前后的时候弄的，好像花了4,5 天？没事还是别折腾了

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="https://wdicc.com/backup-gentoo/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="bcm4312broadcom-stawpa_supplicantkernel2-6-33/">总算搞定了我的无线</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2010-05-04T16:00:00.000Z" itemprop="datePublished">May 5, 2010</time>
</div>
      <div class="tags">Tags: 

<a href="/tags/linux/">linux</a> <a href="/tags/broadcom/">broadcom</a>
</div>
    </div>
      
        本子的网卡是 bcm4312，内核里面是有驱动支持的，只要编译了，再装一个 firmware 就应该能用了。可我这的表现是开机能连上一会，后面会断，断了后就再也连不上了，只能重启。

没办法，找了半天，看到一个 broadcom-sta 的驱动，这个是 broadcom 官方出的。装的时候刚好赶上了 2.6.33 的内核，这个内核对比 2.6.32 有不少的变化。我记得之前没有先的选项在 .config 里面好像也是可以搜到的，不过是注释的。现在 2.6.33 里面，直接就搜不到了。而安装 broadcom-sta 的时候要求的几个内核选项花了好大功夫才搞定。

比如这个 wireless_ext。make menuconfig 后搜一下，能搜到，不过会发现他没有 Location，只有个 selected by。这就是说，只有满足了那些 selected by 的时候，这个才会被选上。在 selected by 里面，能看到 GELIC_WIRELESS [=n] && NETDEVICES [=y] && NETDEV_1000 [=y] && WLAN [=y] && GELIC_NET [=n] || IPW2100 [=m] && NETDEVICES [=y] && WLAN [=y] && PCI [=y] && CFG80211 [=y] 这样的一些内容。怎么理解呢？这些是按照那些 || 来分割的，竖线左右的是或的关系，不管哪边满足都可以。我在那个长长的列表里面摸索了半天，总算找到一个合适的，那就是先把 ipw2100 这个驱动选上，因为网卡不是这个型号的，所以把这个编译成模块，然后加在 blacklist 里面。

要使用无线，一般还需要一个模块，LIB80211_CRYPT_TKIP，用来支持 wpa 的。这个你在 dmesg | grep lib80 的时候能看到，如果没有 tkip 在里面，那基本应该是连不了 wpa 的网络的。这个模块也是需要选别的模块才能激活，上面选的那个 ipw2100 刚好还用在了这里，呵呵。另外还需要一个 hostap 的模块。

然后 broadcom-sta 还需要把 ssb，mac8012 这些模块关闭，反正按照提示来做就好了，这些都有 location，很好搞定。

装好后，就可以使用 wpa_supplicant 来连接无线了。要注意的是，使用的 driver 不是那个 braodcom，而是 wext。

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="https://wdicc.com/bcm4312broadcom-stawpa_supplicantkernel2-6-33/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="basic-elisp-programing/">elisp 最最初级的一点入门知识</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2010-04-24T16:00:00.000Z" itemprop="datePublished">Apr 25, 2010</time>
</div>
      <div class="tags">Tags: 

<a href="/tags/linux/">linux</a> <a href="/tags/emacs/">emacs</a> <a href="/tags/elisp/">elisp</a>
</div>
    </div>
      
        其实上次写 http://wdicc.com/how-i-became-a-emacser 的时候，是想写一点 eslisp 入门的东西的，结果总觉得好像也写不出来什么，就写成另一篇了，呵呵。(看这篇前最好先看看那个吧，那个更入门。)

不过我还是觉得，用 emacs 如果不会一点 elisp，那基本你是用不住的。记那些无聊的快捷键有什么意思，有意思的是你能让 emacs 用你希望的模式工作。今天 twitter 上面看到一个词"计算姬"，感觉很有点意思，呵呵，小蜜就是给你干活的嘛，不要被她折磨就好。

其实主要是我自我感觉目前了解的 elisp 的东西，好像基本就够用了，所以才想写出来，给比我还糊涂的指条明路。

1 数据类型。
elisp 是有类型在里面的，我看好像有什么 sequence, number 之类，具体有哪些不重要，重要的是你使用的时候，比如比较的时候，切记要弄明白他们是什么类型。我找到一个 format 函数，感觉很好用，可以转类型，具体可以查文档，可以多用用。

2 调试
调一个程序的时候，我觉得最基本的就是 print 和 message 这两个函数了吧，加上上面的 format，基本应该能搞定了。在一段 elisp 后面使用 C-x C-e 就能直接执行他，执行之后就能在当前的 emacs 里面起作用，不过对我等菜鸟来说，有时候会遇到一些奇怪的问题，不行就还是再启动一个 emacs 来验证结果吧。

3 emacs 简单设置
掌握了上面两个，基本就可以定义自己的东西了。一般用的是 setq，比如下面这个
<pre class="prettyprint">
;; 防止页面滚动时跳动， scroll-margin 3 可以在靠近屏幕边沿3行时就开始滚动，可以很好的看到上下文。
(setq scroll-margin 3
            scroll-conservatively 10000)
(set-terminal-coding-system 'utf-8)
(add-to-list 'auto-mode-alist '("\\.py\\'" . python-mode))
</pre>

可以看到他一次设置了两个变量，其实写两个括号也是可以的。

还有下面的两行，他是执行了一个函数，这个函数里面干的什么，他接受什么参数，直接在 emacs 里面按 C-h f 然后输入你要查的函数的名字，就会显示 help 信息，很方便吧。

4 hook
下面稍微高级一点，了解下 hook 怎么用。hook 这个东西翻译过来应该是钩子的意思吧，其实就是别人的程序预留的一些接口，可以让你在他的程序里面插入一些你自己的程序。比如下面这几个。
<pre class="prettyprint">
(add-hook 'weblogger-start-edit-entry-hook (lambda()
    (auto-fill-mode -1)
    (abbrev-mode -1)
    (auto-complete-mode 1)
    ))
(add-hook 'cperl-mode-hook (lambda () (abbrev-mode -1)))
(add-hook 'view-mode-hook 'view-mode-keybinding-hook)

(defun weblogger-edit-entry (&optional entry)
  "Edit a entry.  If ENTRY is specified, then use that entry.
Otherwise, open a new entry."
   ...........
  (run-hooks 'weblogger-start-edit-entry-hook)
)
</pre>

第一个是在 weblogger.el 开始编辑文件的时候，把那些 mode 关掉。第二个是 cperl-mode 启用的时候，把 abbrev-mode 关掉。第三个是在 view-mode-hook 执行的时候，执行那个函数。

最后是在实际代码里面这个 hook 是怎么执行的，能看到当调用 weblogger-edit-entry 的时候，就会在这里面某个时候去执行之前设置的 hook，这样个性化设置的目的就达到了。

eamcs 的各种 mode 一般都有各种的 hook，这应该能完全达到个性化的目的了，可有些时候想定制的地方没有 hook 怎么办？暴力一点，直接改他的程序好了。。。温柔一点的，那就看下面这个。

5 defadvice

defadvice 在文档里面写的很清楚，大概应该是可以在一个已有函数执行前或后执行你定义的东西。比如下面这个。
<pre class="prettyprint">
;; use this to auto cancel notify
;; (add-hook 'erc-send-pre-hook
;;           (lambda(s)
;;             (erc-tray-change-state nil)))
(eval-after-load 'erc
  '(progn
     (defadvice erc-send-input (before change-tray-status activate)
       (erc-tray-change-state nil))))
</pre>

我设置了 erc 在收到消息的时候会发送 notify 到 tray，我想做到只要我在 erc 里面输入了一些东西（即使是空的），就把 tray 的状态标记为已读，就不用继续提醒我了。

erc 有个 erc-send-pre-hook，可以在发送一条消息前执行 hook，可是如果输入的是空行，是不会触发这个 hook 的，使用 defadvice 可以解决这个，具体使用方法还是看文档吧，我突然觉得我很罗嗦。。。。屁大点东西也能发一篇？。。。

我会的基本就说完了，其它高级玩意有需要的时候应该可以从文档里面去看吧，目前来看，会用 hook 和 defadvice 我就知足了，不行就来 irc 里面找牛人问一个，经过提示后，应该还是能解决的吧。反正不求能自己去写一个 mode，当时最少也要能看明白别人的那点东西，然后自己能改一下吧，要不用 emacs 会很痛苦的。

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="https://wdicc.com/basic-elisp-programing/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="how-i-became-a-emacser/">我是怎么从 vim 转向 emacs 的</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2010-04-17T16:00:00.000Z" itemprop="datePublished">Apr 18, 2010</time>
</div>
      <div class="tags">Tags: 

<a href="/tags/linux/">linux</a> <a href="/tags/vim/">vim</a> <a href="/tags/emacs/">emacs</a>
</div>
    </div>
      
        从尝试用 emacs，到现在基本（有些地方还不是很适应）习惯用 emacs，算起来得有 n 年了，我都忘记最早接触 emacs 是什么时候了。在 2010-3-20 之前尝试过很多次，基本都是记几个快捷键，过几天就又忘记了。后来自己想了下为什么不能持续的原因，我觉得有两个。

1 没有在日常工作里面使用。
之前我的开发工作基本都是直接在某台服务器上面的，这样就开发调试会比较方便，而那些机器一般要不会装 emacs，这样不常用就会导致记住的快捷键过几天就忘记了。最近刚好需要在本机写点程序，也就刚好用上了。

2 不会 elisp。
emacs 的配置文件都是 elisp 写的，而不经过配置的 emacs 就编辑文件来看，我觉得还不如去用 vim，vim 好用多了。我想刚看到 elisp 的时候一般都会觉得这个语言太变态了，全是一堆的括号。。。而不会 elisp 就会导致你只能去机械的复制别人的配置，如果刚好是你想要的，那还好，而如果还想做点小的修改，那就会很郁闷，用起来郁闷，不用可能更郁闷。不爽多了，就干脆不用 emacs 了。

如果你能在日常工作中经常使用，并且会写程序（比如 php,perl 什么的，随便哪个都行），那么对于基本没怎么配置过 .vimrc 的用户来说，切换到 emacs 其实应该还算是一个比较简单的事情。

1 emacs 是无模式的。
这就是说你不用经常去按那个 Esc 来切换模式了。没有模式也就意味着你不能使用像 vim 那么简短的命令了，因为像 a,i,o,h,j,k 这些对 emacs 来说，这些都是正常的输入字符，所以我们不得不在这些字符前面加上 C(control), M(Meta 一般是 Alt), S(shift) 这些前缀。在 emacs 里面需要按的可能还远不止这些控制字符加一个普通字符，比如我定义的 C-c n E 来打开 erc。不要被这些吓着了，并不需要你记住所有的，你只要记住你常用的就好了。

2 emacs 里面的 buffer。
打开一个文件，就会出现一个 buffer。调用帮助，也会打开 buffer。使用 emacs 绝对不要和一些自动出现的 buffer 过不去，使用 emacs 的理念就是一个编辑器 n 个 buffer，编辑文件的，看 mail、news 的，上 irc 的等等。你需要的是一个方便的 buffer 切换的工具，推荐的有 ido-mode 和 ibuffer。

3 emacs 里面有各种 mode。
vim 里面是通过设置 filetype(ft) 来达到语法高亮等功能的。emacs 里面是通过各种 mode。emacs 里面有主模式(main mode)，和辅模式(minor mode)。上面说的 ido-mode 就是一个辅模式。打开一个文件后，一般有一个主模式（通过一些方法也可以有多个），多个辅模式。比如我打开一个 js 文件，会同时使用到 js2-mode 这个主模式，和 highlight-tail-mode, autocomplate-mode 这几个辅模式。

4 写点 elisp。
elisp 基本就是一堆的括号，括号最左半边的是操作符或函数，后面的都是他的参数，比如 (- 10 3)，具体这个是什么意思，就要去看看 "-" 是干嘛的，他会对后面的参数做什么事。再比如(setq xwl-at-company? (xwl-at-company))。先去看看那个 setq 是干嘛的，查完好像是设置变量的，他会把第二个参数的值赋给第一个参数。那第二个变量是个表达式，那就等于会把这个表达式的值赋给他，对吧。这个括号表达式是干嘛的呢？xwl-at-company 这个是自己写的函数，不需要参数，他会根据一些信息返回是不是在使用公司的网络。是返回 t，不是返回 nil。ok，这不就明白了么？呵呵。还有一些像 (if, (when, (progn 等等，都是这么个理解方法。
写程序就避免不了调试，最简单的调试方法应该就是直接打印了吧，呵呵。elisp 里面可以使用 print, message 来输出一些调试信息。比如 (print (format "value of t: %s" t))，具体啥意思可以参考前面说的方法去查查。这些信息可以在一个叫 *Messages* 的 buffer 里面看到。

5 emacs 里面的帮助。
C-h 是调用帮助，可以在后面再输入 ？ 来看看有什么可用的帮助。我一般用的是 m（看当前 mode 的一些快捷键设置），k（查某个快捷键是干嘛的），v（查 emacs 变量的值）。

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="https://wdicc.com/how-i-became-a-emacser/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="powerful-git-and-git-svn/">强大的 git 和 git svn</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2010-04-03T16:00:00.000Z" itemprop="datePublished">Apr 4, 2010</time>
</div>
      <div class="tags">Tags: 

<a href="/tags/linux/">linux</a> <a href="/tags/svn/">svn</a> <a href="/tags/git/">git</a>
</div>
    </div>
      
        在春哥的鼓动下，用上了 git。有 git svn 支持，还是很好用的，建议 svn 用户都试试看。

使用 git svn clone SVN_URL 来 clone 初始化你的本地 repo，然后就和 svn 没关系了，直到你需要把你的改动提交到 svn 的 repo。

先说说 git 的一些本地操作，就捡我自己用的说吧，我觉得应该也够用了。

首先 git add 是用来添加文件的，编辑好新的文件后，使用 git add file_name 就能把他加入到 git 里面管理，当然，如果还不打算提交他，那也可以先编辑以后再 add。

然后 git mv 改名，git rm 删文件，这和一般的 linux 命令差不多，就不用多说了。要记得的是，如果想让你的改动加入到 git 的管理里面，那就最好使用这两个文件来改名和删文件。如果直接用 linux 命令操作，比如改名，git 会认为你要删一个文件，并且那个新的文件还没不会加入到管理里面。

然后就是 git status 了。执行这个能看到当前 repo 的分支（例如下面的第一行说的 wd）里面有哪些改动，这个里面的信息应该是能分四类。一类是对文件的操作，比如添加删除文件等(changes to be committed)，这类文件直接使用 git commit 就能提交。一类是对现有文件的修改(changed but not updated)，这类文件使用 git add 添加后也能用 git commit 提交，不过也可以用 git commit -a 直接提交。一类是没有加入到管理的一些文件(untracked files)，这类文件不会被提交，除非你使用 git add 添加他们。好像还有一类，是你的修改如果和上游冲突的时候，这时候会多出来一类，提示你这些文件和上游冲突，打开这些文件，里面有明显的标记会指出冲突是什么，解决冲突后，git add 添加这个文件，再提交就可以了。

<pre class="prettyprint">
# On branch wd
# Changes to be committed:
#   (use "git reset HEAD <file>..." to unstage)
#
#	new file:   a
#
# Changed but not updated:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#	modified:   hello
#
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#	b
</file></file></file></file></pre>

上面捎带说了下 git commit，commit 有个 -m 参数可以直接在后面指定 commit message，就不用打开那个编辑窗口了。另外还有个 --amend 能用来修改最后一次提交的 commit message。commit 后面还可以跟具体的文件或目录来只提交指定的东西。

还需要知道的命令，git log。能看到自己和别人提交的每个 commit 的情况。那个类似 commit 0fb8046e4bd0b5ce44d778e3936bda80e7e0ccd7 的那一长串字符就是 commit id。如果想看具体某个 commit 做了什么，那就执行一下 git show commit_id,能看到一个 diff，很方便的。

git diff file_name 可以用来看自己要提交的文件改动了什么。

git branch 还能建分支，非常的方便。使用 git branch wd 就能建立一个叫 wd 的分支，使用 git branch 就能看到当前有哪些分支，使用 git checkout wd 就能切换到 wd 这个分支，在这个分支做的改动不会影响到 master，随时可以切换回去。然后可以使用 git merge 可以把在某个分支做的变更 merge 进来。比如当前是 master 分支，git merge wd 会把在 wd 这个分支建立后，在 wd 上面做的改动 merge 到 master 里面。不过在不熟练的情况下，还是别使用分支了，呵呵。

如果提交了之后又想撤消，那就要用到 git reset 了。reset 分 mixed，soft，hard 几种，看名字应该能看出了一点什么，hard 会把对文件的改动都撤消，soft 只会删掉提交记录，不会对文件操作。具体这几个区别还是看看 man git reset 吧，这个操作也是稍微有点复杂，容易出问题，没熟悉的情况下慎用。我只用过 soft reset，用来修改 commit message，呵呵。

前面说的这些都是在本地操作的，完全不用管别人的情况，在没有网络的情况下，你也可以提交你的修改。

激动人心的时候到来了，怎么把修改提交到 svn 呢？

如果想要把自己的变更应用到 svn repo，那就要用到 git svn dcommit 了。不过别急，这时候还需要了解下 git svn rebase 命令，这个命令是用来把远程别人的改动应用到本地的，类似于 svn update（不过文档里面说还是有点区别，没看明白）。在 rebase 的过程中，难免会遇到一些冲突，这个时候会有提示信息的，而且在 git status 里面也会提醒你的。这时就需要你先去解决冲突，打开那个文件看看就知道了。解决了后使用 git add 添加那个文件，然后 git svn rebase --continue，直到完成。

这样之后，你就可以用 git svn dcommit 来提交你的修改了。这个命令完事后会自动 rebase 一下，所以好像可以直接使用这个命令而不 rebase 先。

好了，这下改动就提交到了 svn 了，整个过程就完事了。这只是一些基本的用法，应该也足够用了，遇到问题或更深入一点的用法可以看看 git 的 man。

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="https://wdicc.com/powerful-git-and-git-svn/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="about-justice/">看了 12 怒汉 ( 12 Angry Men )</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2010-03-13T16:00:00.000Z" itemprop="datePublished">Mar 14, 2010</time>
</div>
      <div class="tags">Tags: 

<a href="/tags/heart/">heart</a> <a href="/tags/movie/">movie</a> <a href="/tags/emacs/">emacs</a> <a href="/tags/justice/">justice</a> <a href="/tags/thinking/">thinking</a>
</div>
    </div>
      
        
12 怒汉下了好久了，一直没看，正在看，还没看完就忍不住要写点什么。

俄语实在不好听，忍着看了 10 分钟，这个片子就开始吸引人了。12 个陪审团成员，还有其它人，几乎所有人都认为 20 分钟应该就会完事，因为这之前已经听法院审了三天了。在 12 比 1 的情况下，怎么说服其它人同意小孩是无罪的，这就是整个片子的内容。当然是有理有剧的。

当你手里掌握着别人的生命的时候，你会怎么做？今天上午还看了几集哈佛大学的那个关于公正的课，里面几个例子。

如果你是一个电车司机，刹车失灵了，轨道那头是 5 个工人，开过去肯定会把他们撞死，关键时刻你发现有个叉道，那边是 1 个工人，如果你打方向盘的话，那就是撞死一个人，你会怎么做？

再如果司机不是你，没有叉道，而你当时你站在桥上，你旁边有个胖子，如果把那个胖子推下去，车就会停，你会怎么做？

如果你是一个医生，医院来了 6 个病人，其中一个病的很重，其他几个轻一点。如果你救那个病重的，因为需要的时间会很长，那其它几个就会死。如果你先救那 5 个，那么病重的一个就肯定死，你怎么办？

再如果，来了 5 个病人，他们分别需要移植 5 个器官，可是没有现成的。这时候你想起来旁边屋子里面有一个健康的人，如果把他的器官换给那 5 个人的话，那 5 个人就会得救，当然，这个人会死，你会做么？

还有一个真实的案例。4 个人座船出去，路上遇到风暴，逃到了逃生艇上。没有吃的，里面有个孤儿，不听劝告，喝了海水，病的很严重，其它三个人把那个人杀了，然后挺了过去，得到了救助，到了岸上，他们供认了经过。然后你觉得他是有罪还是无罪呢？

之前还看过一个文章，讲什么是民主的。看 <a href="http://tieba.baidu.com/f?kz=126121842" target="_blank" rel="external">这里</a> 吧。

民主就是少数服从多数么？好像不是这样的，那民主是什么呢，我也不知道，gcd 说他们统治的国家就是民主的，可好像我连想上的网站都上不了，还不经过我同意，这个好像不那么民主。那倒底民主是什么呢？

看了明朝那些事，头一次知道原来内阁是可以驳回皇帝的圣旨的，原来也不是说皇帝说什么就算什么的，他也得和大臣讲道理的。如果给你 10 个人让你管，那很简单，是不是，要干什么的时候，一个人一个人和他说明白就好了。如果是 100 个呢？ok，虽然累点，好像也还是可以说清楚的。可如果是 1000 个呢，显然一个一个说就不靠谱了，得想别的办法，那就是从 1000 个人里面选 10 个人，每人分给他们 99 个人，你有什么事，教会这 10 个人就好了，然后由他们去和手下的 99 个人说明白，简单了吧。用这个模式，不管有多少人都可以搞定了，是不是？实际上军队不就是这个模式么。但发现没有，实际上你的权力被分到了那 10 个人的手上，如果他没有和手下的 99 个人表达你的意思，而表达的是他自己的意思，那么。。。皇帝有时候就得面对这个，想让内阁替你办事，那你就得把权力分给他们。

再来说民主。选举其实就是一个分权的过程，你把你的一部分权力分给了你选的代表，如果你都不知道这个代表你的人是男是女，或是太监的时候，这其实是很恐怖的，对吧。

这个片子没想到看到最后居然还转折了一下，有点意思，呵呵。

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="https://wdicc.com/about-justice/#disqus_thread">Comments</a></span>
	
</div>
</article>


  <nav id="pagenavi">
    
        <a href="/page/7/" class="prev">Prev</a>
    
    
        <a href="/page/9/" class="next">Next</a>
    
  <div class="center"><a href="/archives/index.html">Blog Archives</a></div>
  </nav>


    </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2017

    wd
. Powered by <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> |
    Theme is <a href="https://github.com/wd/hexo-fabric">hexo-fabric</a>, fork from <a href="http://github.com/panks/fabric">fabric</a> by <a href="http://panks.me">Pankaj Kumar</a>
</div>


    </footer>
    <script src="/javascripts/fabric.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script>
 <!-- Delete or comment this line to disable Fancybox -->



<!-- end toload --> 
</div>
</div>
<script src="/javascripts/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery); 
/*]]>*/
</script><!-- remove it to remove the scroll to top button -->
</body>
</html>
