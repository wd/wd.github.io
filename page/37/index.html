<!DOCTYPE HTML>
<html>
<head>
	<meta name="generator" content="Hugo 0.19" />
	<meta charset="utf-8">
    
    
    <title>wd and cc</title>
    <meta name="author" content="wd">
    <meta name="description" content="">
    <meta name="keywords" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <link href="https://wdicc.com/index.xml" rel="alternate" title="wd and cc" type="application/atom+xml">
	<link href="/favicon.ico" rel="shortcut icon">
    <link href="/css/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/css/custom.css" media="screen, projection" rel="stylesheet" type="text/css">

    <link href='//fonts.googleapis.com/css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Amethysta' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    

    <script type="text/javascript" src="/js/jquery-tapir.js"></script>

    

    <link rel="stylesheet" href="/css/hljs.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</head>


<body>
    <div id="wrapper">
        <header id="header" class="inner">
<h1 class="animated bounceInDown">
    <div id="headerbg">
        wd and cc
    </div>
</h1>

<span class="subtitle">happy every day</span>
<br>

<ul id="social-links" style="text-align:center; clear:both;">
    
    
    <li>
    <a href="https://github.com/wd" class="github" title="Github"></a>
    </li>
    
    
    
    
    
    <li>
    <a href="http://www.twitter.com/wd" class="twitter" title="Twitter"></a>
    </li>
    
    
    
    
    
</ul>


<ul id="nav">
	<li id="ajax"><a href="/index.html">Home</a></li>
	<li id="ajax"><a href="/archives/index.html">Archives</a></li>
	<li id="ajax"><a href="/tags/index.html">Tags</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    <li>
    <div id="dark">
        <form action="//www.google.com.hk/search" method="get" accept-charset="UTF-8" id="search">
            <input type="hidden" name="sitesearch" value="https://wdicc.com/" />
            <input type="text" name="q" results="0" placeholder="Search..." x-webkit-speech />
        </form>
    </div>
    </li>
</ul>

</header>

<div id="toload">

    <div id="content" class="inner">
        




    
    <script id="dsq-count-scr" src="//wdicc.disqus.com/count.js" async></script>
    




  <article class="post">
    <h2 class="title"> 
        <a href="/use-rsa-and-dsa/">使用ssh的rsa和dsa验证登陆linux</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2006-04-24T00:00:00.000&#43;00:00' itemprop="datePublished">2006-04-24</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/other">other</a>

<a href="/tags/ssh">ssh</a>


</div>
    </div>
        参考地址：http://www.5ilinux.com/ssh01.html<br />

按照文档中的方法，使用SecureCRT生成公匙密匙，然后上传公匙，没问题。<br />

用putty使用这个密匙的时候就出问题了，验证不了。<br />

然后用putty生成公匙密匙，上传公匙，验证不了。<br />

后来用openssh自带的ssh-keygen生成了公匙密匙，然后用putty的keygen转换了一下，用putty登陆就可以了。<br />

    </div>

<div class="meta">
    
    <span class="comments"><a href="/use-rsa-and-dsa/#disqus_thread">Comments</a></span>
    
</div>
</article>

  <article class="post">
    <h2 class="title"> 
        <a href="/limite-ssh-access-ip/">限制ssh访问的ip</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2006-04-24T00:00:00.000&#43;00:00' itemprop="datePublished">2006-04-24</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/other">other</a>

<a href="/tags/ssh">ssh</a>


</div>
    </div>
        ★ 需求<br />

最近公司服务器上面某个用户的帐号密码被修改了好几次。查看了一下，确实有人用他的帐号从外网ip（国外的ip）登陆过，猜想可能是他自己的电脑中木马或者什么病毒了。用户自己没有安全意识是很头痛的一个问题，其实给他们新建帐号的时候使用的都是简单密码，但是似乎都没有人上服务器自己修改，但是你又不能要求你的用户如何如何（比如给自己电脑装防火墙、杀毒软件etc），因为那是人家自己的事情。那么我就想，有没有一个方法可以限制某个用户只能从某个ip（或者ip列表）登陆呢？下面是一些解决方法。<br />

<br><!--more-->★ 解决方案<br />

1) 通过修改/etc/ssh/sshd_config文件，让sshd只监听内网ip。这样只有内网ip才能登陆ssh。但是这样的话就不能远程维护服务器了，有点得不偿失得感觉。<br />

2) 通过修改/etc/hosts.allow和/etc/hosts.deny来限制某个ip的登陆。这个方式其实和上面得类似，你也不知道hacker会从哪个ip登陆，所以你没办法deny他得ip，deny他得时候可能连你自己也deny了。<br />

3) 可以通过/etc/ssh/sshd_config文件来实现。<br />

 &nbsp; &nbsp; AllowUsers<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This keyword can be followed by a list of user name patterns,<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; separated by spaces.&nbsp; If specified, login is allowed only for us-<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; er names that match one of the patterns.&nbsp; Only user names are<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; valid; a numerical user ID is not recognized.&nbsp; By default, login<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; is allowed for all users.&nbsp; If the pattern takes the form US-<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ER@HOST then USER and HOST are separately checked, restricting<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; logins to particular users from particular hosts.&nbsp; The allow/deny<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; directives are processed in the following order: DenyUsers,<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AllowUsers, DenyGroups, and finally AllowGroups.<br />

PATTERNS<br />
 &nbsp; &nbsp; A pattern consists of zero or more non-whitespace characters, `*' (a<br />
 &nbsp; &nbsp; wildcard that matches zero or more characters), or `?' (a wildcard that<br />
 &nbsp; &nbsp; matches exactly one character).&nbsp; For example, to specify a set of decla-<br />
 &nbsp; &nbsp; rations for any host in the ``.co.uk'' set of domains, the following pat-<br />
 &nbsp; &nbsp; tern could be used:<br />

 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Host *.co.uk<br />

 &nbsp; &nbsp; The following pattern would match any host in the 192.168.0.[0-9] network<br />
 &nbsp; &nbsp; range:<br />

 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Host 192.168.0.?<br />

 &nbsp; &nbsp; A pattern-list is a comma-separated list of patterns.&nbsp; Patterns within<br />
 &nbsp; &nbsp; pattern-lists may be negated by preceding them with an exclamation mark<br />
 &nbsp; &nbsp; (`!').&nbsp; For example, to allow a key to be used from anywhere within an<br />
 &nbsp; &nbsp; organisation except from the ``dialup'' pool, the following entry (in au-<br />
 &nbsp; &nbsp; thorized_keys) could be used:<br />

 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; from="!*.dialup.example.com,*.example.com"<br />

比如不允许test用户从192.168.0.x登陆，那么可以添加一行<br />

denyusers test@192.168.0.<br />

按照上面的PATTERNS说明，似乎可以加叹号来排除某个ip，但是尝试过没有成功，不知道什么原因了。<br />

按照文档，deny是级别最高的，而设置了allow之后，就只能allow的用户访问了，所以如果想限制某个用户只能从某个ip段登陆，用这个似乎实现不了。<br />

4) 使用ssh得RSA/DSA key。<br />

参考地址:http://www.5ilinux.com/ssh01.html <br />

用ssh-keygen命令生成一对公匙密匙，然后把密匙给用户，并且限制ssh只能通过RSA方式认证。这样会导致所有ssh用户都得用这种方式登陆了，会更加郁闷。<br />

这种方式可以在用户得authorized_keys2文件中，加入from="!192.168.1.158,*"来让用户只能通过158登陆。（这个没有做过验证）<br />


PATTERNS<br />
 &nbsp; &nbsp; A pattern consists of zero or more non-whitespace characters, `*' (a<br />
 &nbsp; &nbsp; wildcard that matches zero or more characters), or `?' (a wildcard that<br />
 &nbsp; &nbsp; matches exactly one character).&nbsp; For example, to specify a set of decla-<br />
 &nbsp; &nbsp; rations for any host in the ``.co.uk'' set of domains, the following pat-<br />
 &nbsp; &nbsp; tern could be used:<br />

 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Host *.co.uk<br />

 &nbsp; &nbsp; The following pattern would match any host in the 192.168.0.[0-9] network<br />
 &nbsp; &nbsp; range:<br />

 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Host 192.168.0.?<br />

 &nbsp; &nbsp; A pattern-list is a comma-separated list of patterns.&nbsp; Patterns within<br />
 &nbsp; &nbsp; pattern-lists may be negated by preceding them with an exclamation mark<br />
 &nbsp; &nbsp; (`!').&nbsp; For example, to allow a key to be used from anywhere within an<br />
 &nbsp; &nbsp; organisation except from the ``dialup'' pool, the following entry (in au-<br />
 &nbsp; &nbsp; thorized_keys) could be used:<br />

 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; from="!*.dialup.example.com,*.example.com"<br />



5) 用pam。<br />

参考地址:http://www.linuxmine.com/1078.html <br />

看看/etc/pam.d/login文件，有没有pam_access.so的设置。我的debian系统中，ssh相关的都在/etc/pam.d/ssh文件中设置。加入一行<br />

account&nbsp; required &nbsp; &nbsp; &nbsp; pam_access.so<br />

然后修改他的配置文件/etc/security/access.conf文件。加入一行<br />

-:wd:192.168.1. EXCEPT 192.168.1.158<br />

这样，wd用户从192.168.1.x（192.168.1.158除外）的登陆权限被去掉了。也就是说，wd这个用户就只能从158这个ip以及外网ip登陆了。<br />

大功告成。 :)<br />

    </div>

<div class="meta">
    
    <span class="comments"><a href="/limite-ssh-access-ip/#disqus_thread">Comments</a></span>
    
</div>
</article>

  <article class="post">
    <h2 class="title"> 
        <a href="/iptables-on-remote-server/">为远程服务器设置防火墙</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2006-04-20T00:00:00.000&#43;00:00' itemprop="datePublished">2006-04-20</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/iptables">iptables</a>

<a href="/tags/other">other</a>


</div>
    </div>
        如果服务器不在本地，又需要对防火墙做设置的时候，操作一定要注意，<br />

    </div>

<div class="meta">
    
    <span class="comments"><a href="/iptables-on-remote-server/#disqus_thread">Comments</a></span>
    
</div>
</article>

  <article class="post">
    <h2 class="title"> 
        <a href="/search-in-vim/">VIM查找替换归纳总结zz</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2006-04-18T00:00:00.000&#43;00:00' itemprop="datePublished">2006-04-18</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/other">other</a>

<a href="/tags/vim">vim</a>


</div>
    </div>
        <p><a href="http://spaces.msn.com/dingy/blog/cns!2F24B9E66A542581!327.entry">http://spaces.msn.com/dingy/blog/cns!2F24B9E66A542581!327.entry</a><br />

VIM中常用的替换模式总结。</p><p>1，简单替换表达式</p><p>替换命令可以在全文中用一个单词替换另一个单词：</p><p>:%s/four/4/g</p><br><!--more--><p>"%" 范围前缀表示在所有行中执行替换。最后的 "g" 标记表示替换行中的所有匹配点。如果仅仅对当前行进行操作，那么只要去掉%即可</p><p>&nbsp; 如果你有一个象 "thirtyfour" 这样的单词，上面的命令会出错。这种情况下，这个单词会被替换成"thirty4"。要解决这个问题，用 "\&lt;" 来指定匹配单词开头：</p><p>&nbsp; &nbsp; &nbsp;&nbsp; :%s/\&lt;four/4/g</p><br />
<p>显然，这样在处理 "fourty" 的时候还是会出错。用 "\&gt;" 来解决这个问题：</p><p>&nbsp; &nbsp; &nbsp;&nbsp; :%s/\&lt;four\&gt;/4/g</p><br />
<p>如果你在编码，你可能只想替换注释中的 "four"，而保留代码中的。由于这很难指定，可以在替换命令中加一个 "c" 标记，这样，Vim 会在每次替换前提示你：</p><p>&nbsp; &nbsp; &nbsp;&nbsp; :%s/\&lt;four\&gt;/4/gc</p><br />
<p>2，删除多余的空格</p><p>要删除这些每行后面多余的空格，可以执行如下命令：</p><p>&nbsp; &nbsp; &nbsp;&nbsp; :%s/\s\+$//</p><br />
<p>命令前面指明范围是 "%"，所以这会作用于整个文件。"substitute" 命令的匹配模式是</p><p>"\s\+$"。这表示行末（$）前的一个或者多个（\+）空格（\s）。替换命令的 "to" 部分是空的："//"。这样就会删除那些匹配的空白字符。</p><br />
<p>3，匹配重复性模式</p><p>星号项 "*" 规定在它前面的项可以重复任意次。因此:</p><p>&nbsp; &nbsp; &nbsp;&nbsp; /a*</p><p>匹配 "a"，"aa"，"aaa"，等等。但也匹配 "" (空字串)，因为零次也包含在内。星号 "*" 仅仅应用于那个紧邻在它前面的项。因此 "ab*" 匹配 "a"，"ab"，"abb","abbb"，等等。如要多次重复整个字符串，那么该字符串必须被组成一个项。组成一项的方法就是在它前面加 "\("，后面加 "\)"。因此这个命令:</p><p>&nbsp; &nbsp; &nbsp;&nbsp; /\(ab\)*</p><br />
<p>匹配: "ab"，"abab"，"ababab"，等等。而且也匹配 ""。</p><br />
<p>要避免匹配空字串，使用 "\+"。这表示前面一项可以被匹配一次或多次。</p><p>&nbsp; &nbsp; &nbsp;&nbsp; /ab\+</p><p>匹配 "ab"，"abb"，"abbb"，等等。它不匹配 后面没有跟随 "b" 的 "a"。</p><br />
<p>要匹配一个可选项，用 "\="。 例如:</p><p>&nbsp; &nbsp; &nbsp;&nbsp; /folders\=</p><p>匹配 "folder" 和 "folders"。</p><br />
<p>4，指定重复次数</p><p>要匹配某一项的特定次数重复，使用 "\{n,m}" 这样的形式。其中 "n" 和 "m" 都是数字。在它前面的那个项将被重复 "n" 到 "m" 次 (|inclusive| 包含 "n" 和 "m")。例如:</p><p>&nbsp; &nbsp; &nbsp;&nbsp; /ab\{3,5}</p><p>匹配 "abbb"，"abbbb" 以及 "abbbbb"。</p><p>&nbsp; 当 "n" 省略时，被默认为零。当 "m" 省略时，被默认为无限大。当 ",m" 省略时，就表示重复正好 "n" 次。例如:</p><p>&nbsp; &nbsp; &nbsp;&nbsp; 模式 &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 匹配次数 </p><p>&nbsp; &nbsp; &nbsp;&nbsp; \{,4} &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0，1，2，3 或 4</p><p>&nbsp; &nbsp; &nbsp;&nbsp; \{3,} &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3，4，5，等等</p><p>&nbsp; &nbsp; &nbsp;&nbsp; \{0,1} &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 0 或 1，同 \=</p><p>&nbsp; &nbsp; &nbsp;&nbsp; \{0,} &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 或 更多，同 *</p><p>&nbsp; &nbsp; &nbsp;&nbsp; \{1,} &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1 或 更多，同 \+</p><p>&nbsp; &nbsp; &nbsp;&nbsp; \{3} &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 3</p><br />
<p>5，多选一匹配</p><p>在一个查找模式中，"或" 运算符是 "\|"。例如:</p><p>&nbsp; &nbsp; &nbsp;&nbsp; /foo\|bar</p><p>这个命令匹配了 "foo" 或 "bar"。更多的抉择可以连在后面:</p><p>&nbsp; &nbsp; &nbsp;&nbsp; /one\|two\|three</p><p>匹配 "one"，"two" 或 "three"。</p><br />
<p>&nbsp; 如要匹配其多次重复，那么整个抉择结构须置于 "\(" 和 "\)" 之间:</p><p>&nbsp; &nbsp; &nbsp;&nbsp; /\(foo\|bar\)\+</p><p>这个命令匹配 "foo"，"foobar"，"foofoo"，"barfoobar"，等等。</p><br />
<p>&nbsp; 再举个例子:</p><p>&nbsp; &nbsp; &nbsp;&nbsp; /end\(if\|while\|for\)</p><p>这个命令匹配 "endif"，"endwhile" 和 "endfor"。</p><br />

    </div>

<div class="meta">
    
    <span class="comments"><a href="/search-in-vim/#disqus_thread">Comments</a></span>
    
</div>
</article>

  <article class="post">
    <h2 class="title"> 
        <a href="/man-in-debian/">debian中man不能翻页的解决方法</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2006-04-18T00:00:00.000&#43;00:00' itemprop="datePublished">2006-04-18</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/debian">debian</a>


</div>
    </div>
        安装debian基本系统之后会发现man的时候往下翻页可以用ctrl＋F，可是怎么都翻不上去。包括方向键也都不起作用。<br />

解决方法其实非常简单，只要安装less就可以了。呵呵。<br />
#apt-get install less<br />

    </div>

<div class="meta">
    
    <span class="comments"><a href="/man-in-debian/#disqus_thread">Comments</a></span>
    
</div>
</article>

  <article class="post">
    <h2 class="title"> 
        <a href="/iptables-in-debian/">debian下面的防火墙设置</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2006-04-17T00:00:00.000&#43;00:00' itemprop="datePublished">2006-04-17</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/debian">debian</a>


</div>
    </div>
        <p>rh下面的防火墙设置是保存在/etc/sysconfig/iptables文件中的，这样每次重启都会恢复防火墙设置。<br />

debian木有这个文件，但是他提供了更加灵活的方式。<br />
<a href="http://www.debian.org/doc/manuals/securing-debian-howto/ch-sec-services.en.html#s-firewall-setup">http://www.debian.org/doc/manuals/securing-debian-howto/ch-sec-services.en.html#s-firewall-setup</a><br />

看了下，似乎比较简单的就是设置interfaces文件了。<br />

5.14.3.3 Configuring firewall rules through ifup<br />
You can use also the network configuration in /etc/network/interfaces to setup your firewall rules. For this you will need to: </p><p>Create your firewalling ruleset for when the interface is active. <br />
Save your ruleset with iptables-save to a file in /etc, for example /etc/iptables.up.rules <br />
Configure etc/network/interfaces to use the configured ruleset: <br />
 &nbsp; &nbsp; iface eth0 inet static<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; address x.x.x.x<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [.. interface configuration ..]<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pre-up iptables-restore &lt; /etc/iptables.up.rules<br />
You can optionally also setup a set of rules to be applied when the network interface is down creating a set of rules, saving it in /etc/iptables.down.rules and adding this directive to the interface configuration: </p><p> &nbsp; &nbsp; &nbsp; &nbsp; post-down iptables-restore &lt; /etc/iptables.down.rules<br />
For more advanced firewall configuration scripts through ifupdown you can use the hooks available to each interface as in the *.d/ directories called with run-parts (see run-parts(8)). </p><p>可以去<a href="http://easyfwgen.morizot.net/gen/">http://easyfwgen.morizot.net/gen/</a> 在线生成一个防火墙脚本，然后pre-up指定一下。</p><br />

    </div>

<div class="meta">
    
    <span class="comments"><a href="/iptables-in-debian/#disqus_thread">Comments</a></span>
    
</div>
</article>

  <article class="post">
    <h2 class="title"> 
        <a href="/manage-route/">添加删除路由</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2006-04-17T00:00:00.000&#43;00:00' itemprop="datePublished">2006-04-17</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/other">other</a>


</div>
    </div>
        #route add -net 192.168.0.0/24<br />
#route add -host 192.168.0.23<br />
#route del -net 192.168.0.0/24<br />

#route add default gw 192.168.0.1<br />
#route del default gw 192.168.0.1<br />

    </div>

<div class="meta">
    
    <span class="comments"><a href="/manage-route/#disqus_thread">Comments</a></span>
    
</div>
</article>

  <article class="post">
    <h2 class="title"> 
        <a href="/affray-in-subway/">今天坐地铁遇到两起吵架</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2006-04-06T00:00:00.000&#43;00:00' itemprop="datePublished">2006-04-06</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/heart">heart</a>


</div>
    </div>
        地铁实在是恐怖，人挤人都要被挤死的时候，地铁广播还在说请大家不要拥挤，实在是有点搞笑了。<br />

今天到了五颗松，上来两个人，突然就吵起来了，一个男的一个女的，都得有40多了吧。那个女的说那个男的不是男人，那个男的说我不是又怎么了，那个女的似乎很郁闷，呵呵。起因好像是上车的时候，两个人相互推挤了一下。<br />

到了复兴门，我上车后看见过来一堆人，推推搡搡的，那个年纪大点的一直要扑着过去打那个年纪轻的，有个女的一直拉着，呵呵。<br />

以前地铁可能也就上下班时间人多，现在的地铁是啥时候人都多，没有办法，这是最快捷的交通方式了。不知道新的地铁线开通之后能不能缓解一下，不过可能也难，像一些换其他线比较方便的线路，肯定人会更多。<br />

bless北京的交通。。。<br />

    </div>

<div class="meta">
    
    <span class="comments"><a href="/affray-in-subway/#disqus_thread">Comments</a></span>
    
</div>
</article>

  <article class="post">
    <h2 class="title"> 
        <a href="/about-nagios/">nagios，监控多组服务器的利器</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2006-04-03T00:00:00.000&#43;00:00' itemprop="datePublished">2006-04-03</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/other">other</a>


</div>
    </div>
        面试的时候被有时会被问道的问题就是，如果让你去管理100台服务器，你打算怎么做？<br />

老实说偶只弄过1台服务器，没事上去看看，还是可以的，100台，一台看一眼那就是多长时间啊。1台的时候可以用logwatch每天生成一份日志，每天看一眼日志。或者每天看看awstatus分析后的web日志。可是100台的时候基本不适用了，每天早上看100封mail会疯掉的，况且这个还不实时。。。<br />

听xh介绍之后，看了一下nagios，才知道有人早就想到这些问题了。其实我之前遇到第一个人问我的时候就应该去了解一下的。<br />

nagios是通过nagios进程管理下，定时运行某些检测程序，然后通过web方式来显示检测结果的，比如说ping、pop3、smtp、http，还有switch、router等等，甚至本机登陆用户、运行进程、磁盘空间等，还可以设置服务器的主从关系，比如哪个http服务器是位于某个router下面等，这样提示的时候会一并告诉你（这个还没有测试，不过是看到配置文件有这项设置）。<br />

nagios的安装和配置 <a href="http://www.totkat.org/pages/nagios.shtml">http://www.totkat.org/pages/nagios.shtml</a><br />

类似nagios的还有cacti，这个似乎是用来检测本机的，本机的磁盘空间、流量、负载等，还没有弄太清楚。<br />

Splunk是个商业的日志分析软件，运行于Unix环境，可以支持任何服务器产生的日志，并对日志进行高效索引，以便管理员可以对日志中的各种情况进行搜索，并可以通过图形化方式表现，虽然是商业软件，但是它提供了可以自由使用的splunk server，只是如果需要更多的LiveSplunks，Splunk Sync等功能才需要购买授权。<br />

下面这个地址是Nagios和Splunk的联合使用介绍<p> <a href="http://www.nagios.org/products/enterprisesolutions/splunk/" target="_blank" class="liexternal">http://www.nagios.org/products/enterprisesolutions/splunk/</a></p><br />

    </div>

<div class="meta">
    
    <span class="comments"><a href="/about-nagios/#disqus_thread">Comments</a></span>
    
</div>
</article>

  <article class="post">
    <h2 class="title"> 
        <a href="/qmail-queue/">Qmail邮件队列工作原理zz</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2006-03-30T00:00:00.000&#43;00:00' itemprop="datePublished">2006-03-30</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/mail">Mail</a>


</div>
    </div>
        http://www.gbunix.com/htmldata/2005_06/15/25/article_1223_1.html<br />

以下是qmail的数据流简图<br />

 qmail-smtpd --- &gt;&gt;qmail-queue ---&gt;&gt; qmail-send &lt;&lt;--- qmail-rspawn &lt;&lt;--- qmail-remote<br />
 &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; / &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | <br />
 &nbsp; &nbsp; &nbsp; qmail-inject _/ qmail-clean \_ qmail-lspawn &lt;&lt;--- qmail-local<br />

 &nbsp; &nbsp;qmail中，每一条消息都发送到中央队列等待发送，由qmail-queue进程控制。它在以下情况被调用：<br />
 &nbsp; &nbsp;1、当产生本地消息时，qmail-inject进程调用qmail-queue。<br />
 &nbsp; &nbsp;2、qmail-smtpd准备SMTP协议下的投递邮件任务时调用它。<br />
 &nbsp; &nbsp;3、向前（forwarded）发送邮件时，qmail－local调用它。<br />
 &nbsp; &nbsp;4、退回邮件时，qmail－send调用它。<br />

 &nbsp; &nbsp;每封邮件接着由qmail-lspawn 和qmail-rspawn协助qmail－sned进程完成投递，最后由qmail－clean清除邮件队列。这四个进程是系统由始至终都在运行的，十分重要。<br />

由smtpd从域外接受邮件之后，会交给queue处理（也就是2），之后转到qmal-send，然后看是域内还是域外，域内用qmail-lspawn，域外用qmail-rspawn。域内邮件调用qmail-local处理，如果遇到.qmail文件转发邮件（也就是上面的3），还会交给queue处理，如果没有，就直接投递给用户（？）。域外邮件调用qmail-remote处理，如果对方拒收邮件，他就会产生一个新的邮件（bounce），交给qmail-send，然后交给queue（也就是4？）。<br />

本地用户发送mail的时候调用qmail-inject，然后交给queue（也就是1）。<br />

有几个问题。<br />
1&nbsp; 收到域外邮件之后，判断本机是否有这个用户后才接受邮件呢，还是先接受进来放到queue里等qmail-local处理的时候再说？<br />

2&nbsp; qmail-clean这个程序是怎么工作的？实时扫描queue的文件夹？<br />

    </div>

<div class="meta">
    
    <span class="comments"><a href="/qmail-queue/#disqus_thread">Comments</a></span>
    
</div>
</article>



  <nav id="pagenavi">
    
        <a href="/page/36/" class="prev">Prev</a>
    
    
        <a href="/page/38/" class="next">Next</a>
    
  <div class="center"><a href="/archives/index.html">Blog Archives</a></div>
  </nav>


    </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2017
    
    wd
    . Powered by <a href="http://gohugo.io" target="_blank">Hugo</a> |
    Theme is <a href="https://github.com/wd/hugo-fabric">hugo-fabric</a>, fork from <a href="https://github.com/wd/hexo-fabric">hexo-fabric</a> by <a href="https://wdicc.com">me</a>
</div>

    </footer>
    <script src="/js/fabric.js"></script>


</div>
</div>
<script src="/js/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
 
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery);
 
</script>
</body>
</html>
