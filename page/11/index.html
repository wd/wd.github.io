<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
    
	<title>wd and cc</title>
    <meta name="author" content="wd">
    
	<meta name="description" content="undefined"> <!-- TODO: truncate -->
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="atom.xml" rel="alternate" title="wd and cc" type="application/atom+xml">
	<link href="/favicon.ico" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/custom.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/hljs.css" media="screen, projection" rel="stylesheet" type="text/css">

    <link href='//fonts.googleapis.com/css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Amethysta' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![}]-->

    <script type="text/javascript" src="/javascripts/jquery-tapir.js"></script>

    <!-- remove or comment it to disable ajaxification -->   
    <!-- <script src="/javascripts/ajaxify.js"></script> -->

    

    

</head>


<body>
    <div id="wrapper">
    <header id="header" class="inner"><!-- for more effects see _animate.scss -->
<h1 class="animated bounceInDown">
    <div id="headerbg">
        wd and cc
    </div>
</h1>
<span class="subtitle">happy everyday</span>
<br>

<ul id="social-links" style="text-align:center; clear:both;">
  
  <!-- GitHub -->
  <li>
  <a href="https://github.com/wd" class="github" title="Github"></a>
  </li>
  
  
  
  
  <!-- Twitter -->
  <li>
  <a href="http://www.twitter.com/wd" class="twitter" title="Twitter"></a>
  </li>
  
  
  
  
  
</ul>


<!-- use full url including 'index.html' for navigation bar if you are using ajax -->
<ul id="nav">
	<li id="ajax"><a href="/index.html">Home</a></li>
	<li id="ajax"><a href="/archives/index.html">Archives</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    
    <li>
    <div id="dark">
        <form method="get" action="/search.html" id="search">
            <input name="query" type="text" placeholder="Search..." x-webkit-speech />
        </form>
    </div>
    </li>
        
</ul>




</header>

<div id="toload">
<!-- begin toload -->
    <div id="content" class="inner">
        

    
        <script id="dsq-count-scr" src="//wdicc.disqus.com/count.js" async></script>
    



  <article class="post">
	<h2 class="title">
		<a href="strange-weighing-apparatus/">奇怪的秤</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-04-12T16:00:00.000Z" itemprop="datePublished">Apr 13, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/Heart/">Heart</a> <a href="../tags/秤/">秤</a>
</div>
    </div>
      
        也不知道秤的英文是哪个，查了下，就用这个 weighing apparatus 了，嘿嘿。balance 好像也有这个意思。

很早的时候去超市，看到秤就买了一个，是那种指针式的。过年的时候呢，我老婆的妈妈，从家又给带了一个秤，是那种电子的。电子的好看数，而且还是透明的，看着也时尚，自然就把那个指针的给淘汰了，放到了一边。

这几天办了一个健身卡，打算减减肥，第一次上去秤的时候，着实高兴了一把，因为好像我轻了 2kg，这个可不得了，因为我好像才锻炼了2天而已。。后来就发现有问题，因为我在锻炼的地方秤的结果好像是没什么变化，怎么回事？就把那个指针秤也拿了出来。

发现问题了。

我在那个电子秤上面秤的时候，和指针秤比较，轻2kg。不过，比较奇怪的是，我老婆在两个秤之间却几乎没差别，这个是怎么回事呢？

奇怪的秤。。

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/strange-weighing-apparatus/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="a-nice-way-to-fuck-gfw/">A nice way to fuck gfw</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-03-31T16:00:00.000Z" itemprop="datePublished">Apr 1, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/Linux/">Linux</a> <a href="../tags/GFW/">GFW</a>
</div>
    </div>
      
        转载自 : http://fuckgfw.jottit.com/

<p>本文将提供一种一劳永逸的翻墙方式（ssh -D），实施之后，那道墙——对你来说——将从此透明。</p>

<p>本文面向的用户：使用Windows作为操作系统并且使用Firefox作为常用浏览器。</p>

<h2>第一步：免费获取拥有SSH权限的帐号和密码。</h2>

<p>默认的免费获取方式：将本文转载到你自己的博客上，将转载后的文章网址发送到<img src="http://photos.smugmug.com/photos/497999637_nw25h-O.png" alt="f.ckgfw#gmail.com" title="">。</p>

<p>转载方式：拷贝<a href="https://dl.getdropbox.com/u/398/html.txt" target="_blank" rel="external">文章代码</a>至博客后台HTML编辑器中，直接发布即可，文章标题自拟，可在前后文插入自己的评论。</p>

<p>经过人工审核，你将收到一封附有五个拥有SSH权限的帐号和密码的电子邮件，你可以将它们赠与你自己的读者。</p>

<p>更多获取方式将在今后陆续激活，请关注帐号配送中心：<a href="https://friendfeed.com/rooms/fuckgfw-for-free" target="_blank" rel="external">https://friendfeed.com/rooms/fuckgfw-for-free</a></p>

<h2>第二步：配置MyEntunnel软件</h2>

<p>下载并安装MyEntunnel，该软件全名为My Encrypted Tunnel。</p>

<p>一键下载：<a href="https://dl.getdropbox.com/u/398/myentunnel.exe" target="_blank" rel="external">https://dl.getdropbox.com/u/398/myentunnel.exe</a></p>

<p><img src="http://photos.smugmug.com/photos/497956295_FRKXY-O.jpg" alt="myentunnel" title=""></p>

<p>按照上图将第一步收到的帐号信息填写到相应的地方后，点击<img src="http://photos.smugmug.com/photos/497956305_GuUqV-O.jpg" alt="save" title="">按钮，再点击<img src="http://photos.smugmug.com/photos/497956257_vDBHg-O.jpg" alt="hide" title="">按钮。</p>

<p>第一次连接过程中会出现一个认证对话框，按照提示确认即可。以后的自动连接中将不再出现此认证对话框。</p>

<p>最后点击<img src="http://photos.smugmug.com/photos/497956277_uqUyE-O.jpg" alt="hide" title="">按钮，使对话框隐藏到系统任务栏中。</p>

<p>提示：</p>

<p>为MyEntunnel创建一个快捷方式，将其复制到系统的【启动】（C:\Documents and Settings\当前用户名（需要修改成你自己的）\「开始」菜单\程序\启动）文件夹中，今后开机便可自动启动软件，并自动连接服务器。</p>

<p><img src="http://photos.smugmug.com/photos/497956351_pNNkc-O.png" alt="tray" title=""></p>

<p>绿色代表连接成功且稳定；黄色代表正在连接或重新连接；红色代表连接失败。</p>

<h2>第三步：配置Firefox浏览器</h2>

<p>假设你正使用<a href="http://www.mozilla.com/firefox" target="_blank" rel="external">Firefox浏览器</a>阅读本文。</p>

<p>一键安装：<a href="http://autoproxy.mozdev.org/latest.xpi" target="_blank" rel="external">http://autoproxy.mozdev.org/latest.xpi</a></p>

<p><img src="http://photos.smugmug.com/photos/498951512_XzxSh-O.png" alt="xpi-offical" title=""></p>

<p>点击立即安装，安装后，重新启动Firefox。然后你会看到如下对话框，选择gfwlist (P.R.China)后，点击确定。</p>

<p><img src="http://photos.smugmug.com/photos/497956357_vmp9W-O.png" alt="gfwlist" title=""></p>

<p>接着你会看到Firefox主界面右上角出现有一个“福”字图案，点击“福”。</p>

<p><img src="http://photos.smugmug.com/photos/497956204_t4d3L-O.png" alt="fu" title=""></p>

<p>点击“代理服务器——编辑代理服务器”。</p>

<p><img src="http://photos.smugmug.com/photos/497956317_yWwtL-O.png" alt="edit" title=""></p>

<p>随即出现如下画面，你会看到如GAppProxy、Tor和Your Freedom这样一系列代理服务器名称。</p>

<p><img src="http://photos.smugmug.com/photos/497956227_jQby9-O.png" alt="before" title=""></p>

<p>将GAppProxy一栏的参数修改为如下图所示。</p>

<p><img src="http://photos.smugmug.com/photos/497956232_ttQRj-O.png" alt="after" title=""></p>

<p>修改完毕后，点击确定。至此配置已全部就绪。</p>

<p>获取更多帮助，请关注反馈中心：<a href="https://friendfeed.com/rooms/fuckgfw-feedback" target="_blank" rel="external">https://friendfeed.com/rooms/fuckgfw-feedback</a></p>

<h2>第四步：支持fuckGFW</h2>

<p>获取详情，请关注捐赠与推广中心：<a href="https://friendfeed.com/rooms/fuckgfw-donation-and-marketing" target="_blank" rel="external">https://friendfeed.com/rooms/fuckgfw-donation-and-marketing</a></p>

<h4>版权信息：您可以自由复制、传播、演绎本作品且无需署名、无需注明原始出处。</h4>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/a-nice-way-to-fuck-gfw/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="perl-and-fork/">perl and fork</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-03-06T16:00:00.000Z" itemprop="datePublished">Mar 7, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/Linux/">Linux</a> <a href="../tags/perl/">perl</a> <a href="../tags/fork/">fork</a>
</div>
    </div>
      
        最近写程序用到了 fork ，记一下。

我在 perl 里面某个地方开始，fork 多个进程去操作 db，主进程等子进程完事后，再继续后面的操作。

<pre class="prettyprint lang-perl">
use POSIX ":sys_wait_h";
my $thread_num = 5;
my %pids = ();

# $dbi->{InactiveDestroy} = 1 用到 dbi 的话还要设置这个，要不子进程exit后，dbi
# 连接就断了

# .....前面的程序
for ( 1..$thread_num ) {
	my $pid = fork;
	if (not $pid) { # 子进程
		$pids{$pid} = 1;
		# blalbalbla... 子进程去干活
		eixt 0; # 要记得 exit ，要不子进程还会继续执行后面的。
	} else { # 主进程
		# balbalbal ... 如果没事做也可以不写
	}
}

while( keys( %pids ) ) {
	my $kid = waitpid(-1,WNOHANG);
	if ($kid >0) {
		delete $pids{$kid};
		print "$kid end.\n";
	} else {
		sleep 1; # 继续等，如果有时间限制，可以在这里去 kill 子进程
	}
}

# ....继续后面的程序

</pre>

还可以参考这个 http://www.perlmonks.org/?node_id=619722

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/perl-and-fork/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="shmall-and-shmmax-kernel-paramaters/">内核的 shmall 和 shmmax 参数</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-03-01T16:00:00.000Z" itemprop="datePublished">Mar 2, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/Linux/">Linux</a> <a href="../tags/kernel/">kernel</a>
</div>
    </div>
      
        shmall 是全部允许使用的共享内存大小，shmmax 是单个段允许使用的大小。这两个可以设置为内存的 90%。例如 16G 内存，16*1024*1024*1024*90% = 15461882265，shmall 的大小为 15461882265/4k(getconf PAGESIZE可得到) = 3774873。

修改 /etc/sysctl.conf。

<pre class="prettyprint lang-text">
kernel.shmmax=15461882265
kernel.shmall=3774873
kernel.msgmax=65535
kernel.msgmnb=65535
执行 sudo sysctl -p
</pre>

可以使用 ipcs -l 看结果。ipcs -u 可以看到实际使用的情况。

<pre class="prettyprint lang-text">
------ Shared Memory Limits --------
max number of segments = 4096
max seg size (kbytes) = 15099494
max total shared memory (kbytes) = 15097856
min seg size (bytes) = 1
 
------ Semaphore Limits --------
max number of arrays = 128
max semaphores per array = 250
max semaphores system wide = 32000
max ops per semop call = 32
semaphore max value = 32767
 
------ Messages: Limits --------
max queues system wide = 16
max size of message (bytes) = 8192
DEFAULT max size of queue (bytes) = 16384
</pre>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/shmall-and-shmmax-kernel-paramaters/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="disable-gnome-terminal-close-button/">去掉了 gnome-terminal 的 tab 上面的关闭按钮</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-02-05T16:00:00.000Z" itemprop="datePublished">Feb 6, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/Linux/">Linux</a> <a href="../tags/gnome/">gnome</a>
</div>
    </div>
      
        gnome-terminal 上面有个红红的 叉叉，就是关闭按钮了。因为开 tab 多的时候会不小心按到，所以就想把他干掉。可惜 gnome 没提供去掉的选项，google 了下，发现不少人烦这个，可是 gnome 不理会这些声音，2007 年有人写了个<a href="https://bugs.launchpad.net/gnome-terminal/+bug/99978" target="_blank">补丁</a>，可惜没转正。我琢磨琢磨改巴改巴把他弄到自己能用了。原来那个补丁还添加了 gconf 的配置项，我没那需求，就去掉了。这个是对 gentoo 里面的 gnome-terminal-2.24.2 打的补丁，别的版本没准还得改改。

<pre class="prettyprint lang-diff">
diff -ur gnome-terminal-2.24.2.org/src/terminal-window.c gnome-terminal-2.24.2/src/terminal-window.c
--- gnome-terminal-2.24.2.org/src/terminal-window.c	2009-02-06 17:51:54.277755771 +0800
+++ gnome-terminal-2.24.2/src/terminal-window.c	2009-02-06 18:04:34.601756240 +0800
@@ -1929,7 +1929,7 @@
 
   gtk_box_pack_start (GTK_BOX (hbox), label, TRUE, TRUE, 0);
 
-  close_button = gtk_button_new ();
+/*  close_button = gtk_button_new ();
   gtk_button_set_relief (GTK_BUTTON (close_button), GTK_RELIEF_NONE);
   gtk_button_set_focus_on_click (GTK_BUTTON (close_button), FALSE);
   gtk_button_set_relief (GTK_BUTTON (close_button), GTK_RELIEF_NONE);
@@ -1939,17 +1939,17 @@
   image = gtk_image_new_from_stock (GTK_STOCK_CLOSE, GTK_ICON_SIZE_MENU);
   gtk_container_add (GTK_CONTAINER (close_button), image);
   gtk_box_pack_end (GTK_BOX (hbox), close_button, FALSE, FALSE, 0);
-
+*/
   sync_tab_label (screen, NULL, label);
   g_signal_connect (screen, "notify::title",
                     G_CALLBACK (sync_tab_label), label);
 
-  g_signal_connect (close_button, "clicked",
+/*  g_signal_connect (close_button, "clicked",
 		    G_CALLBACK (close_button_clicked_cb), screen_container);
 
   g_signal_connect (hbox, "style-set",
                     G_CALLBACK (tab_label_style_set_cb), close_button);
-
+*/
   gtk_widget_show_all (hbox);
 
   return hbox;
</pre>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/disable-gnome-terminal-close-button/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="writing-a-kde-plasma-applet/">写了一个 kde plasma applet</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-01-22T16:00:00.000Z" itemprop="datePublished">Jan 23, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/Linux/">Linux</a> <a href="../tags/plasma/">plasma</a> <a href="../tags/pyqt4/">pyqt4</a> <a href="../tags/python/">python</a>
</div>
    </div>
      
        用 gnome 的时候，对 panel 上面的 cpu 等 applet 情有独钟。这个东西能让我对自己的系统有第一手信息，有时候某个程序出问题了 cpu 100% 了，这个时候系统反应不一定会变慢的，但是这个程序是必须要被干掉的，有了这个 applet 我就能知道第一时间知道出问题了。还有的时候看 firefox 里面的 flash 的时候也会出类似的情况，这时会导致看别的网页很慢，那就干掉他。

第一次装 kde 的时候发现没有那些东西，让我很失望。后来看到 ob 在 openbox 里面把 panel 设的短一点，然后用 conky 在空出来的地方显示一些信息，感觉豁然开朗啊，呵呵。

这次装好 kde，就弄了一个 conky，可是发现他的风格和系统不兼容。有点不爽，就琢磨自己能不能弄一个，因为需求实在太简单了。

昨天花了一个下午，总算弄好了。参考的文档 <a href="http://www.qtopia.org.cn/doc/qiliang.net/qt/classes.html" target="_blank" rel="external">qt的类</a>, <a href="http://www.zetcode.com/tutorials/pyqt4/" target="_blank" rel="external">pyqt4 turtorial</a>,<a href="http://techbase.kde.org/Development/Tutorials/Plasma/Python/GettingStarted" target="_blank" rel="external">plasma python</a> .

效果就这样。电池旁边那个就是。

<a href="http://img339.imageshack.us/img339/6986/200901231045132304x1024oo0.png" target="_blank"><img src="http://img339.imageshack.us/img339/6986/200901231045132304x1024oo0.png" alt="" width="300"></a>

代码
<pre class="prettyprint lang-python">
from PyQt4.QtCore import *
from PyQt4.QtGui import *
from PyKDE4.plasma import Plasma
from PyKDE4 import plasmascript
import time                                      

class Cpuinfo(plasmascript.Applet):
        def __init__(self,parent,args=None):
                plasmascript.Applet.__init__(self,parent)

        def init(self):
                self.freqnow = ''
                self.freqmax = ''
                self.temp = ''
                self.text = ''   

                self.getCurrentFreq()
                self.getMaxFreq()
                self.getTemp()       

                self.setHasConfigurationInterface(False)
                self.setMinimumWidth(100)
                self.setAspectRatioMode(Plasma.Square)
                self.startTimer(1000)

        def getCurrentFreq (self):
                line = open ('/sys/devices/system/cpu/cpu0/cpufreq/scaling_cur_freq', 'r').read().rstrip('\n')
                line = int(line) / 1000 /1000.0
                self.freqnow = line

        def getMaxFreq (self):
                line = file('/sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq', 'r').read().rstrip('\n')
                line = int(line) / 1000 /1000.0
                self.freqmax = line

        def getTemp (self):
                line = file('/proc/acpi/thermal_zone/TZ1/temperature', 'r').read().rstrip('\n')
                line = " ".join(line.split()[1:])
                self.temp = line

        def timerEvent(self, event):
                self.getCurrentFreq()
                self.getTemp()
                self.text = "%s\n%.2f %d%%" % (self.temp, self.freqnow, self.freqnow / self.freqmax * 100)
                self.update() 

        def paintInterface(self, painter, option, rect):
                painter.save()
                painter.setPen(Qt.white)
                #painter.setFont(QFont('Consolas',11))
                painter.drawText(rect, Qt.AlignVCenter | Qt.AlignHCenter, self.text)
                painter.restore()

def CreateApplet(parent):
                return Cpuinfo(parent)

if __name__ == '__main__':
        a = Cpuinfo(None)
        a.init()
        print a.freqnow</pre>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/writing-a-kde-plasma-applet/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="use-kde-42-in-gentoo/">将 gnome 换成 kde 4.2</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-01-22T16:00:00.000Z" itemprop="datePublished">Jan 23, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/Linux/">Linux</a> <a href="../tags/gentoo/">gentoo</a> <a href="../tags/kde/">kde</a>
</div>
    </div>
      
        下面的步骤一定要明白干的是什么再操作，否则后果自负 :)。

1 修改 make.conf 里面的 use 为 kde4 -kde -gnome qt4 -qt3 -avahi -esd 这样。把 gnome 相关的 use 都 - 掉。我还有 -arts，看需要。使用 kde 这个use有时会导致安装 kde3，所以如果要使用最好在 /etc/portage/package.use 里面单独指定。如果不介意 kde + gnome 共存，那么 1,2 不是必须的。

2 emerge -uDN world

3 修改 /etc/portage/package.unmask ,加入 &gt;sys-apps/portage-2.1, unmask portage 2.2 ，2.2 才支持 set

4 layman -a kde-testing

5 emerge -av @kdebase-4.2
其他想装的东西可以去 /usr/local/portage/layman/kde-testing/sets 里面看。比如 emerge -av @kdepim-4.2，或者装里面的某个包，emerge kde-base/kmail:4.2

6 修改 /var/lib/portage/world ，删掉里面的 gnome 的包，当然不介意 gnome 和 kde 共存的话后面的就不需要做了。

7 emerge --depclean -p 清理 gnome 的包。

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/use-kde-42-in-gentoo/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="perl-cookie/">使用 perl 来登录网页</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-01-05T16:00:00.000Z" itemprop="datePublished">Jan 6, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/Linux/">Linux</a> <a href="../tags/cookie/">cookie</a> <a href="../tags/perl/">perl</a>
</div>
    </div>
      
        应该不能用。。。只是为了记录

使用 LWP::UserAgent 可以简单的去访问网页，获取页面内容。例如

<pre class="prettyprint lang-perl">
use LWP::UserAgent;

my $ua = LWP::UserAgent->new();
$ua->timeout(10);
$ua->agent('mozilla');

my $r = $ua->get('http::/www.google.com');
print $r->content; # or $r->decoded->content
</pre>

$r 的其它属性可以去 cpan 看看。这样就获取到了内容。但是，如果一个网页是需要登录的怎么办？可以用保存 cookie 的方式。

<pre class="prettyprint lang-perl">
use LWP::UserAgent;
use HTTP::Cookies;
use Digest::MD5 qw(md5 md5_hex); # 用来生成 md5 的
use JSON; # 用来在 json 串和 perl 的 hash 串之间转换
use Data::Dumper;

my $cookie_jar = HTTP::Cookies->new(
	file => "lw.dat",
	autosave => 1
);

my $ua = LWP::UserAgent->new();
$ua->timeout(10);
$ua->agent('mozilla');

my(@rest) = ("/", ".yahoo.com", undef, 0, 0, 60*60, 0);
$cookie_jar->set_cookie(0, 'session', $session, @rest);

$ua->cookie_jar($cookie_jar);

$o = $ua->get($url);
........
</pre>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/perl-cookie/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="convert-reiserfs-t-ext4/">把硬盘的分区都换成了 ext4</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2009-01-02T16:00:00.000Z" itemprop="datePublished">Jan 3, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/Linux/">Linux</a> <a href="../tags/ext4/">ext4</a> <a href="../tags/reiserfs/">reiserfs</a>
</div>
    </div>
      
        我的分区都是 reiserfs 的。这次 ext4 吵的这么火爆，实在忍不住了，就换过去了。

我的磁盘比较小，转换还费了点功夫。先找一个和 / 分区差不多的分区，用来放 / 的数据。我找的是 /home ，然后把 / /home 之外的分区转换了。方法就是先把其中一个的数据弄到其它的上面，然后重新格式化，然后再把数据弄回来。

可以用 cp -p /source /dest 的方式，也可以用 tar cpf - --exclude=/home | tar xpf - 的方式，后面这个方法可以支持过滤掉某个目录不考。

这些都弄好之后就可以弄 / /home 了。先把 /home 的东西备分一下， tar cpf /data/home.tar ，/data 最好是一个单独的分区。

rc-update del xdm ，然后重启 root 登录。格式化 /home，再 mount 上他，用来复制 / 的内容过来。复制的时候需要注意下，先把 / /home 之外的那些分区都 umount，省得复制的时候不小心一起复制了过来。

cd /home; tar cpf - --exclude=/home --exclude=/proc --exclude=/sys | tar xpf -

复制完之后，在 /home 下建立 /home/proc /home/sys 目录。修改 /home/boot/grub/menu.lst 文件（如果是独立的 boot 分区，需要挂上再修改），kernel 参数为新的 root，建议新加一行，保留原来的，免得有问题还能方便回去。然后修改 /etc/fstab。就可以重启了。

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/convert-reiserfs-t-ext4/#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="change-wm-in-gnome/">在 gnome 中替换 wm</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2008-12-31T16:00:00.000Z" itemprop="datePublished">Jan 1, 2009</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/Linux/">Linux</a> <a href="../tags/gnome/">gnome</a> <a href="../tags/openbox/">openbox</a>
</div>
    </div>
      
        gnome 中的 window manger (wm) 是 metacity，有时候可能会用的不爽，换成 openbox ，或着 xfwm4 之类。

gnome 提供了简单的方法，就是设置 WINDOW_MANAGER 这个变量。如果用的是 dm，例如 gdm ，那么在 .profile 里面放上下面一句就可以了。startx 的话，放在 .xinitrc 里面。

export WINDOW_MANAGER="/usr/bin/openbox"

用 gdm 的话，还可以在启动的时候选择 openbox-gnome-session 这个来使用 openbox 做为 wm，那个命令是个 shell 脚本，可以看看。

如果设置了不管用，可以看看 gconf 里面的 desktop/gnome/session/required_components/windowmanager 的值。/usr/bin/gnome-wm 这个程序可能会用这个，具体好像和 gnome 的版本有关，这个文件是 gnome-base/gnome-session 这个包里面的。

gdm 启动的时候，会运行 /etc/X11/gdm/Xsession 这个程序。可以试试看在这里面小小的 debug 一下。

最后郁闷一下，openbox 在 gnome 的 dual head 里面好像有个 <a href="http://bugzilla.icculus.org/show_bug.cgi?id=3922" target="_blank">bug</a>，提交给了 openbox，还没回复，只能继续 metacity 了。

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="http://wdicc.com/change-wm-in-gnome/#disqus_thread">Comments</a></span>
	
</div>
</article>


  <nav id="pagenavi">
    
        <a href="/page/10/" class="prev">Prev</a>
    
    
        <a href="/page/12/" class="next">Next</a>
    
  <div class="center"><a href="/archives/index.html">Blog Archives</a></div>
  </nav>


    </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2016

    wd
. Powered by <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> |
    Theme is <a href="https://github.com/wd/hexo-fabric">hexo-fabric</a>, fork from <a href="http://github.com/panks/fabric">fabric</a> by <a href="http://panks.me">Pankaj Kumar</a>
</div>


    </footer>
    <script src="/javascripts/fabric.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script>
 <!-- Delete or comment this line to disable Fancybox -->



<!-- end toload --> 
</div>
</div>
<script src="/javascripts/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery); 
/*]]>*/
</script><!-- remove it to remove the scroll to top button -->
</body>
</html>
