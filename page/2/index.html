<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
    
	<title>wd and cc</title>
    <meta name="author" content="wd">
    
	<meta name="description" content="undefined"> <!-- TODO: truncate -->
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="atom.xml" rel="alternate" title="wd and cc" type="application/atom+xml">
	<link href="/favicon.ico" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/custom.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/hljs.css" media="screen, projection" rel="stylesheet" type="text/css">

    <link href='//fonts.googleapis.com/css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Amethysta' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![}]-->

    <script type="text/javascript" src="/javascripts/jquery-tapir.js"></script>

    <!-- remove or comment it to disable ajaxification -->   
    <!-- <script src="/javascripts/ajaxify.js"></script> -->

    

    

</head>


<body>
    <div id="wrapper">
    <header id="header" class="inner"><!-- for more effects see _animate.scss -->
<h1 class="animated bounceInDown">
    <div id="headerbg">
        wd and cc
    </div>
</h1>
<span class="subtitle">happy everyday</span>
<br>

<ul id="social-links" style="text-align:center; clear:both;">
  
  <!-- GitHub -->
  <li>
  <a href="https://github.com/wd" class="github" title="Github"></a>
  </li>
  
  
  
  
  <!-- Twitter -->
  <li>
  <a href="http://www.twitter.com/wd" class="twitter" title="Twitter"></a>
  </li>
  
  
  
  
  
</ul>


<!-- use full url including 'index.html' for navigation bar if you are using ajax -->
<ul id="nav">
	<li id="ajax"><a href="/index.html">Home</a></li>
	<li id="ajax"><a href="/archives/index.html">Archives</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    
    <li>
    <div id="dark">
        <form method="get" action="/search.html" id="search">
            <input name="query" type="text" placeholder="Search..." x-webkit-speech />
        </form>
    </div>
    </li>
        
</ul>




</header>

<div id="toload">
<!-- begin toload -->
    <div id="content" class="inner">
        
  <article class="post">
	<h2 class="title">
		<a href="postgresql-transaction-isolation/">postgresql transaction isolation</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2015-05-10T15:20:49.000Z" itemprop="datePublished">May 10, 2015</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/postgresql/">postgresql</a>
</div>
    </div>
      
        <p>翻译自 <a href="http://www.postgresql.org/docs/current/static/transaction-iso.html，" target="_blank" rel="external">http://www.postgresql.org/docs/current/static/transaction-iso.html，</a> 内容没翻译全，供参考。</p>
<h2 id="并发控制"><a href="#并发控制" class="headerlink" title="并发控制"></a>并发控制</h2><h3 id="13-2-事务隔离级别"><a href="#13-2-事务隔离级别" class="headerlink" title="13.2 事务隔离级别"></a>13.2 事务隔离级别</h3><p>SQL 标准定义了四个事务隔离级别。最严格的就是串行化(Serializable)，根据标准定义，任何并发的串行化事务如果在相同的时间使用相同的顺序执行，那么需要有相同的执行结果。其他的三个隔离级别，都定义了在并发事务互相影响的情况下，在各隔离级别下不允许出现的一些现象。根据标准，这些现象都不允许出现在串行化这个级别。(这并不令人惊讶 – 如果为了事务的结果一致只允许同时运行一个事务，那怎么可能会出现因为事务互相影响产生的现象)。</p>
<p>在各级别禁止的一些现象如下：</p>
<p>脏读(dirty read)</p>
<pre><code>一个事务读取到另一个并发的事务还没有提交的数据。
</code></pre><p>不可重复读(nonrepeatable read)</p>
<pre><code>一个事务重复读取之前读过的数据的时候，发现数据已经被其他事务修改（就是在第一次读取之后做的提交)。
</code></pre><p>幻读(phantom read)</p>
<pre><code>一个事务重新执行一个查找符合条件的数据的查询的时候，发现返回的数据因为这期间别的事务做了提交而发生了变化。
</code></pre><p>四个事务隔离级别和对应的行为在表 13-1 中进行了描述。</p>
<p>表 13-1 SQL 标准定义的事务隔离级别</p>
<p>| 事务隔离级别               | 脏读   | 不可重复读 | 幻读   |<br>|—————————-+——–+————+——–|<br>| 读未提交(read uncommitted) | 可能   | 可能       | 可能   |<br>| 读已提交(read committed)   | 不可能 | 可能       | 可能   |<br>| 可重复读(repeatable read)  | 不可能 | 不可能     | 可能   |<br>| 串行化(serializable)       | 不可能 | 不可能     | 不可能 |</p>
<p>（译者注：这个表格是个很大的迷惑，要注意他描述的只是标准定义的，而不是 PostgreSQL 里面的情况，在 PostgreSQL 中的实际情况和上面表格标记的不一致，下面的译文里面也多次会提到。）</p>
<p>在 PostgreSQl 中，你可以使用任意的四个隔离级别。但是，在内部其实只有三个，分别对应到读已提交、可重复读和串行化。当使用读未提交这个级别的时候，实际上和读已提交是一样的，而幻读在 PostgresSQL 的可重复读级别是不可能出现的，所以在 PostgreSQL 中实际的隔离级别可能比你选的更加严格一点。这个是 SQL 标准允许的：标准里面的四个隔离级别只定义了哪种现象不能出现，没有定义哪种现象一定会出现。PostgreSQL 只提供了三个隔离级别，是因为这是唯一比较合理的把标准定义的隔离级别映射到多版本并发控制架构上面的办法。在下面的章节里面会详细讲解各个隔离级别。</p>
<p>设置事务隔离级别的语句是 set transaction。</p>
<pre><code>重要提示：有些 PostgreSQL 的数据类型和函数在事务里面有特别的表现。特别的，对于序列(sequence)(以及定义为 serial 类型的列对应的序列)的修改会立刻对所有事务有效，并且在事务回滚的时候也不会被回滚。请参考 9.16 和 8.1.4。
</code></pre><h4 id="13-2-1-读已提交事务隔离级别"><a href="#13-2-1-读已提交事务隔离级别" class="headerlink" title="13.2.1 读已提交事务隔离级别"></a>13.2.1 读已提交事务隔离级别</h4><p>读已提交是 PostgreSQL 里面默认的事务隔离级别。当一个事务使用此级别的时候，一个 select 查询(不带 for update/share 字句)只可以查到当前查询开始前已经提交的数据，(在此查询执行的过程中)永远不会查到其他并发事务执行时的未提交数据和已提交的修改。事实上，一个 select 查询可以”看“到执行开始瞬间的数据库的一个快照。不过，select 查询可以”看“到当前事务里面已经完成更新的数据，即使他们还没有被提交。同时也要注意，如果有其他事务在一个事务的第一个 select 执行之后提交了修改，那么那个事务里面的前后成功的两个 select 查询也有可能得到不同的结果。</p>
<p>update, delete, select for update, 和 select for share 这些语句在查找目标数据的时候的时候，表现和 select 是一样的：都是只能查找到在语句执行开始的时候就已经提交的数据。然而，这些目标数据可能就已经被其他并发事务修改（或者删除、加锁(locked))了。在这种情况下，即将执行更新的事务将会等待第一个执行了更新的事务的提交或者回滚（如果他仍然在执行中）。如果第一个更新事务执行了回滚，那么它的执行结果会取消，后续的更新事务会处理所有之前查找到的数据。如果第一个更新事务执行了提交，那么后续的更新事务会忽略第一个事务删除的行，然后针对已经更新过的数据上面执行它自己的操作。语句里面的查询条件（where 语句）会重新被执行来查看已经更新的数据是否还满足条件。如果满足，那后续的更新事务会在已经更新过的数据上面执行他自己的操作。如果执行的是 select for update 和 select for share 语句，那会返回或者锁定更新后的数据给客户端。</p>
<p>基于以上规则，一个更新语句可能会得到一个“不稳定”的快照。它会“看”到其他并发事务对它将要更新的数据的修改，但是“看”不到其他并发事务对其他数据的修改。这个行为会导致读已提交事务隔离级别不适用于一些复杂的查询，只适用于简单的情况。例如，想象一下在事务里面更新银行账户余额：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">BEGIN</span>;</div><div class="line"><span class="keyword">UPDATE</span> accounts <span class="keyword">SET</span> balance = balance + <span class="number">100.00</span> <span class="keyword">WHERE</span> acctnum = <span class="number">12345</span>;</div><div class="line"><span class="keyword">UPDATE</span> accounts <span class="keyword">SET</span> balance = balance - <span class="number">100.00</span> <span class="keyword">WHERE</span> acctnum = <span class="number">7534</span>;</div><div class="line"><span class="keyword">COMMIT</span>;</div></pre></td></tr></table></figure>
<p>如果有两个类似的事务要更新 12345 这个帐号的余额，我们显然是希望第二个更新事务是基于第一个的结果来更新。因为每个语句都是更新既定的数据，所以只能“看”到更新的数据不会造成不一致。</p>
<p>在读已提交事务隔离级别里面，复杂一点的情况可能会得到预期之外的结果。例如，想象一下一个 delete 语句操作的数据被其他语句从他的限制条件里面增加或者移除。例如，假设 website 是一个包含两行数据的表，其中 website.hits 字段分别等于 9 和 10。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">BEGIN</span>;</div><div class="line"><span class="keyword">UPDATE</span> website <span class="keyword">SET</span> hits = hits + <span class="number">1</span>;</div><div class="line"><span class="comment">-- run from another session:  DELETE FROM website WHERE hits = 10;</span></div><div class="line"><span class="keyword">COMMIT</span>;</div></pre></td></tr></table></figure>
<p>虽然在执行 update 前后，都有 website.hits = 10 的数据，但是那个 delete 语句将没有任何效果。这是因为未执行成功 update 前，9 这行数据是被 delete 忽略的，当 update 执行完毕，delete 得到锁之后，新的数据的值已经不是 10 而是 11 了，已经不再符合 delete 的条件了。</p>
<p>读已提交事务隔离级别在事务开始的时候会创建一个包含了在那个瞬间所有已提交的事务的数据的快照，同一个事务里面的后续语句会“看”到其他并发事务提交的数据。前面的问题的关键点是，单个语句是否可以得到一个持续一致的数据库。</p>
<p>读已提交事务隔离级别对于很多程序来说就已经足够了，使用起来快速简单。显然，它并不适用于所有情况。对于使用了复杂查询和更新的程序，或许需要对数据一致性要求比读已提交更加严格的事务隔离级别。</p>
<h4 id="13-2-2-可重复读事务隔离级别"><a href="#13-2-2-可重复读事务隔离级别" class="headerlink" title="13.2.2 可重复读事务隔离级别"></a>13.2.2 可重复读事务隔离级别</h4><p>可重复读事务隔离级别只能“看”到在事务开始前已经提交的数据，并且永远也“看”不到未提交的或者在事务执行期间被其他并发事务更新的数据。（当然，查询语句是可以“看”到在当前事务里面的已经执行的更新的，即使他们还没有被提交。）这么做比 SQL 标准里面针对这个隔离级别的要求严格，在表 13-1 里面表述的现象都不能发生。如前面所说，这么做标准是允许的，标准只描述了各隔离级别最低的要求。</p>
<p>这个隔离级别不同于读已提交隔离级别，在可重复读事务隔离级别里面一个查询可以“看”到事务开始的时候的一个快照，不是当前事务里面当前查询开始的时候的快照。因此，一个事务里面成功执行的 select 语句会得到相同的结果，也就是说，他们都”看“不到在事务开始之后其他事务提交的修改。</p>
<p>使用这个隔离级别的应用，应该在遇到序列化失败(serialization failures)的时候准备好重试。</p>
<p>update, delete, select for update, 和 select for share 这些语句在查找目标数据的时候的时候，表现和 select 是一样的：都是只能查找到在事务执行开始的时候就已经提交的数据。然而，这些目标数据可能就已经被其他并发事务修改（或者删除、加锁(locked))了。在这种情况下，可重复读事务将会等待第一个执行了更新的事务的提交或者回滚（如果他仍然在执行中）。如果第一个更新事务执行了回滚，那么它的执行结果会取消，后续的更新事务会处理所有之前查找到的数据。如果第一个更新事务执行了提交（真的对数据执行了更新或者删除，不是只是加了锁），那么可重复读事务会执行回滚，并且报错</p>
<figure class="highlight monkey"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">ERROR</span>:  could <span class="keyword">not</span> serialize access due <span class="keyword">to</span> concurrent update</div></pre></td></tr></table></figure>
<p>因为可重复读事务在事务开始后不能对被其他事务做了修改的数据做修改或者锁定。</p>
<p>当应用程序得到这个错误信息的时候，应该立刻中止当前事务，重新从事务开始再次执行。再次执行的时候，这个事务就可以”看“到之前被其他事务提交的修改了，所以使用新版本数据作为新事务的起点的时候，就不会再有逻辑冲突了。</p>
<p>要注意只有有更新操作的事务才需要重试，只读的事务是永远不会有序列化冲突的。</p>
<p>读已提交事务隔离机制严格保证了每个事务都得到一个完整稳定的数据库快照。However, this view will not necessarily always be consistent with some serial (one at a time) execution of concurrent transactions of the same level. For example, even a read only transaction at this level may see a control record updated to show that a batch has been completed but not see one of the detail records which is logically part of the batch because it read an earlier revision of the control record. Attempts to enforce business rules by transactions running at this isolation level are not likely to work correctly without careful use of explicit locks to block conflicting transactions.</p>
<p>提示：在 PostgreSQL 9.1 以前，序列化事务隔离级别的情况和前面描述的信息是一样的。如果需要以前的序列化事务隔离级别，那可以使用现在的可重复读隔离级别。</p>
<h4 id="13-2-3-序列化隔离级别"><a href="#13-2-3-序列化隔离级别" class="headerlink" title="13.2.3 序列化隔离级别"></a>13.2.3 序列化隔离级别</h4><p>序列化事务隔离级别是最严格的事务隔离级别。这个级别把所有已经提交的事务模为拟序列化执行，就像是事务执行完一个执行另一个，顺序的，而不是并发的。当然，类似于可重复读事务隔离级别，应用程序在序列化失败的情况下必须要准备好重试。事实上，这个级别和可重复读事务隔离级别是一模一样的，除了会监控 except that it monitors for conditions which could make execution of a concurrent set of serializable transactions behave in a manner inconsistent with all possible serial (one at a time) executions of those transactions. This monitoring does not introduce any blocking beyond that present in repeatable read, but there is some overhead to the monitoring, and detection of the conditions which could cause a serialization anomaly will trigger a serialization failure.</p>
<p>举个例子，比如有表 mytab，初始的时候如下：</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="section"> class | value</span></div><div class="line">-------+-------</div><div class="line"><span class="code">     1 |    10</span></div><div class="line"><span class="code">     1 |    20</span></div><div class="line"><span class="code">     2 |   100</span></div><div class="line"><span class="code">     2 |   200</span></div></pre></td></tr></table></figure>
<p>假设在序列化事务 A 里面执行：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(<span class="keyword">value</span>) <span class="keyword">FROM</span> mytab <span class="keyword">WHERE</span> <span class="keyword">class</span> = <span class="number">1</span>;</div></pre></td></tr></table></figure>
<p>然后把结果（30）作为 value 字段，class = 2 作为新行插入回去。同时，序列化事务 B 里面执行：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(<span class="keyword">value</span>) <span class="keyword">FROM</span> mytab <span class="keyword">WHERE</span> <span class="keyword">class</span> = <span class="number">2</span>;</div></pre></td></tr></table></figure>
<p>得到结果 300,并把结果和 class = 1 作为新行插入回去。然后两个事务都尝试提交。如果任意事务执行在可重复读级别，那么两个事务都可以提交; but since there is no serial order of execution consistent with the result, 使用序列化事务隔离级别的话，会允许其中一个事务提交，而回滚另一个事务，并且报如下错误信息：</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ERROR:  could <span class="keyword">not</span> serialize access due <span class="built_in">to</span> <span class="built_in">read</span>/<span class="built_in">write</span> dependencies <span class="keyword">among</span> transactions</div></pre></td></tr></table></figure>
<p>这是因为如果 A 在 B 之前执行的话，B 的计算结果就会是 330 而不是 300,类似的，其他顺序会导致 A 得到不同的结果。</p>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="postgresql-transaction-isolation/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="upgrade-myself/">成长</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2015-02-19T10:05:55.000Z" itemprop="datePublished">Feb 19, 2015</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/heart/">heart</a>
</div>
    </div>
      
        <p>刚开始参加工作，通常都是钱多少，户口给不给，安逸不安逸等等这种单一原因决定去哪里工作。一般都还没那个能力综合考虑一家公司。</p>
<p>那么选择大公司？选择初创公司？还是选择业界有影响力的公司？思考了很久，最后发现，这个时候选择什么公司不重要，重要的是自己，要选择自己感兴趣的，能保留自己强烈的求知欲的公司，最好公司的业务方向就是自己感兴趣的。</p>
<p>刚进入公司这二年很重要，在此期间能学习到大量的学校学习不到的技能，比如和同事相处，怎么理解需求，代码怎么写更好，工程如何组织等等。而这些东西，通常都是靠自己学习来搞定的，通过公司的一些培训（如果有的话），通过自己的观察，通过自己从互联网等资料学习的。这个期间你要强迫自己不停的学习，不停的思考。</p>
<p>在一个公司呆大概一年到二年左右，逐渐参与几个项目之后，应该已经可以独立承担负责一些小的事情了，这个时候一般会开始遇到瓶颈，可以学习的似乎都学的差不多了，一般都会开始思考”这家公司是否适合我”，或者”自己是否考虑换个工作经历一下”，要不然就是”你看有的同学换了一个工作工资涨了50%”，这些原因加起来，可能就会考虑是不是要换个公司了。</p>
<p>那么要不要换呢？从开拓眼见上面来讲，换是有一定意义的。各公司通常有各公司的一些运作方式，有一些包括一些很好的经验。通过换工作，可以学习到不少项目运作，分工合作的方式。</p>
<p>当然通常这些事情并非一定要换工作才能学习到，通过社交也能了解一部分。另外还有一个情况，别的公司的一些成功经验，也并非一定会适用你的团队。</p>
<p>一般来讲，技术工程师有两个方向的发展。一个是资深的技术大拿，一个是管理方面的 leader。两个方向不冲突，有些人可以兼顾。技术大拿指的是那些代码能力极强，很能专研技术，对管人没有兴趣，只对自己研究的技术有兴趣的人。管理方面指的不是技术一点都不行的，一般也得对技术有一定的了解，但是更多的精力会花在组建打理团队上面，对业务比较熟悉，能很好的把业务方向和技术结合起来的人。</p>
<p>为什么讲这个呢？和换工作有关系么？首先看你的方向是哪个。如果是专研技术，那么关注的应该是这个公司是否可以提供给你一个专心专研技术的氛围。有些技术是和业务结合比较紧密的，这种倒还好，但是有些是离业务比较远的，比如研究内核。一般业务团队都不乐意养一个研究和业务方向无关的人。</p>
<p>如果是搞管理，那应该关注的是你的业务是不是有前景，你的老大负责的业务是不是有前景，你所在的公司搞的业务是不是有前景。当然，在视野比较小的时候，可能很难判断。简单点，就看看你的老大是不是让你觉得他很牛逼吧。如果你对他都不崇拜不佩服，那可能就得仔细考虑下了。</p>
<p>需要关心公司的前景吗？刚工作没两年的人可能会觉得，公司再赚钱也不会多给我发多少，反正我就赚那么多，好像和我没关系。其实是有关系的。只有公司前景好，才有能力去养活更多的人，才有更多的业务方向给大家去尝试，才有机会创造更大的财富，大家也才有机会获得更多的回报。只有不断成长的公司，你的技术能力才有机会体现，才有机会负责更多更重要的事情，也就是所谓的有更多的机会。</p>
<p>当然，可能前提是你得进入一个正常的公司，有一个正常的领导。 :D</p>
<p>两年之后，一般就会有一些事情让你负责了，不管是重要的技术还是团队或者业务。这个时候就开始考验你的 leader 能力了。领导技术研究方向来支持业务，领导团队拿到更好的成绩。</p>
<p>有时候跟着牛逼人物混会产生一种自己也很牛逼的错觉。当牛逼人物不在的时候，会猛然发现，离开人家之后自己好像啥都搞不太好。所以其实最重要的是学习牛逼人物的一些思考问题的方法，以及培养适合自己的学习思考和工作的方式。这些才是自己后面受用不尽的东西。</p>
<p>两年之后的继续发展，全看你自己的能力了。思考自己后面的路的时候，你可以给自己设想一下，如果给你5个人，你能把现在的业务做成什么样子，或者你能搞出来什么引导潮流的什么牛逼技术？</p>
<p>如果给你 20 个人呢？50 个呢？你打算怎么办？</p>
<p>这就是所谓的成长。回答不了这些问题，说明你还没有成长。如果你能答好后面那个问题，能把 20 个人的事情安排到很好，那我估计你已经不需要看这篇文章啦。:D</p>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="upgrade-myself/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="notes-for-hackers-and-painters/">《黑客与画家》读书笔记</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2014-12-28T08:45:45.000Z" itemprop="datePublished">Dec 28, 2014</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/readings/">readings</a> <a href="../tags/lisp/">lisp</a>
</div>
    </div>
      
        <pre><code>如果某一天你想要去赚大钱，那么请记住这一点，因为这是创业公司能够成功的原因之一。大公司为了避免设计上的灾难，选择了减少设计结果的标准差。但是当你排斥差异的时候，你不仅将失败的可能性排除在外，也将获得高利润的可能性排除在外。这对大公司来说不是问题，因为生产特别优秀的产品不是它们的获胜手段。大公司只要做大不太烂，就能赢。
</code></pre><p>公司大到一定程度之后，更加希望稳定的可重复的产出，慢慢大家都会趋于稳定，不改变现有的系统。通常来说，创新和稳定肯定是冲突的，一旦选择的稳定，创新的积极性慢慢就会丧失。</p>
<pre><code>所以，viaweb 的开发人员总是与客服人员保持密切联系。客服人员坐在离程序员只有 9 米的地方，知道自己可以随时打断程序员的工作，提交新证实的 bug 的报告。遇到重大 bug，我们就算在开董事会，也会马上回来修改程序。
我们这种方式让所有人都感到满意。客户很高兴，拨打厂商服务热线是免费的，而且还被当做通风报信的人，受到郑重对待。客服人员也喜欢这样，因为这使得他们可以帮助用户，而不是对着用户读操作手册。程序员也喜欢这样，因为他们能够再现 bug，而不是通过模糊不清的二手报告了解 bug。
...... 客户支持实际上就是质量监控，也是某种程度上面的市场营销。除了记录 bug，客服人员还必须了解相关知识，回答与 bug 相关的一些问题，解释令使用者迷惑不解的功能等。有时，他们也扮演了使用者的代理人，我们会问他们哪个新功能是用户更想要的，他们总是能做出正确的回答。
</code></pre><p>短线沟通，及时响应的重要性。程序员的成就感，有时候不一定是来自于程序写的多好，能帮人解决问题有时候也会有成就感。短线能增加成就感。</p>
<pre><code>提高软件开发质量的关键在于开发的时候全身贯注，而不是降低开发速度。
</code></pre><p>这个和现代的敏捷开发做的事情类似，保证开发人员专注。</p>
<pre><code>&quot;帕金森定律&quot; 后来成为这些表现形式的代名词，它包括很多内容，其中有一条就是『因为你必须做到，所以你能够做到』。
可测量性和可放大性......如果你有一个令你感到安全的工作，你是不会致富的，因为没有危险，就几乎等于没有可放大性。
</code></pre><p>可测量和可放大性，一种衡量工作重要性的指标。</p>
<pre><code>假定软件有两个候选的新功能，它们创造的商业价值完全相同，那么我们总是选择较困难的那个功能。不是因为这个功能能带来更多的收入，而是因为它比较难。我们很乐于迫使那些又大又慢的竞争对手跟着我们一起走进沼泽地。 
创业公司就像游击队一样，喜欢选择不易生存的深山老林作为根据地，政府的正规军无法追到那种地方。我还记得创业初期我们是多么筋疲力尽，整天都为一些可怕的技术难题绞尽脑汁。但是，我还是感到相当高兴，因为那些问题连我们都觉得这么困难，那么竞争对手就更会认为是不可能解决的。
</code></pre><p>难才是体现价值的地方。</p>
<pre><code>注意，我说的是“用户需要的设计”，而不是“用户要求的设计”。我不想让读者产生一种印象，认为设计师就像厨师一样，顾客点什么菜就一模一样做出来。艺术的各个领域有着巨大的差别，但是我觉得任何一个领域的最佳作品都不可能由对用户言听计从的人做出来。
</code></pre><p>所谓的产品设计。应该是设计用户需要的，而不是用户要求的。</p>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="notes-for-hackers-and-painters/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="how-to-take-care-of-diabetic-cats/">如何照顾糖尿病猫猫</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2014-01-19T14:16:09.000Z" itemprop="datePublished">Jan 19, 2014</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/diabetic/">diabetic</a> <a href="../tags/cats/">cats</a>
</div>
    </div>
      
        <p>注1： 最前面先公布个群，名字叫做“糖猫猫”，号码是 143834033。里面好多糖尿病猫猫的主人，可以交流，大家都很热心。</p>
<p>注2：再在前面说点，本文最初是基于宠物医院使用的稀释的办法给猫打胰岛素的，不过后面发现了一个更好的办法，使用 bd 针管，具体看最后补充的吧。</p>
<p>猫的糖尿病其实和人的是类似的，估计哺乳动物都这样。和人一样，猫猫上了年纪也容易得各种老年病，糖尿病就是其中一种。好像看到资料说做过绝育的母猫的得病几率更加大。</p>
<p>我理解糖尿病应该是一种慢性病，遇到得糖尿病的猫如果救助及时，应该是可以恢复的。好的话，甚至可以恢复胰岛素的分泌，摆脱胰岛素注射。</p>
<blockquote><p>動物吃下去的食物在身體裡被轉換成葡萄糖，隨著血液在身體裡流動，提供細胞養分，並且製造能量。身體裡的胰島素則是幫助細胞從血液裡取得所需能量的媒介。在正常的情況下，葡萄糖進入身體後，胰腺細胞開始釋放胰島素，並將之分配至身體的細胞，以使他們能夠”捕獲”他們所需的葡萄糖。</p>
<p>胰腺負責製造足夠的胰島素，細心的平衡血液中的葡萄糖濃度以避免濃度過高(血醣過高症)或者過低 (血醣過低症)。然而，罹患二型糖尿病的動物，身體的細胞對於胰島素無法正確反應(亦即不會”捕獲”他們所需的葡萄糖)，加上身體無法自行處理過多的葡萄糖而導致體內葡萄糖濃度異常的高。</p>
<footer><strong>[http://catmaid.wordpress.com/2009/01/12/diabeticcat/] [如何照顧糖尿病貓?]</strong></footer></blockquote>
<h2 id="糖尿病症状的前期表现"><a href="#糖尿病症状的前期表现" class="headerlink" title="糖尿病症状的前期表现"></a>糖尿病症状的前期表现</h2><blockquote><p>糖尿病貓的早期症狀為體重減輕，食慾會明顯增加或是變的很貪吃，喝水量增加而且頻尿 ( 譯者註: 三多…吃的多、喝的多、尿的多 )。當身體無法處理葡萄糖，大腦開始釋放”多吃”的訊息以帶進更多的葡萄糖。此時，體內的葡萄糖濃度開始上升，但是因為胰島素缺乏而無法被利用，身體裡飢餓的細胞開始消耗脂肪及肌肉蛋白質以轉換為肝醣。由於這樣的過程不斷循環，血液中的葡萄糖滲入尿液中，並且將水分從細胞中帶出，導致貓咪不斷的感覺口渴,而大量喝水，而不論貓咪喝了多少水，身體仍然會一直處於脫水狀態。</p>
</blockquote>
<p>我看到的早期猫猫会表现出来，口渴，喝水多，同时尿多，饥饿，开始变瘦这些症状。</p>
<p>你会发现水碗空的很快，经常看到猫猫在喝水。同时猫砂盆里面会发现尿的也多了，经常会发现超大的猫砂球，同时猫砂也用的变多了，以前可能两天不收拾也没问题，现在一天一次都感觉很多。会发现猫砂球变粘了，不容易铲，这是因为尿里面含糖量太高。老表现出来饥饿，对以前没兴趣的东西也变的感兴趣。</p>
<p>上面总体就是我家猫初期的表现。如果能注意到，那及时把猫送宠物医院查查吧，血糖试纸验血很便宜。不过因为猫猫也不会说话，一般都会注意不到，注意到了也一般不会重视。</p>
<p>上面表现之后，就会发现猫慢慢的没精神，吃的少了，水到是还是经常喝，像我家猫总呆在饭盆水盆前面发呆，尤其是水盆，经常趴在水盆前面睡觉。这个时候猫猫症状就已经比较严重了，一般得到医院输液救治了。下面这段引用说的就是这个情况。酮酸中毒产生之后，猫猫就基本没精神加没胃口了。并且酮酸中毒之后，可能肾，肝这些部位也会开始产生问题，出现衰竭。</p>
<blockquote><p>最後由於身體不能利用葡萄糖做為能量來源，而使用體內的脂肪來取代，這些脂肪代謝產生的酮體，在體內累積過多後便產生酮酸中毒。酮酸中毒可以迅速發生或是在幾天內慢慢產生，如果不立即治療的話，則可能導致昏迷甚至死亡。</p>
</blockquote>
<h2 id="如何治疗"><a href="#如何治疗" class="headerlink" title="如何治疗"></a>如何治疗</h2><p>我总结的。不一定适合所有猫，供参考。</p>
<p>我家猫送医院的时候，就已经是酮酸中毒的症状了。中间<a href="http://wdicc.com/diabetic-cat-maomao/">几经周折</a>，久病成医，多少也可以讲讲，呵呵。</p>
<p>因为猫已经不吃东西了，所以肯定是需要输液，补各种微量元素（大夫关注的好像是钾和纳，钾元素不足就会出现没精神的状态），用短效胰岛素降血糖，让血糖持续稳定在 10 以下，不过要注意也不能太低，到 2 以下可能就会引发低血糖症状了，低血糖是比高血糖更可怕的情况。我家猫当时打的是 0.6 单位（有的地方用 u 标识单位） 的短效，我看到有网站提示说是按照体重每公斤 0.25u，我家猫当时是 2.3 kg，所以 0.6 差不多。</p>
<p>上面的目的是保持血糖数值的同时，补充身体电解质，补充体力。期间如果有了精神可以尝试喂 A/D 罐头，如果能吃东西，那我看基本就有救了。看情况可能会需要持续几天的重症监护，具体到什么时候看医生的安排吧，我感觉是看他的精神如果比较好了，就可以回家吃钾片，钾镁片等药恢复，也不用老输液，输液多也会导致血管堵塞等。</p>
<p>回家之后一个事情就是需要持续打胰岛素。那么自己验血糖，配胰岛素，打针就是不可避免的了。这三项技能我们分开说。</p>
<h3 id="验血糖"><a href="#验血糖" class="headerlink" title="验血糖"></a>验血糖</h3><p>验血糖和给人操作差不多，仪器也是和人通用的。我用的是怡成的jps7，国产的。有些进口的比如拜耳之类，机器比较贵的，试纸也贵。试纸是消耗品，像开始的时候，我家猫一天测个十几次的（2小时一次），进口的试纸就有点接受不了了。也有人进口的国产的都买，进口的几天测一次这种，平时用国产的。我觉得其实没啥必要，看个相对数就好，一般关注的就是下面几个范围。</p>
<ol>
<li>3 以下。有低血糖怀疑，如果表现出来低血糖的症状，要感觉处理。</li>
<li>3 到 7。正常的范围。</li>
<li>7 到 15。稍微有点高，但是问题不严重</li>
<li>15 到 25。有点高。</li>
<li>25 以上。很高。</li>
</ol>
<p>这上面是我总结的，那些边界不一定就是个定死的，理解大意就好。也可以参考<a href="http://petdiabetes.wikia.com/wiki/Blood_sugar_guidelines" target="_blank" rel="external">这里</a>写的，这里的专业。</p>
<p>顺便说下低血糖的症状。低血糖的表现在人就是头晕无力。猫不会说话，表现是无力，软趴趴的，你扶起来他会继续趴着，像块布一样，怎么摆布都没反应，那基本就是低血糖了，这个时候要赶紧送医院，看情况是输液，打针还是喝水补充葡萄糖。但是如果血糖低于 3，但是猫没有低血糖的症状，也不用着急，喂点吃的应该就会好起来，不要着急补充葡萄糖。低血糖是很致命的，会导致脑部缺能量，导致脑部出问题什么的，所以要慎重。</p>
<p>给猫采血一般可以是耳朵采血或者脚垫采血。据说脚垫采血如果弄不好的话，容易发生感染（大概是因为脚比较容易接触到脏东西），所以一般都是耳朵采。买血糖仪一般会带一个采血的笔，那个玩意很好用。可以参考下<a href="http://www.youtube.com/watch?v=4CDew2sNOcI&amp;list=WLocLdlbhE3tvtQuJjfqU5tUwWrucncUWR" target="_blank" rel="external">这个视频</a>。如果猫耳朵毛长可以剃一下，那个凡士林可以用红梅素膏代替，都是不太贵的东西。扎之前如果用酒精处理过的话，要定酒精干了才能扎。扎的时候如果不容易出血，可以调整一下笔的针头的位置，不过别调多了把猫耳朵扎穿。。。</p>
<h3 id="配胰岛素"><a href="#配胰岛素" class="headerlink" title="配胰岛素"></a>配胰岛素</h3><p>胰岛素我买的是来得时的长效，大概 180 一支，3ml 300个单位。还有短效可以选，不过一般是说长效的控制的好一点。短效和配合长效用，长期还是靠长效控制。</p>
<p>目前我家猫是每次 1.5u 每天 3 次，8 小时一次。早期的时候是每次 0.5u，后来慢慢调整涨上来的。我看有人每次 6u 每天 2 次的。还有每天 4 次的，猫有区别，不能照搬，得找到适合自己和自己猫的方法。看到一个说法是是按照体重来打，每公斤 0.25u，不过如果控制不住也没办法，只能加量。</p>
<p>就是说先得确认个自己猫的胰岛素的量是多少，这可能有个调整的过程，所以掌握算法还是有必要的，呵呵。</p>
<p>然后针管，因为每次打的量也不多，所以买 1ml 的那种就可以，淘宝上面便宜的几分钱一个，要注意针头不要太粗，否则猫可能会疼。只是要注意，针头里面其实是有空间的，那些是不算到刻度里面的。但是打针的时候那里面的其实是打不出来的。但是用它做度量的时候要注意是否需要算上针头里面的。</p>
<p>接下来买注射用水，就是稀释胰岛素的。因为 0.1ml 就是 10 个单位，所以一般需要稀释才能用。这个东西也不贵，我买到的是 2ml 装的。</p>
<p>万事俱备，就差公式了。胰岛素 1ml 是 100 个单位。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="number">100</span>x<span class="regexp">/(k+x) = y/</span>m</div><div class="line"></div><div class="line">其中的变量如下，前三个单位是 ml</div><div class="line"><span class="string">k:</span> 计划使用的注射用水的总量</div><div class="line"><span class="string">x:</span> 计划使用的胰岛素的总量</div><div class="line"><span class="string">m:</span> 每针计划注射的总量</div><div class="line"><span class="string">y:</span> 每针要注射的胰岛素的量，单位是单位 u</div></pre></td></tr></table></figure>
<p>上面公式的四个变量，确定三个就可以算第四个了。举几个例子。</p>
<p>比如计划每针 1 个单位（y=1），为了节省注射用水，每针计划注射总量 0.05ml（m=0.05）。还差 2 个变量，先简单演算下，比如计划 2ml 注射用水都用掉，那么 k 就是 2ml，算一下胰岛素是多少。</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="number">100</span>x/(<span class="number">2</span>+x) = <span class="number">1</span>/<span class="number">0.05</span> = <span class="number">20</span>/<span class="number">1</span></div><div class="line">x = <span class="number">0.5</span>ml</div></pre></td></tr></table></figure>
<p>胰岛素是 0.5ml。两方面抽出来之后，还需要有混合的地方，一般就选注射用水的瓶子就可以，所以根据结果只需要简单的抽 0.5ml 胰岛素，打入注射用水里面，得到的就是 0.05 含 1u 胰岛素的混合液。</p>
<p>再来一个例子，比如计划多打点 y=1.5, m=0.05, k=2ml，看看胰岛素应该是多少。</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="number">100</span>x/(<span class="number">2</span>+x) = <span class="number">1.5</span>/<span class="number">0.05</span> = <span class="number">30</span>/<span class="number">1</span></div><div class="line">x=<span class="number">60</span>/<span class="number">70</span>=<span class="number">0.86</span></div></pre></td></tr></table></figure>
<p>胰岛素是 0.86ml。虽然 0.06 不太好抽，但是似乎勉强也可以。不过难点是，2ml 的注射用水的瓶子里面，是放不进去 0.86ml 的，放 0.5ml 就差不多满了。。。。所以这样是不行的。那怎么办？</p>
<p>也简单，我们先确定胰岛素的量，既然 0.86ml 放不下，我们定个 0.7ml 试试看能不能放下。</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="number">100</span>x0<span class="number">.7</span>/(k+<span class="number">0.7</span>) = <span class="number">1.5</span>/<span class="number">0.05</span> = <span class="number">30</span>/<span class="number">1</span></div><div class="line">k= <span class="number">49</span>/<span class="number">30</span> = <span class="number">1.63</span></div></pre></td></tr></table></figure>
<p>这样，注射用水是 1.63ml ，然后胰岛素 0.7ml，混合后是 2.33ml，是可以放的下的。注射用水里面需要抽出来 2-1.63=0.37ml，然后就可以把胰岛素打进去了。要注意的是，抽出来的时候，针头里面是有空间的，那里面的量是不算到刻度里面的，把针头留空抽大概 0.37ml 就可以了。</p>
<h3 id="打针"><a href="#打针" class="headerlink" title="打针"></a>打针</h3><p>第一次打针可能会比较紧张，其实这是个非常简单的事情。可以在喂食的时候打针，糖尿病猫一般都是饿死鬼一样，根本不会理会你打针的。打针的位置是肋骨那里，或者大腿根部上面。把皮揪起来，在皮的中部靠下的位置，可以参考<a href="http://petdiabetes.wikia.com/wiki/Syringe" target="_blank" rel="external">这里</a>，左侧的正确的图，扎进去，推药就可以了，要注意不要扎穿了。。。。如果觉得有需要可以先用酒精擦拭，不过要等酒精干了再打。</p>
<h2 id="后期保养"><a href="#后期保养" class="headerlink" title="后期保养"></a>后期保养</h2><p>这块我还没有太多经验，因为我家猫还没有脱离胰岛素，只能是讲讲道听途说的一些。</p>
<p>猫的状态比较稳定之后，就进入长期和糖尿病斗争的阶段了。可以喂糖尿病猫粮，淘宝不让搜糖尿病，可以搜 “wd 猫粮”。不过是，喂干粮容易让血糖起来，我看有些人常年喂罐头，不过感觉有点贵，而且，湿粮吃多了会得口炎。。。。据说也可以喂蒸鸡胸，但是又说鸡肉含磷多，吃多了也不好。。。。所以我也不清楚。目前在尝试喂鸡肉看看，也不敢多喂。</p>
<p>现在情况就是一天三针，每次打针后喂干粮，两针期间饿了就喂点鸡肉，没鸡肉就少吃点干粮。大致就这样了。等我有了经验再来补充。</p>
<h2 id="update-2014-1-31"><a href="#update-2014-1-31" class="headerlink" title="update 2014.1.31"></a>update 2014.1.31</h2><p>翻了一些资料，看到<a href="http://petdiabetes.wikia.com/wiki/Low-carb_diet" target="_blank" rel="external">低碳水化合物疗法</a>。讲人吃低碳的食物有助于糖尿病恢复，那理论上猫也可以。并且<a href="http://petdiabetes.wikia.com/wiki/Category:Feline_regulated_cases" target="_blank" rel="external">这里</a>有一些低碳疗法的实例。</p>
<h2 id="update-2014-2-2"><a href="#update-2014-2-2" class="headerlink" title="update 2014.2.2"></a>update 2014.2.2</h2><p>低碳疗法的主要理论支持是讲猫可以把脂肪转化成葡萄糖，举例说野猫只吃老鼠，但是也可以活的很好。干粮得依靠碳水化合物形成最后的形状，所以干粮离不开碳水化合物。这里有个<a href="http://web.archive.org/web/20060616054707/www.geocities.com/jmpeerson/dryfood.html" target="_blank" rel="external">列表</a>，列出来了各种干粮的碳水化合物含量，里面最低的就是 Innova EVO Cat &amp; Kitten，这个在淘宝有卖，不过据群里人说，这个好像有点油也不太好，但是脂肪含量高了，肯定就油了啊，我也不清楚了。我现在喂的是 hills W/D 猫粮，这个倒是不油，不过感觉好像应该喂 M/D 才对……</p>
<h2 id="update-2014-2-9"><a href="#update-2014-2-9" class="headerlink" title="update 2014.2.9"></a>update 2014.2.9</h2><p>目前找到的靠谱一点的干粮有下面这些。</p>
<ul>
<li>innova evo 英诺华（凌采露华）evo</li>
<li>hills m/d 希尔斯 m/d</li>
<li>Royal Canin Veterinary DS46 皇家 DS46</li>
</ul>
<p>这几个都不便宜，淘宝上面差不多一公斤 70 - 100 块钱。</p>
<h2 id="update-2014-3-1"><a href="#update-2014-3-1" class="headerlink" title="update 2014.3.1"></a>update 2014.3.1</h2><p>这几天 hills md 和 evo 都断货了，只好开发新的。今天翻了一下，发现 <a href="http://www.petcurean.com/for-cats/go/" target="_blank" rel="external">petcurean</a> 的 go 品牌的猫粮似乎也可以，查了紫色包装的 FIT + FREE Chicken, Turkey + Duck （淘宝上面关键字是七种肉）和绿色包装的三种鱼，碳水化合物含量都是 13% 左右。今天买了2斤似乎效果还行，试试看。</p>
<h2 id="update-2014-6-16"><a href="#update-2014-6-16" class="headerlink" title="update 2014.6.16"></a>update 2014.6.16</h2><p>好久没有更新了。再次更新下。</p>
<p>饮食上面，自上次开始使用七种肉之后，一直到今天都在喂这个。一天打几次针喂几次。中间饿了就喂点蒸鸡胸肉。开始的时候食量很大，总是表现出很饿的样子，后来随着体重增加，慢慢的就吃的少了。</p>
<p>打针上面，开始打的是 1 个单位，后来改成 1.5 个单位，但是还是发现会有 20 多血糖的情况，就增加了一次打针，一天三次打针。后来持续了一段时间之后，血糖降到了 10 几，就把打针改回了一天 2 次，每次 2 单位。持续了一段时间之后，出现了小于 10 的血糖，大于 10 的情况比较少了，就开始减量到 1.5 了。目前是 1.5 单位一天两次。这两天测试很多时间都是 10 以下了，可能需要考虑再减量了。</p>
<p>要注意猫吃完干粮血糖肯定会增加，这个时候别着急加量，最好过个 1,2 个小时再看，如果还是高，那可能是需要加量了。</p>
<p>我家猫现在吃的变少了，尿的也明显变少了，目前感觉恢复的还可以。正在考虑减量或者减打针次数。</p>
<h2 id="收集到的一些参考资料"><a href="#收集到的一些参考资料" class="headerlink" title="收集到的一些参考资料"></a>收集到的一些参考资料</h2><ul>
<li>关于胰岛素剂量调整的一些经验 <a href="http://blog.sina.com.cn/s/blog_59c48f3f0102eedw.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_59c48f3f0102eedw.html</a></li>
<li>一些详细的照顾猫猫的经验 <a href="http://bbs.movshow.com/thread-412475-1-1.html" target="_blank" rel="external">http://bbs.movshow.com/thread-412475-1-1.html</a></li>
</ul>
<h2 id="update-2014-11-30"><a href="#update-2014-11-30" class="headerlink" title="update 2014.11.30"></a>update 2014.11.30</h2><p>在群里朋友的推荐下，已经使用了一段时间的 bd 针管了。bd 针管和普通针管主要的区别如下：</p>
<ul>
<li>bd 针管没有针头，这样打针的时候就不会损失针头里面的药。也不用担心隐藏的气泡什么的。</li>
<li>bd 针管没有的刻度和来得时搭配之后，刚好可以理解成是单位，一个刻度是 0.5u。</li>
<li>可以不用提前稀释配药了，用的时候从来得时抽就可以。</li>
<li>bd 针管针头更加细，猫没有感觉。</li>
</ul>
<p>好处可能还不止这些了，用起来还不错，推荐使用。购买的话，在群里面有人卖，一次买一大盒，然后可以用好久。我目前在重复使用，基本是一周换一个。用的时间长了会发现针头变钝，最好多换。</p>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="how-to-take-care-of-diabetic-cats/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="diabetic-cat-maomao/">毛毛的病情</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2014-01-18T14:16:09.000Z" itemprop="datePublished">Jan 18, 2014</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/毛毛/">毛毛</a> <a href="../tags/diabetic/">diabetic</a> <a href="../tags/cats/">cats</a>
</div>
    </div>
      
        <h2 id="第一篇"><a href="#第一篇" class="headerlink" title="第一篇"></a>第一篇</h2><p>我家两只猫，一只叫妞妞，现在大概11岁多，一只叫毛毛，现在大概10多岁。两只都陪伴我们超过 10 年了，现在生病的是毛毛，毛毛是我从出满月就开始养的。</p>
<p>大概最近一个多月，发现的毛毛不太爱吃猫粮，总是蹲在水盆猫粮盆前面发呆，开始还觉得好玩，不知道他再思考什么。大概是 12.28 周六，发现毛毛好像精神头也没了，12.29 周日早上，发现好像更加严重了，就赶紧抱到了楼下的宠物医院（京东万康，发现这医院还在点评的推荐医院列表里面），医生给测了体温，说是体温低，挺危险的，建议做个检查，直接给我一个单子，650。缴费之后，开始做检查，好像是验了血，生化，x光（单子和化验结果最后也没给我们，化验结果我们拍了照片。现在想想，当时应该和他们闹一通的，太恶心了），检查结果出来后，直接拿来一个单子，就是医院那种治死了也不负责什么的让我签，我就说你们这太扯了把，啥毛病不和我说就让我签这个，那个医生赶紧就开始和我说血糖还有什么xx有点高，然后就指着x光说肝肾啥的有毛病，然后说膀胱有憋尿的情况，说可能是结石之类的，说是体温低挺危险的啥啥的，我问怎么办，说是先让他排尿，说是弄个导管，或者做个穿刺啥的，我一听就觉得不太靠谱，猫都这样了，不会起因是尿憋的吧，而且他们也没个具体的说法说到底是什么毛病。我就和我老婆说到观赏把。</p>
<p>到了观赏是项夫给看的，继续开化验，之前600 多的医生就是拿着手机看了会，最贵的生化没开，验血拍B超。我们去的时候刚好中午，毛毛精神那会已经很差了，b超的大夫去吃饭了，我老婆哭着找了半天大夫才来了一个给开始b超，所有结果出来后，基本就是尿道没问题，肝功能基本正常，有点肾衰竭的的情况，然后就是血糖高 28。就开始按照糖尿病治了，输了6个小时液，输完之后我们担心胰岛素打多了血糖变太低（是同再那看病的一个主人提醒的，说他见过先例），就找大夫又验了血糖，大概是十几，还算可以。然后就回家了。</p>
<p>昨天 12.30 周一，又去输液，在车上的时候发现这小家伙比第一次去力气大了好多，一路叫，我和老婆还挺高兴，感觉是再变好，后来到安贞那块的时候突然不叫了，吓了一跳，到了医院好多人排队，和大家说了一下，大家都说你快先看把，我们插了个队。换了个大夫，继续让验血，验完之后说血糖是 18 还是高，就继续输液到半夜。中间验了一次血糖，降到了10 以内，还验了一次尿，好像是 4++，也不知道和人的是不是一样。</p>
<p>这两天我和老婆两个人眼泪都哭干了，我一个大老爷们，昨天本来去上班的，说让我老婆带着去看，结果一个人做地铁就忍不住的掉眼泪，到了单位一想起来猫就想掉眼泪，后来请了半天假，回家了。</p>
<p>目前我们感觉毛毛每天输液什么的，应该还能持续一段时间，他现在也没胃口，只喝水不吃东西，现在就是用针管再喂那种婴儿吃的果泥（鱼味道的），他到是不吐，不过喂不多，一会就会开始反抗，所以不知道有没有糖尿病猫猫的主人有没有什么经验可以传授的，多谢了。</p>
<p>另外，各位猫猫主人，如果发现猫有食欲不振或者守着盆子发呆的情况，一定要注意，因为动物的耐受力比较强，他们什么东西都不吃的时候，病基本就已经很严重了。</p>
<h2 id="第二篇"><a href="#第二篇" class="headerlink" title="第二篇"></a>第二篇</h2><p>今天是 2013 年最后一天，继续带毛毛去看病。今天去了本来想找郑义大夫（是个女大夫），结果她进来开会，没找到，并且之前见过相夫，还有一个姓郭的大夫都没来，只好找了一个新的叫做张炎，就是这个傻逼差点把毛毛害死。</p>
<p>今天测血糖是 17，这样这三天测出来的血糖依次是 28, 18, 17。这个大夫也是想做个生化，我们因为做过了，没让做，可能他发现也没什么可以做的化验了，比较郁闷，就说给开3天的药，我想了下明天1.1 医院好像放假，就说开吧，然后给开了 6 个单位的胰岛素，注意是 6 个单位，3 个单位的长效，3 个单位的短效。而我们之前打的都是 0.6 个单位的短效，等于他一下放大了 10 倍。药是我开的，我也没注意这个单位的问题。打完之后开始输液。大概输了 2 个多小时，我老婆找到了郑义大夫询问毛毛的情况，郑大夫就过来看了一下，摸了一会肚子，说有点尿，有点粪便（其他大夫都是让去做b超啊，化验啊去测这个，只有郑大夫是上手摸的，郑大夫还给其他几个猫摸来着），给小力气挤了一下尿看是不是能出来，结果毛毛就开始撒尿了。其实之前毛毛一直想下地，估计就是想尿的。</p>
<p>然后郑大夫就随口问了一句胰岛素打了多少，我们就赶紧翻单子，说不用翻，就去问护士，护士说是 6 个，郑大夫当时估计就蒙了，确认了好几次，就和护士说拿葡萄糖来打，另外安排了赶紧测血糖。血糖结果是 6.9。郑大夫解释说短效大概 4 个小时可以排出去，长效 4 个小时之后才起作用，我们猫现在就这么低的血糖，那等到了晚上长效起作用，那就得低血糖了。所以持续打了几个小时的葡萄糖，之后又验了一下，7点几，还好。然后让我们先回来了，说今天晚上2，3点的时候是长效起作用的关键时候，说得观察看看猫是不是比较低迷。另外让我们回来也给毛毛喂些东西，补充下血糖。</p>
<p>今天毛毛回来虽然看着还是腿软，但是居然自己跳上了宜家的小凳子了，然后上了沙发，现在在我腿旁边睡着了。一会还得想办法给他喂点吃的，希望今天晚上没事。唉。看病遇上傻逼大夫真没办法，据说前几天就有只猫也是让他给搞到低血糖了，差点死了，这大夫我觉得可以上黑名单了都，还专家呢。</p>
<p>郑义大夫真是个好大夫，在另一个帖子说再伴侣被一个星期干了三次手术的猫，今天去了说是自己吃了一点点鸡肝，开始吃东西了。并且今天明显状态好了很多。</p>
<p>今天有只在那边抢救了好几天的狗走了，心脏病，我们第一天去的时候就在那抢救了，老头老太太轮番给守夜，今天没挺过去。我老婆伤心的哭了几把，唉。</p>
<h2 id="第三篇"><a href="#第三篇" class="headerlink" title="第三篇"></a>第三篇</h2><p>今天是 2014 年第一天，昨天晚上回来就加了个精华区里面糖尿病猫妈的糖猫猫群，和里面有几个病友交流了下情况，感觉毛毛真是有救了。</p>
<p>昨天一晚上回来毛毛就比较嗜睡，在床边睡了一晚上。今天早上我看毛毛还在持续睡，感觉状态有点不对，发现他自己睡的地方尿了一泡，要知道前几天可没这个情况，他虽然难受也是自己去厕所的。所以我就去搜了一下低血糖的症状，发现嗜睡，腿软毛毛身上就有，早上起来持续喂了几次饭和水，好像没多少改善，楼下买了些葡萄糖，调成 10% 的，喂了 10ml，发现好像也没多少改善，我们也不敢多喂了，观赏今天郑大夫休假，我们也不敢去了，想起来糖猫猫群里面有推荐纳吉亚，就打电话问了下，结果郭大夫刚好上班，就开车过去了。</p>
<p>纳吉亚比较小，去了后挂号也没收钱，郭大夫比较忙。毛毛的状态看着不太好，等到了我们，我老婆忍不住又开始哭了，郭大夫看了下情况，就赶紧安排吸氧，氯化钾，葡萄糖两个一起输，然后测血糖，都已经到 2.x 了，晚点估计都得挂了。持续输了一会，再验血糖到了 10 多之后就停了葡萄糖了。然后好像给吃了补钾什么的药，因为纳吉亚地方实在太小，所以后面基本是我老婆在看着猫，所以我也不是很清楚具体打了什么针，吃了什么药。总之就是下午我观察毛毛的状态感觉是好很多了，比前几天都好。6点多他们下班的时候，郭大夫过来安排晚上的治疗，因为他们不是 24h，所以晚上得我和我老婆一起弄了。教了我们怎么测血糖，怎么打胰岛素，怎么喂药什么的。还给准备了几十个胰岛素的针，0.5 和 1 个单位的各好多。另外还准备了葡萄糖注射液。让我们到家之后每个小时测试一下血糖情况，根据血糖情况，打不同量的胰岛素，或者打葡萄糖补糖。还留了电话，说要是出现呼吸急促，1 分钟超过 50 次的话，或者有什么异常情况的话，就给他打电话。总之是把晚上都安排妥了，让我们明天早上 9 点他们开门就去，继续治疗。这大概就是今天的情况了。</p>
<p>纳吉亚这边收费项目比观赏少了很多，比如观赏挂号就是30，吸氧针管输液都不少钱。在纳吉亚这边的时候，有些项目就不收钱了，比如吸氧针管，吸氧没收钱，给我们配了十几个胰岛素针，只是收了针管的钱和一大瓶的钱，等于免费给配的。旁边小猫的纸尿片也是他们免费给的，观赏是 2.5 一个买的。我昨天下单买了50片，20多块钱，和他们那个是一样的。因为下午需要一个小时测试一下血糖，郭大夫还说诊所的收费高，让我们自己买试纸用他们的仪器测。并且今天晚上因为需要持续观察血糖，还把血糖仪让我们带了回来。</p>
<p>今天下午老婆一直再骂观赏的那个张炎，毛毛真的是差点就被他害死了。现在看毛毛的状态已经非常好了，今天回来之后吃了不少郭大夫给开的 ad罐头，因为还输着液，所以要固定毛毛再一个地方待着，现在我老婆正和他再斗争呢，毛毛的性格一直就不会老实再一个地方待着的，现在看来状态真是恢复了。</p>
<p>感谢各位的祝福，新年第一天，毛毛要重生啦。</p>
<h2 id="第四篇"><a href="#第四篇" class="headerlink" title="第四篇"></a>第四篇</h2><p>今天是 2014.1.3，这两天没来更新了。今天更新下。</p>
<p>1.1 回来之后按照郭大夫要求输着液，郭大夫的意思是先调整身体状态，再调血糖。带了很多胰岛素葡萄糖啥的回来，然后基本2个小时检查一下血糖，然后根据情况考虑打胰岛素。因为毛毛总动，所以我和老婆两个人换着看，每人也就睡了3个小时，1.2 早上8点多就出门去纳吉亚继续输液，检测到一些什么值异常，怀疑心脏啥的毛病之类，所以继续输液。1.1 早上的时候看毛毛的情况明显已经好转了，活泼多了。这两天因为是工作日，把我老婆送过去之后，我就去上班了。下午提前请假下班再过去接她回家。昨天也就是 1.2 晚上。我和老婆继续换班，每人睡了 3 个小时，10点多打了长效胰岛素，持续观察了一晚上的血糖情况，每小时一记录。1.3 也就是今天早上，继续去纳吉亚输液。</p>
<p>今天晚上我和老婆总算是可以休息了，不用盯着了。这两天毛毛食欲已经都恢复了，不止吃罐头，连给另一只猫的普通猫粮都吃，不过我们没敢喂，还是继续给 ad罐头。打算明天开始喂处方猫粮。今天晚上的任务就是 10点多打一个长效，然后检测下血糖情况，早上起来继续去医院输液调整。今天晚上总算可以好好睡一觉了。</p>
<p>截止到今天，基本可以认为毛毛已经恢复了。剩下的工作就是针对糖尿病的持久战了。</p>
<h2 id="第五篇"><a href="#第五篇" class="headerlink" title="第五篇"></a>第五篇</h2><p>好久没更新了，最近毛毛的病已经基本稳定了。现在持续在给他打针，每天目前要吃的要水看着好像还行。血糖现在也是测一次不测一次的，好像有点懒散了，不过持续一段时间看看吧，先这样了。等有时间，整理一下糖尿病猫的照顾方法。</p>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="diabetic-cat-maomao/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="campus-recruiting/">campus recruiting</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2013-10-07T08:38:00.000Z" itemprop="datePublished">Oct 7, 2013</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/heart/">heart</a>
</div>
    </div>
      
        <p>去年就参加了校招的笔试和面试，不过都是在北京，和其他同学的经验交流也不是很多，今年参加了外省3个地区的校招，有点心得记录一下。</p>
<h3 id="笔试题"><a href="#笔试题" class="headerlink" title="笔试题"></a>笔试题</h3><p>笔试题非常重要，因为第一轮筛选全靠他了。</p>
<p>笔试题的难度要考虑好，需要把哪些代码能力差的，思路不靠谱的都筛掉。当然通过一两道题筛人有可能漏掉好的，但是这种几率非常小，真漏掉也没办法，毕竟一般能通过的人会很多的。</p>
<p>我的经验是，第一题出一道实际中存在的问题，但是又得让只会 c/c++ 的同学做起来不是很复杂的，不能只想着用 python 一句话就做出来之类，那样阅卷会很困难。比如把一句英文中所有单词的首字母大写，这种题就很好。但是比如给两个文件找他们共存的字符串就不太好，只会 c 语言的同学做这个题会很费劲。</p>
<p>第二题稍微要有点区分度，要考察下数据结构相关的内容。比如 hash 懂不懂，排序算法会不会之类。</p>
<p>我觉得笔试时间不宜太长，一道题给 20 分钟足够，也避免了不会的人在那瞎掰一通，将来阅卷困难。</p>
<p>笔试也要注意考场纪律，不允许交头接耳，能隔开坐最好，不能的话，可以考虑让先来的都隔开，后来的往进插，这样能隔开好朋友，能最大限度避免作弊。看到作弊的要提醒一下，提醒无效的就收卷子，或者调座位。</p>
<h3 id="面试"><a href="#面试" class="headerlink" title="面试"></a>面试</h3><p>一个人一天大致能面试 15 个左右，差不多 30-40 分钟一个。</p>
<p>面试考察三个方面。</p>
<ul>
<li>搞过的项目，实验的方向，是否都弄明白了。这个一般就是一边讲，一边问，抓到点就详细问一下，看看是否确实掌握了，同时也能考察到他的学习能力。</li>
<li>学校学的东西是否都扎实。这也就是所谓的基础知识了。一般就是数据结构算法，网络等。</li>
<li>沟通交流是否顺畅。是不是能很好的理解问题，能通俗简单的讲明白学到的东西。</li>
</ul>
<p>就我面试的经验，我感觉上面三个方面就足够了，如果都觉得可以，那基本就没问题了。如果某个方面有缺陷，那还得看其他方面是否有很多的加分。</p>
<h3 id="面霸"><a href="#面霸" class="headerlink" title="面霸"></a>面霸</h3><p>对于面霸，也不要直接拒绝，最好最后一天统一给安排一次笔试，出一道题考察一下。这题一定要有区分度，类似笔试题的第二题。否则阅卷很困难。题做的好的，可以安排面试一下。不要在面试中间插入面霸，对其他同学不公平。</p>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="campus-recruiting/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="how-to-finding-a-job-for-graduates/">how to finding a job for graduates</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2013-10-07T07:43:00.000Z" itemprop="datePublished">Oct 7, 2013</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/heart/">heart</a>
</div>
    </div>
      
        <p>昨天晚上胃难受起来翻了会知乎，回答了<a href="http://www.zhihu.com/question/21721705/answer/19228492?utm_source=weibo&amp;utm_medium=weibo_share&amp;utm_content=share_answer&amp;utm_campaign=share_button" target="_blank" rel="external">一个问题</a>，也算校招的一个总结了。包含了给准备找工作的毕业生的一些建议。好久没写 blog 了，粘贴到这里除除草。</p>
<p>刚好做了几天校招，或许对你有帮助。</p>
<p>非计算机相关专业的同学，一般一些算法基础会稍差（当然也有自学数据结构且弄的比较明白的人），比较偏向实际应用开发方面，但是要注意并不是说做过很多类型的开发就会有很多的加分，而是要注重深入。</p>
<p>招聘一般都会有笔试，笔试考察的是你写代码和解决问题的能力，随便用什么语言，能解决问题就可以。首先你得过笔试这关，写不了代码的，开发肯定是没办法招的。</p>
<p>然后就是面试，比如就针对你做的开发，我会提问几个 python，java，html 相关的技术问题，看你是否确实使用并且掌握了他们的基本原理。开始会是一些非常简单的问题，比如 python 如何打印一个 dict 的所有 key，如何做类继承，如何调用执行外部命令等，就这些简单问题如果能答上来，一般会继续问一些相对深入的，了解下你熟悉的程度。这一关需要你对一些基础问题能答上来，如果后续也能答上来，那这方面的得分会比较高。如果基础问题答不上来，表示经验要么是瞎掰的，要么就是兴趣不在开发没用心研究过，那我基本不会给过。</p>
<p>如果实际使用和学习过的东西都还算明白，那么后续会考察一些算法基础的东西，各种数据结构里面的东西，不过针对这种跨专业的，要求不会特别高，如果实在没了解过，那也没有办法。如果了解过且比较明白，那会有加分。不会也不会减分。</p>
<p>此外还会考察交流沟通能力，思路是否清晰，思维是否敏捷等，这些方面好的话，会有加分。要注意这块如果有严重问题的，也不会给过，因为开发工程师是需要和其他人做配合工作的，如果沟通或者需求理解有问题，那是不行的。</p>
<p>综合上面三块，看最后的结果。可以看出来，非计算机相关专业的，还是多少有点吃亏的。<br>哦对了，这是我们公司的要求，可能稍微有点高，就你贴出来的经验看，如果确实都是你做出来的，我感觉你至少找个开发的工作应该是没太大问题的，可能问题是在起点会是在哪里，是在大公司还是二流三流公司，呵呵。</p>
<p>另外对于你想做 android 开发，其实并不是说你有过类似经验就只能找那个方向的工作，主要还是看你的兴趣在哪里，一般大学的那点经验对于一个公司来说，基本没什么用，太浅了。</p>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="how-to-finding-a-job-for-graduates/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="octopress-and-jeklly-1-dot-0-1/">octopress and jeklly 1.0.1</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2013-06-12T13:45:00.000Z" itemprop="datePublished">Jun 12, 2013</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/linux-web/">linux,web</a>
</div>
    </div>
      
        <p>自从 jeklly 1.0.x 发布之后，我的 octopress 站点就在 github，gitcafe 上面更新不了了，写了新帖子然后 push 之后，会收到个邮件，说 generate site faild。</p>
<p>等等。。这个不是静态站点吗？generate 你妹阿！！然后就找阿找阿找解决办法，尝试过下面这些</p>
<ul>
<li>touch 一个 .nojeklly 不让它 generate</li>
<li>找 octopress 支持 jeklly 1.0.1 的新版本</li>
<li>google 之，怎么可能就我遇到问题了呢</li>
<li>使用 jeklly 1.0.1 单独搭一个，不用 octopress 了</li>
<li>…其他忘记了的。。</li>
</ul>
<p>悲剧的是，以上这些方法没一个搞定了</p>
<ul>
<li>某处搜到的这个 .nojeklly 完全不管用</li>
<li>octopress 2.1 这个 branch 支持 jeklly 1.0.1，可惜没能让他运转起来。。具体 release 日期似乎还没看到。。。</li>
<li>google 不到有用的信息，唯一有用的就是有人给 octopress 提的 pull request，可惜被 merge 到 2.1 了</li>
<li>这个倒是简单，可惜的是 octopress 其实背后做了很多事情，单纯的拿弄 post 过去发现有些文件解析不了，我遇到的是 <code>``` </code> 这个标记，是 octopress 支持的，可惜我的 post 里面好多都是这个。另外还有主题阿等等这些。</li>
</ul>
<p>综上，就觉得，nnd，这破玩意怎么这么复杂？！</p>
<p>后来不知道哪天突然想到，我之前测试 hexo 的时候，它没有 jeklly 一说，不是也可以么？另外，github pages 的例子里面，也就是 echo 了一个文件呀，也没有 jeklly 阿，不是也可以么？然后就觉得豁然开朗，github 之流肯定是默认会给你处理 jeklly 的代码，然后产生一个 site，而不是直接使用你产生的 html 文件。回想之前每次 deploy github pages，都会收到一个邮件提醒说 site generate success 之类，那就应该是猜的没错了。</p>
<p>然后就开始尝试只 push html（octopress 的结果文件在 public 里面）上去，结果确实如所料，毛问题都没有了，gitcafe 和 github 都可以了。总算舒服了。。另外还写了一个使用 octopress deploy 到 gitcafe 的<a href="http://wdicc.om/octopress-and-gitcafe/" target="_blank" rel="external">帖子</a>，有需要可以参考。</p>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="octopress-and-jeklly-1-dot-0-1/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="octopress-and-gitcafe/">octopress and gitcafe</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2013-06-12T13:30:00.000Z" itemprop="datePublished">Jun 12, 2013</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/linux/">linux</a>
</div>
    </div>
      
        <p>ocotpress 支持 github，不过 github 的 pages 貌似被墙了，且速度慢。gitcafe 速度还不错，也支持 pages，刚好可以切换过去。我只是简单粗暴的修改了几个文件。</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line">diff --git a/.gitignore b/.gitignore</div><div class="line">index 85ed25d..5858b25 100644</div><div class="line"><span class="comment">--- a/.gitignore</span></div><div class="line"><span class="comment">+++ b/.gitignore</span></div><div class="line">@@ -12,3 +12,4 @@ source/stylesheets/screen.css</div><div class="line"> vendor</div><div class="line"> node_modules</div><div class="line"> .themes/fabric/</div><div class="line"><span class="addition">+gitcafe</span></div><div class="line">diff --git a/Rakefile b/Rakefile</div><div class="line">index 53072e5..62061e0 100644</div><div class="line"><span class="comment">--- a/Rakefile</span></div><div class="line"><span class="comment">+++ b/Rakefile</span></div><div class="line">@@ -27,6 +27,9 @@ new_post_ext    = "markdown"  # default new post file extension when using the n</div><div class="line"> new_page_ext    = "markdown"  # default new page file extension when using the new_page task</div><div class="line"> server_port     = "4000"      # port for preview server eg. localhost:4000</div><div class="line"></div><div class="line"><span class="addition">+gitcafe_dir      = "gitcafe"</span></div><div class="line"><span class="addition">+gitcafe_branch   = "gitcafe-pages"</span></div><div class="line"><span class="addition">+</span></div><div class="line"></div><div class="line"> desc "Initial setup for Octopress: copies the default theme into the path of Jekyll's generator. Rake install defaults to rake install[classic] to install a different them</div><div class="line"> task :install, :theme do |t, args|</div><div class="line">@@ -219,7 +214,7 @@ end</div><div class="line"> ##############</div><div class="line"></div><div class="line"> desc "Default deploy task"</div><div class="line"><span class="deletion">-task :deploy do</span></div><div class="line"><span class="addition">+task :deploy_old do</span></div><div class="line">   # Check if preview posts exist, which should not be published</div><div class="line">   if File.exists?(".preview-mode")</div><div class="line">     puts "## Found posts in preview mode, regenerating files ..."</div><div class="line">@@ -231,6 +226,31 @@ task :deploy do</div><div class="line">   Rake::Task["#&#123;deploy_default&#125;"].execute</div><div class="line"> end</div><div class="line"></div><div class="line"><span class="addition">+desc "deploy gitcafe"</span></div><div class="line"><span class="addition">+task :deploy do</span></div><div class="line"><span class="addition">+  # Check if preview posts exist, which should not be published</span></div><div class="line"><span class="addition">+  if File.exists?(".preview-mode")</span></div><div class="line"><span class="addition">+    puts "## Found posts in preview mode, regenerating files ..."</span></div><div class="line"><span class="addition">+    File.delete(".preview-mode")</span></div><div class="line"><span class="addition">+    #Rake::Task[:generate].execute # 这个地方每次都会 generate 我一般喜欢先 generate 本地看好没问题之后再 deploy，所以就注释掉了</span></div><div class="line"><span class="addition">+  end</span></div><div class="line"><span class="addition">+</span></div><div class="line"><span class="addition">+  puts "## Deploying branch to Gitcafe Pages "</span></div><div class="line"><span class="addition">+  puts "\n## copying #&#123;public_dir&#125; to #&#123;gitcafe_dir&#125;"</span></div><div class="line"><span class="addition">+  cp_r "#&#123;public_dir&#125;/.", gitcafe_dir</span></div><div class="line"><span class="addition">+  cd "#&#123;gitcafe_dir&#125;" do</span></div><div class="line"><span class="addition">+    system "git add ."</span></div><div class="line"><span class="addition">+    system "git add -u"</span></div><div class="line"><span class="addition">+    puts "\n## Commiting: Site updated at #&#123;Time.now.utc&#125;"</span></div><div class="line"><span class="addition">+    message = "Site updated at #&#123;Time.now.utc&#125;"</span></div><div class="line"><span class="addition">+    system "git commit -m \"#&#123;message&#125;\""</span></div><div class="line"><span class="addition">+    puts "\n## Pushing generated #&#123;gitcafe_dir&#125; website"</span></div><div class="line"><span class="addition">+    system "git push origin #&#123;gitcafe_branch&#125; --force"</span></div><div class="line"><span class="addition">+    puts "\n## Gcafe Pages deploy complete"</span></div><div class="line"><span class="addition">+  end</span></div><div class="line"><span class="addition">+end</span></div><div class="line"><span class="addition">+</span></div><div class="line"><span class="addition">+</span></div><div class="line"> desc "Generate website and deploy"</div><div class="line"> task :gen_deploy =&gt; [:integrate, :generate, :deploy] do</div><div class="line"> end</div></pre></td></tr></table></figure>
<p>然后需要在 octopus 根目录 clone 一下你的 gitcafe 项目到 gitcafe 目录<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ git <span class="built_in">clone</span> git@gitcafe.com:wd/wd gitcafe</div><div class="line">....</div></pre></td></tr></table></figure></p>
<p>然后就可以试试看 <code>rake generate</code> , <code>rake preview</code>, <code>rake deploy</code> 了。</p>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="octopress-and-gitcafe/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>

  <article class="post">
	<h2 class="title">
		<a href="broadcom-wireless-card-on-gentoo/">broadcom BCM wireless card on gentoo</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: <time datetime="2013-05-24T09:28:00.000Z" itemprop="datePublished">May 24, 2013</time>
</div>
      <div class="tags">Tags: 

<a href="../tags/linux/">linux</a>
</div>
    </div>
      
        <p>昨天又折腾了一下我的无线，是 dell 的本子，broadcom 的卡 BCM4313，准备写一下的时候，发现之前居然折腾过 <a href="/bcm4312broadcom-stawpa_supplicantkernel2-6-33/">BCM4312</a>。。感觉真蛋疼。。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ lspci -vnn <span class="_">-d</span> 14e4:</div><div class="line">02:00.0 Network controller [0280]: Broadcom Corporation BCM4313 802.11b/g/n Wireless LAN Controller [14e4:4727] (rev 01)</div><div class="line">        Subsystem: Dell Inspiron M5010 / XPS 8300 [1028:0010]</div><div class="line">        Flags: fast devsel, IRQ 17</div><div class="line">        Memory at e5300000 (64-bit, non-prefetchable) [size=16K]</div><div class="line">        Capabilities: &lt;access denied&gt;</div><div class="line">        Kernel modules: bcma</div></pre></td></tr></table></figure>
<p>根据 <a href="http://wireless.kernel.org/en/users/Drivers/b43#bcm43xx.2C_b43legacy.2C_b43.2C_softmac.2C..._the_full_story" target="_blank" rel="external">这里</a> ， BCM 的网卡有三种可用驱动</p>
<ul>
<li>b43，kernel 自带，源自 broadcom linux 驱动的逆向工程</li>
<li>brcmsmac, kernel 自带，似乎源自 broadcom 某个开源的驱动</li>
<li>wl, broadcom 发布的 linux 驱动</li>
</ul>
<p>另外，kernel 自带的 b43 和 brcmsmac 支持标准的 802.11 栈，可以通过 iw iwconfig 之类的工具来配置，获取状态。wl 就不行了。</p>
<p>如果想使用 b43 或者 brcmsmac，需要选择下面的 kernel 选项，要注意都选择成 module，因为还需要加载 firmware，如果编译进内核那需要把 firmware 也编译到内核才可以。<br><figure class="highlight xl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">N<span class="function"><span class="title">etworking</span> support  ---&gt;</span>  W<span class="function"><span class="title">ireless</span>  ---&gt;</span> Generic IEEE <span class="number">802.11</span> Networking Stack (mac80211)</div><div class="line">D<span class="function"><span class="title">evice</span> Drivers  ---&gt;</span> B<span class="function"><span class="title">roadcom</span> specific AMBA  ---&gt;</span>  BCMA support</div></pre></td></tr></table></figure></p>
<p>针对 b43 选择 <code>Device Drivers  ---&gt; Network device support  ---&gt;  Wireless LAN  ---&gt;  Broadcom 43xx wireless support (mac80211 stack)</code>, 还需要安装 <code>sys-firmware/b43-firmware</code>。</p>
<p>针对 brcmsmac 选择 <code>Device Drivers  ---&gt; Network device support  ---&gt;  Wireless LAN  ---&gt;  Broadcom IEEE802.11n PCIe SoftMAC WLAN driver</code>，还需要安装 <code>sys-kernel/linux-firmware</code>。</p>
<p>对于 wl，需要安装 <code>net-wireless/broadcom-sta</code>，安装的时候会自动检查必要的内核选项，按照提示选择好就可以了。主要是要注意去掉上面的 kernel 的选项，另外可能还需要一个 ipw2100 来提供某一个隐藏的 kernel 选项。此外还有个 PREEMPT_RCU 检查，需要选择下面的内核选项 <code>Processor type and features  ---&gt;  Preemption Model (Voluntary Kernel Preemption (Desktop))  ---&gt;  Voluntary Kernel Preemption (Desktop)</code>。</p>
<p>如此之后编译安装重启就可以了。</p>

      
	</div>

<div class="meta">
	
		<span class="comments"><a href="broadcom-wireless-card-on-gentoo/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>


  <nav id="pagenavi">
    
        <a href="/" class="prev">Prev</a>
    
    
        <a href="/page/3/" class="next">Next</a>
    
  <div class="center"><a href="/archives/index.html">Blog Archives</a></div>
  </nav>




    
        <script id="dsq-count-scr" src="//" + wdicc + ".disqus.com/count.js" async></script>
    



    </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2016

    wd
. Powered by <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> |
    Theme is <a href="https://github.com/wd/hexo-fabric">hexo-fabric</a>, fork from <a href="http://github.com/panks/fabric">fabric</a> by <a href="http://panks.me">Pankaj Kumar</a>
</div>


    </footer>
    <script src="/javascripts/fabric.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script>
 <!-- Delete or comment this line to disable Fancybox -->



<!-- end toload --> 
</div>
</div>
<script src="/javascripts/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery); 
/*]]>*/
</script><!-- remove it to remove the scroll to top button -->
</body>
</html>
