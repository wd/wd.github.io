<!doctype html><html lang=zh-cn><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Doing Code Reviews | wd and cc</title><link rel=canonical href=https://wdicc.com/doing-code-reviews/><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Doing Code Reviews"><meta property="og:description" content="集中看了一波 code review 的帖子，记录一些笔记 How Do Code Reviews Work at Microsoft? 微软这个倒是没什么亮点，不过最后有一堆别等链接值得"><meta property="og:type" content="article"><meta property="og:url" content="https://wdicc.com/doing-code-reviews/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-10-29T16:44:17+08:00"><meta property="article:modified_time" content="2019-10-29T16:44:17+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Doing Code Reviews"><meta name=twitter:description content="集中看了一波 code review 的帖子，记录一些笔记 How Do Code Reviews Work at Microsoft? 微软这个倒是没什么亮点，不过最后有一堆别等链接值得"><link rel=stylesheet href=https://wdicc.com/css/styles.94f653e9e151e28067a7c5dbbc4600cbd5a3c721e79faaf971e523c40f3b249b8e4f20bb57810dfffa8d559ca5c140fd56eb4cd9c0853113ad08e66afdb08bdd.css integrity="sha512-lPZT6eFR4oBnp8XbvEYAy9WjxyHnn6r5ceUjxA87JJuOTyC7V4EN//qNVZylwUD9VutM2cCFMROtCOZq/bCL3Q=="><link rel=stylesheet href=https://wdicc.com/wdicc.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://wdicc.com/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/tags>Tags</a></li><li><a href="https://www.google.com.hk/search?sitesearch=https%3A%2F%2Fwdicc.com%2F&amp;q=">Search</a></li><li><a href=/atom.xml>Subscribe</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://wdicc.com/some-interview-questions/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=https://wdicc.com/upgrade-rn-from-0.57to-0.61/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f&text=Doing%20Code%20Reviews" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f&title=Doing%20Code%20Reviews" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f&is_video=false&description=Doing%20Code%20Reviews" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Doing%20Code%20Reviews&body=Check out this article: https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f&title=Doing%20Code%20Reviews" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f&title=Doing%20Code%20Reviews" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f&name=Doing%20Code%20Reviews&description=%e9%9b%86%e4%b8%ad%e7%9c%8b%e4%ba%86%e4%b8%80%e6%b3%a2%20code%20review%20%e7%9a%84%e5%b8%96%e5%ad%90%ef%bc%8c%e8%ae%b0%e5%bd%95%e4%b8%80%e4%ba%9b%e7%ac%94%e8%ae%b0%20How%20Do%20Code%20Reviews%20Work%20at%20Microsoft%3f%20%e5%be%ae%e8%bd%af%e8%bf%99%e4%b8%aa%e5%80%92%e6%98%af%e6%b2%a1%e4%bb%80%e4%b9%88%e4%ba%ae%e7%82%b9%ef%bc%8c%e4%b8%8d%e8%bf%87%e6%9c%80%e5%90%8e%e6%9c%89%e4%b8%80%e5%a0%86%e5%88%ab%e7%ad%89%e9%93%be%e6%8e%a5%e5%80%bc%e5%be%97" aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f&t=Doing%20Code%20Reviews" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Doing Code Reviews</h1><div class=meta><span class=author itemprop=author itemscope itemtype=http://schema.org/Person><span itemprop=name>wd</span></span><div class=postdate><time datetime="2019-10-29 16:44:17 +0800 +0800" itemprop=datePublished>2019-10-29</time></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/codereview rel=tag>codereview</a></div></div></header><div id=toc><nav id=TableOfContents><ul><li><a href=#headline-1>How Do Code Reviews Work at Microsoft?</a></li><li><a href=#headline-2>Code Reviews at Google are lightweight and fast</a></li><li><a href=#headline-3>How to give great code review feedback</a></li><li><a href=#headline-4>Proven Code Review Best Practices from Microsoft</a></li></ul></nav></div><div class=content itemprop=articleBody><p>集中看了一波 code review 的帖子，记录一些笔记</p><div id=outline-container-headline-1 class=outline-3><h3 id=headline-1><a href=https://hackernoon.com/how-code-reviews-work-at-microsoft-qe1t327y>How Do Code Reviews Work at Microsoft?</a></h3><div id=outline-text-headline-1 class=outline-text-3><p>微软这个倒是没什么亮点，不过最后有一堆别等链接值得一看。</p><ul><li>code review 包括测试结果</li><li>code review 包括用户界面，可以通过截图什么的提交，这样方便 review</li><li>包括静态检查结果</li></ul></div></div><div id=outline-container-headline-2 class=outline-3><h3 id=headline-2><a href=https://www.michaelagreiler.com/code-reviews-at-google/>Code Reviews at Google are lightweight and fast</a></h3><div id=outline-text-headline-2 class=outline-text-3><p>Google 的方式</p><ul><li>提交前运行静态检查工具 Tricorder 检查</li><li>所有提交都需要 review</li><li>代码是全部组员的，所以所有人都要为代码质量负责</li><li>代码可读性的 reviewer 必须要取得一个认证之后才能参与 review</li><li>review 注重的是 owenership 和 readability，不看 reviewer 的职位年龄，如果总是需要年长的来 approve code，那会有瓶颈</li><li>取得认证有难度，但是比起职级要求来说简单多了</li><li>代码只有通过了经过认证的 readability 专家和对代码有 ownership 的人的审批才可以合并</li><li>想要取得认证，需要像 readability 高级专家组提交代码，他们会仔细检查代码质量，任何微小的错误和潜在的问题都不允许，比如锁进，多余的空格等。</li><li>Google 的 <a href=https://github.com/google/styleguide>style guide</a></li><li>code review 很轻快，小的1小时内，大的修改 5 小时内，具体怎么做到的，似乎有人写一篇论文。。 <a href=https://sback.it/publications/icse2018seip.pdf>https://sback.it/publications/icse2018seip.pdf</a></li><li>大部分时候只有一个 reviewer，人多了会变慢，人少了又可能会损失严谨，损失 review 质量</li><li>提交小改动，90% 代码修改少于 10 个文件，大量的代码只修改了 24 行左右，75% 的 reviewer 只有一个人</li><li>小改动可以更快速的 review，也可以让 review 反馈更有效，有效的反馈也会让 review 变少，形成正反馈。所以多提交，少改动</li><li>code review 也会导致每次修改都应该是有价值的</li><li>80% 的 review 会需要开发人员重新修改代码</li><li><p>code review 不只是发现 bug，也是为了让开发人员写能让别的开发人员看懂的代码，</p><ul><li>学习教育，如何写正确的代码</li><li>保持代码质量，例如必须的测试用例，代码格式等</li><li>保证代码安全共有，避免一个人专断</li><li>避免 bug</li><li>跟踪代码变更，清楚代码修改的过程</li></ul></li></ul></div></div><div id=outline-container-headline-3 class=outline-3><h3 id=headline-3><a href=https://www.michaelagreiler.com/great-code-review-feedback/>How to give great code review feedback</a></h3><div id=outline-text-headline-3 class=outline-text-3><p>Code review 的目的是啥</p><ul><li>Functional Defects: 功能缺陷</li><li>Problems with the logic: 逻辑存在问题</li><li>Missing Validation (e.g., edge cases): 缺乏必要的校验，边界条件没处理</li><li>Usage of API: API 使用有问题</li><li>Design Patterns: 设计模式不对</li><li>Architectural Issues: 架构问题</li><li>Testability: 可测试性</li><li>Readability: 可读性</li><li>Security: 安全</li><li>Naming conventions: 命名不符合约定</li><li>Team Coding Style: 代码风格不一致</li><li>Documentation: 缺少文档</li><li>Use of best practices: 没有使用最佳实践</li><li>Language-specific issues: 编程语言层面的问题</li><li>Use of deprecated methods: 使用了不推荐的函数方法</li><li>Performance (e.g., complexity of the solution): 性能问题，例如解决方案的复杂层度</li><li>Alternative solutions…: 有其他更好的解决方案</li></ul><p>功能缺陷，缺少必要的校验，最佳实践，代码风格，API 使用和设计模式是相对比较有用的几个点。</p><p>不要在 review 的 comment 里面提交和讨论一些和本次代码合并无关的内容，我们需要让 review 专注并快速：</p><ul><li>别的实现方案。虽然可能另外的方案看着更好，但是关于这个讨论对本次的代码提交没什么用。</li><li>技术债讨论和重构。关于历史的技术债和可能的重构，这些应该在另外的线索里面讨论。</li><li>将来工作的计划。不要在本次 code review 里面讨论不会放在目前的开发周期里面的未来规划。放在其他地方做这个事情。</li><li>为了明白代码实现的问题。这些对合并代码没意义，不要放在这里问。</li></ul><p>好的 code review 反馈是那些对代码本身的反馈：本次代码修改是否有问题，是否高质量。其他的和这个目标无关的，可以另外找地方讨论，不要在 review 里面讨论，目标是让本次提交尽快合并。</p></div></div><div id=outline-container-headline-4 class=outline-3><h3 id=headline-4><a href=https://www.michaelagreiler.com/code-review-best-practices/>Proven Code Review Best Practices from Microsoft</a></h3><div id=outline-text-headline-4 class=outline-text-3><p>Code review 有两方人参与，author 和 reviewer</p><p>对于 author:</p><ul><li>仔细检查自己要提交的内容，自己发现问题比等别人发现好。</li><li>提交小改动。如果不同的需求在一次提交里面，review 会变得比较痛苦。</li><li>增加新功能，修复另外一个功能里面的 bug，重构代码，这些都应该在不同的提交里面。应该让每次的提交都有一个清晰的，单一的，简单的目标。</li><li>描述清楚修改的目的和动机。</li><li>提交前运行测试。</li><li>使用一些自动检查的工具，比如格式检查，语法检查，静态检查工具等。</li><li>跳过一些简单的修改的 review，比如格式修改，局部变量改名什么的。</li><li>不要选择太多的人参与 review。一方面人多了会让每个参与的都觉得自己的 review 没那么重要，另一方面会降低整个 team 的工作效率。</li><li>让熟悉这块代码的人参与 review 会有好处。</li><li>让新手参与可以让他们学习学习。</li><li>通知可能会从这次 review 受益的人。但是也不要通知太多人。</li><li>提前让其他参与 review 的人知道需要他们 review。</li><li>虚心接受建议。</li><li>尊重其他 reviewer。</li></ul><p>对于 reviewer：</p><ul><li>提出靠谱的，有建设性的意见建议。</li><li>有需要的话当面或者通过 im 单独聊聊。</li><li>单独交流的内容记得记录，以免其他人不清楚。</li><li>解释清楚拒绝的原因。</li></ul><p>code review best prectices</p><ul><li>把 code review 作为一个每天的例行工作，比如每天上午的 11-12 点。</li><li>尽量减少任务切换，这个是生产力的大敌。使用比如固定的时间 review 会比较好，可以一天几次这样。</li><li>如果最后参与 review 的人总是没什么建议可以提交，那应该需要减少参与 review 的人了。</li><li>review 频率高一点可以保证 review 质量。</li><li>注意核心问题，不要光注意一些小问题，例如拼写错误什么的。</li><li>使用一个用来 review 的 checklist</li></ul><p>ref link:</p><ul><li><a href=https://www.michaelagreiler.com/code-review-pitfalls-slow-down/>How to avoid Code review pitfalls that slow your productivity down!</a></li></ul></div></div></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/tags>Tags</a></li><li><a href="https://www.google.com.hk/search?sitesearch=https%3A%2F%2Fwdicc.com%2F&amp;q=">Search</a></li><li><a href=/atom.xml>Subscribe</a></li></ul></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f&text=Doing%20Code%20Reviews" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f&title=Doing%20Code%20Reviews" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f&is_video=false&description=Doing%20Code%20Reviews" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Doing%20Code%20Reviews&body=Check out this article: https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f&title=Doing%20Code%20Reviews" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f&title=Doing%20Code%20Reviews" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f&name=Doing%20Code%20Reviews&description=%e9%9b%86%e4%b8%ad%e7%9c%8b%e4%ba%86%e4%b8%80%e6%b3%a2%20code%20review%20%e7%9a%84%e5%b8%96%e5%ad%90%ef%bc%8c%e8%ae%b0%e5%bd%95%e4%b8%80%e4%ba%9b%e7%ac%94%e8%ae%b0%20How%20Do%20Code%20Reviews%20Work%20at%20Microsoft%3f%20%e5%be%ae%e8%bd%af%e8%bf%99%e4%b8%aa%e5%80%92%e6%98%af%e6%b2%a1%e4%bb%80%e4%b9%88%e4%ba%ae%e7%82%b9%ef%bc%8c%e4%b8%8d%e8%bf%87%e6%9c%80%e5%90%8e%e6%9c%89%e4%b8%80%e5%a0%86%e5%88%ab%e7%ad%89%e9%93%be%e6%8e%a5%e5%80%bc%e5%be%97" aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fwdicc.com%2fdoing-code-reviews%2f&t=Doing%20Code%20Reviews" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2023 wd and cc</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/tags>Tags</a></li><li><a href="https://www.google.com.hk/search?sitesearch=https%3A%2F%2Fwdicc.com%2F&amp;q=">Search</a></li><li><a href=/atom.xml>Subscribe</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/js/code-copy.js></script></html>