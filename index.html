<!DOCTYPE HTML>
<html>
<head>
	<meta name="generator" content="Hugo 0.19" />
	<meta charset="utf-8">
    
    
    <title>wd and cc</title>
    <meta name="author" content="wd">
    <meta name="description" content="">
    <meta name="keywords" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <link href="https://wdicc.com/index.xml" rel="alternate" title="wd and cc" type="application/atom+xml">
	<link href="/favicon.ico" rel="shortcut icon">
    <link href="/css/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/css/custom.css" media="screen, projection" rel="stylesheet" type="text/css">

    <link href='//fonts.googleapis.com/css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Amethysta' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    

    <script type="text/javascript" src="/js/jquery-tapir.js"></script>

    

    <link rel="stylesheet" href="/css/hljs.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</head>


<body>
    <div id="wrapper">
        <header id="header" class="inner">
<h1 class="animated bounceInDown">
    <div id="headerbg">
        wd and cc
    </div>
</h1>

<span class="subtitle">happy every day</span>
<br>

<ul id="social-links" style="text-align:center; clear:both;">
    
    
    <li>
    <a href="https://github.com/wd" class="github" title="Github"></a>
    </li>
    
    
    
    
    
    <li>
    <a href="http://www.twitter.com/wd" class="twitter" title="Twitter"></a>
    </li>
    
    
    
    
    
</ul>


<ul id="nav">
	<li id="ajax"><a href="/index.html">Home</a></li>
	<li id="ajax"><a href="/archives/index.html">Archives</a></li>
	<li id="ajax"><a href="/tags/index.html">Tags</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    <li>
    <div id="dark">
        <form action="//www.google.com.hk/search" method="get" accept-charset="UTF-8" id="search">
            <input type="hidden" name="sitesearch" value="https://wdicc.com/" />
            <input type="text" name="q" results="0" placeholder="Search..." x-webkit-speech />
        </form>
    </div>
    </li>
</ul>

</header>

<div id="toload">

    <div id="content" class="inner">
        




    
    <script id="dsq-count-scr" src="//wdicc.disqus.com/count.js" async></script>
    




  <article class="post">
    <h2 class="title"> 
        <a href="/Something-about-cruise-tour/">Something about cruise tour</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2017-03-20T20:41:10.000&#43;08:00' itemprop="datePublished">2017-03-20</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/cruise">cruise</a>

<a href="/tags/travel">travel</a>


</div>
    </div>
        <p>之前知道邮轮游一直没有体验过，据说是在上面各种滚来滚去看书，因为手机没有信号，没有网络。前几天体验了一把，总结一下。</p>

<h1 id="一句话总结">一句话总结</h1>

<p>这上面有你讨厌的所有因素，大妈，广场舞，广场卡拉 ok，小孩子，无序，占座，插队，甚至最后一天还目睹了两起吵架。</p>

<h1 id="邮轮游玩什么">邮轮游玩什么</h1>

<p>我参加的是歌诗达幸运号（Costa Fortun），邮轮上面估计 80% 都是各种大爷大妈，带着女儿外孙。你可以想象一下，平时最不喜欢的组合在这里最全了。</p>

<p>邮轮上面有免费的自助餐和一些特别的餐食，比如批萨，面条，猪排什么的。也有收费的餐食，当然你可以不去。酒和软饮都是收费的，开饭的时候有免费的白水给你喝，屋子里面是没有的。</p>

<p>邮轮上面一般有大量的娱乐设施，比如赌场，游戏机，泳池，桑拿，剧场等。还定期有各种娱乐活动，比如猜个字啊，跳个舞什么的。所以第一次去还是可以看个新鲜的，尤其可能还有一些漂亮的陪玩 mm，看着也还可以。游戏机赌场是收费的，恩。</p>

<p>此外剧场每天基本都会有一场大型的演出，30-40 分钟，可以让你打发时间。但是剧场虽然每天演出内容不一样，但是演员总是那一波，看多了其实也会腻味。</p>

<p>房间里面也有电视，不过我观察电视都是反复重播录下来的一些电视，然后有一个电影台还是只有那么几部反复重复播放，《x man 天启》我看了不下 10 遍。</p>

<p>小孩也有人给带着玩游戏，有专门的儿童俱乐部。还有健身房，健身房是我唯一对这次邮轮活动满意的地方，当然肯定不是对环境满意，毕竟里面充满了大爷大妈，满意的地方主要是在设备，设备真心不错。浴室和换衣间地板异常干净，比起我家楼下的奥力，简直天上地下。</p>

<p>邮轮一般有那么1，2天是下船，我们这次的安排很屎，景点很无聊，低接导游也只是对购物有兴趣，购物店虽然不贵，但是东西比较少，挺没意思的。</p>

<h1 id="让人反感的几个瞬间">让人反感的几个瞬间</h1>

<p>排队上邮轮的时候，过安检的时候就一条队排的特别粗，到了最后那变细互相挤着往前走。我们后面有个阿姨就各种急着往你前面走，我老婆发现之后就故意挤着不让，我看的笑死，呵呵。</p>

<p>第一天必须做逃生演习。有个大爷一家推着小车带着孩子，孩子可能没一会睡着了。而演习是需要所有人参加的，所以就不得不等比较慢的人。大爷就生气了，开始呵斥工作人员，「孩子都睡着了，啥时候开始」之类的，声音巨大。工作人员大都是外籍，估计也吓了一跳。最后结束的时候，大爷还过去指着那个工作人员不知道说了什么。</p>

<p>剧院演出，基本前三四排上面都是东西占座的。除非你提前半个小时到。另外就是各种小孩大声说话也没人管。有时候酒吧做游戏，工作人员都明确说了游戏可能比较激烈，让大家把小孩弄走，但是看着一个女的抱着小孩几次被劝离之后还是要上去玩，貌似还是上去让小孩参与。</p>

<p>昨天有个游戏，几个被淘汰的大妈，悄悄的跑回去继续参与，也有跑回去被发现之后赶走，再次跑回去的，当着一百来号人目睹就那么做，真的无语。</p>

<p>今天下船之前大家集中在一个地方等着，有个姥爷带着孙女玩气球。有个哥们玩心重，带了个面具就冲那小孩过去了，小孩吓的赶紧跑到了姥爷后面，那个哥们就走了。过了半分钟小孩反映过来开始哭，那姥爷就开始不爽了。后来他们全家，追着那小伙骂，最后把面具也抢过来了，还要护照说要以后有啥毛病要找他。纠缠了能有10分钟。</p>

<p>这只是记得起来的几个，反正年轻人真的不建议去邮轮了。如果是自己父母，倒是可以推荐去，他们应该喜欢。</p>

    </div>

<div class="meta">
    
    <span class="comments"><a href="/Something-about-cruise-tour/#disqus_thread">Comments</a></span>
    
</div>
</article>

  <article class="post">
    <h2 class="title"> 
        <a href="/My-way-to-keep-fit/">My way to keep fit</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2017-03-13T15:19:30.000&#43;08:00' itemprop="datePublished">2017-03-13</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/keepfit">keepfit</a>

<a href="/tags/running">running</a>

<a href="/tags/health">health</a>


</div>
    </div>
        <h1 id="最简单的减肥方法">最简单的减肥方法</h1>

<p>前年开始我发现一种比较简单的减肥方法，就是不吃或者少吃晚饭。</p>

<p>这个方法应该不一定对所有人适用。我估计应该只对 BMI(Body Mass Index, 身体质量指数，注意和体脂率不是一个东西)比较高的人有用吧。</p>

<p>我当时 BMI 是 <code>98/1.77^2=31.28</code> 是属于比较高的，坚持了上面的方法半年之后，大概最瘦的时候是 28，我查了是刚好脱离了肥胖那一档，进入了过重。</p>

<h1 id="自己最近总结的一些健身方法">自己最近总结的一些健身方法</h1>

<p>按照一些理论，在有氧运动一定时间 T 之后，保持一定的心率 HR 继续运动，就会开始消耗脂肪。所谓的 <a href="https://www.douban.com/note/228079030/" title="fat burning zone">fat burning zone</a> (搜索到的，仅供参考)。</p>

<p>对于 T，我看有的说是 20 分钟，有的是 40 分钟。我一般的做法是持续运动 40-50 分钟，不超过一小时。</p>

<p>对于心率，先看下面的公式</p>

<pre><code>
MHR(最大心率) = 220 - age
MHR = 206 - (0.88 x age)
</code></pre>

<p>上面是最大心率，有多种算法最后应该结果大致有个范围，然后你的减脂的 HR 范围就是 <code>MHR x (0.7 到 0.8)</code> 之间。我算出来我的是大概 130-140.</p>

<h2 id="跑步机-vs-椭圆机-vs-动感单车">跑步机 vs 椭圆机 vs 动感单车</h2>

<p>我自己家里买了一台动感单车，实际实践过之后，用这个有几个缺陷</p>

<ul>
<li>自己练没有动感。在操课房里面教练会带着不停的变换速度，动作，一方面让你觉得没那么无聊，另一方面也是能增加运动量。</li>
<li>自己练容易损坏脚踝和膝盖。我自己在家练的时候，基本就是站上面运动 30+ 分钟，脚一直在单车上面脚尖踩着，练完之后脚会疼痛。</li>
</ul>

<p>我其实挺喜欢在外面跑步，尤其早上，但是因为体重大，好几次都是跑一周之后双腿膝盖会开始疼痛，只好作罢。健身房里面的跑步机冲击比路面跑步小，可以试试看。</p>

<p>最近尝试了跑步机上面跑，坚持 2 周之后，还是出现了一只腿的膝盖疼痛，只好暂停。开始尝试椭圆机。</p>

<p>跑步机上面跑强度比椭圆机肯定强很多，跑步机上面在一个不快的速度下面，我持续跑 15 分钟之后，心率就会达到 150，其实已经有点高了。</p>

<p>跑步机的几个问题</p>

<ul>
<li>容易心率过快</li>
<li>不方便听音乐看片子分散注意力</li>
<li>不容易不间断坚持跑 30 - 40 分钟</li>
<li>膝盖损伤</li>
</ul>

<p>最后发现椭圆机实在是很不错</p>

<ul>
<li>运动速度慢，不妨碍你看片子听音乐(这个非常重要，否则坚持50分钟很难)</li>
<li>速度恒定，也就是心率恒定，你只需要选择一个适合你的减脂的心率的难度就可以了</li>
<li>对膝盖冲击比较小</li>
</ul>

<p>目前正在体验椭圆机中。</p>

<h2 id="力量训练">力量训练</h2>

<p>这块目前还比较盲目，只是知道运动完毕之后应该需要进行适当的力量训练，还在摸索。</p>

<h2 id="饮食注意">饮食注意</h2>

<p>我本身血压高，所以需要低盐。然后减脂的话，一般的讲法是不要吃或者少吃和糖类有关系的食物，比如糖，西瓜这些，以及很容易转换为糖类的食物，比如谷物，大米这些。可以吃肉类（瘦肉或者白肉，比如鸡肉鱼肉）。</p>

<p>我以前基本没做过几个青菜的饭。目前还在摸索中。</p>

<p>不用水煮直接凉拌：黄瓜，西红柿等，莴笋</p>

<p>白水煮了就能接受的：西兰花，菜花</p>

<p>水煮之后过油炒一下加点盐或者酱油的：油菜，蘑菇，小白菜，菠菜</p>

<p>直接过油炒一下加盐或者酱油：芹菜</p>

<p>之前看了一本书，里面讲到几个低盐的方法，就是比如放入火腿肠等本身自带咸味的食材，或者往酸的方向走。</p>

    </div>

<div class="meta">
    
    <span class="comments"><a href="/My-way-to-keep-fit/#disqus_thread">Comments</a></span>
    
</div>
</article>

  <article class="post">
    <h2 class="title"> 
        <a href="/Use-org-mode-to-publish-blog/">Use org mode to publish blog</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2017-03-12T08:59:19.000&#43;08:00' itemprop="datePublished">2017-03-12</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/org-mode">org-mode</a>

<a href="/tags/org">org</a>


</div>
    </div>
        <p>a test</p>

<p>啊哈哈哈哈，超棒唉。markdown 里面写代码都没有高亮，org 里面是可以把代码部分高亮的。</p>

<p>效果可以看 <a href="https://goo.gl/photos/E8p1WX34rfAQn31v9" title="这里">这里</a></p>

<h2 id="title1">Title1</h2>

<h3 id="title2">title2</h3>

<ul>
<li>list1</li>
<li>list2</li>
<li>list3</li>
</ul>

<pre><code class="language-python">
import sys

class Hugo(object):
    def __init__(self):
        pass

hugo = Hugo()
print(hugo)
print(&quot;just a test&quot;)
</code></pre>

    </div>

<div class="meta">
    
    <span class="comments"><a href="/Use-org-mode-to-publish-blog/#disqus_thread">Comments</a></span>
    
</div>
</article>

  <article class="post">
    <h2 class="title"> 
        <a href="/Migrate-blog-to-hugo/">Migrate blog to hugo</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2017-03-11T16:29:40.000&#43;08:00' itemprop="datePublished">2017-03-11</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/hugo">hugo</a>

<a href="/tags/hexo">hexo</a>

<a href="/tags/blog">blog</a>


</div>
    </div>
        <p>折腾了好几天，把 blog 从 hexo 迁移到了 <a href="http://gohugo.io/">hugo</a> 上面。hexo 是使用 nodejs 写出来的，hugo 是使用的 go。主要基于下面几个原因吧。</p>

<ul>
<li>个人不太喜欢 nodejs 那一坨依赖。</li>
<li>hugo 也比 nodejs 速度快很多。</li>
<li>hugo 用起来比较简洁。</li>
</ul>

<p>首先写了一个迁移工具 <a href="https://github.com/wd/hexo2hugo">hexo2hugo</a>。网上还有一个 nodejs 版本的<a href="http://nodejh.com/post/Migrate-to-Hugo-from-Hexo/">迁移工具</a>可以参考。其实就是简单的把头部信息处理一下就可以。我还有一些特殊需求，比如把老早以前的一些 html 格式的文档顺道处理一下格式，还有一些小的修正和兼容工作，所以自己写了一个。另外也主要是好久没有写代码了，熟悉下。。</p>

<p>把文档迁移过去之后，找了几个主题看了一下，发现没有很喜欢的，就本着蛋疼的原则，把原来用的主题也<a href="https://github.com/wd/hugo-fabric">迁移过来了</a>，这个花的时间比较长一点。主要还得熟悉 hugo 的模板语法，还得想办法适配 hugo 的体系。比如 hugo 里面没有 archive 一说，不过通过万能的 google 搜索到了一个解决办法，也勉强还好。</p>

<p>目前这个 blog 已经是由 hugo 产生了，和以前外观，访问地址完全一模一样，rss 地址都一样。我测试了 google 里面的搜索结果，是都可以跳转的。今天算是基本都迁移完毕了。</p>

<p>这几天没事也总想记录一点想法，但是无奈新本子上面的 hexo 挂了，又不想搞 nodejs 那一坨依赖，就折腾了这个事情。不过折腾完毕之后发现想记录的事情都忘记了，nnd。</p>

    </div>

<div class="meta">
    
    <span class="comments"><a href="/Migrate-blog-to-hugo/#disqus_thread">Comments</a></span>
    
</div>
</article>

  <article class="post">
    <h2 class="title"> 
        <a href="/Upgrade-kernel-to-4-9-for-linode/">Upgrade kernel to 4.9 for linode</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2017-01-16T18:37:56.000&#43;08:00' itemprop="datePublished">2017-01-16</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/linode">linode</a>

<a href="/tags/kernel">kernel</a>

<a href="/tags/bbr">bbr</a>


</div>
    </div>
        <p>bbr 那么牛逼，赶紧赶一个潮流。其实我之前用了 kcp，也是类似的东西，不过那个要求服务器端和客户端都需要跑 kcp 服务才可以。bbr 就不用了，只需要服务器配置好就可以了。</p>

<p>Linode 实际上已经提供了 4.9 的内核。打开 <code>Dashboard</code>，然后点击你使用的 profile 右侧的 edit，在出来的界面里面，Kernel 右侧的列表里面，有个 4.9 的选项，不过我测试这个内核并不能打开 bbr，不知道是怎么回事，有兴趣的可以试试看，要注意选对架构（就是 64 还是 32）。</p>

<p>所以还是需要自己装内核。debian 官方已经打包好了 kernel 4.9，访问 <a href="http://mirrors.kernel.org/debian/pool/main/l/linux/">http://mirrors.kernel.org/debian/pool/main/l/linux/</a> ，然后找到适合自己的 linux-image-4.9，我的是 <a href="http://mirrors.kernel.org/debian/pool/main/l/linux/linux-image-4.9.0-1-amd64-unsigned_4.9.2-2_amd64.deb">http://mirrors.kernel.org/debian/pool/main/l/linux/linux-image-4.9.0-1-amd64-unsigned_4.9.2-2_amd64.deb</a> ，下载到 vps 上面。</p>

<p>然后执行 <code>sudo dkpg -i ./linux-image-4.9.0-1-amd64-unsigned_4.9.2-2_amd64.deb</code>，最后应该会提示一个错误，缺少依赖的包。这个时候执行 <code>sudo apt-get -f install</code>，会提示安装缺失的包。</p>

<p>然后，还需要安装 <code>grub</code>。看你的情况。就刚才 profile 编辑的页面里面，kernel 右侧的选项里面，你看看你的是 <code>grub2</code> 还是 <code>pv-grub</code>。</p>

<ul>
<li><p><code>grub2</code>: 参考<a href="https://www.linode.com/docs/tools-reference/custom-kernels-distros/run-a-distribution-supplied-kernel-with-kvm">这个</a></p>

<pre><code>$ sudo apt-get install grub2
$ sudo update-grub
</code></pre></li>

<li><p><code>pv-grub</code>: 参考<a href="https://www.linode.com/docs/tools-reference/custom-kernels-distros/run-a-distributionsupplied-kernel-with-pvgrub">这个</a></p>

<pre><code>$ sudo apt-get install grub
$ sudo mkdir /boot/grub
$ sudo update-grub
</code></pre></li>
</ul>

<p>然后在 profile 编辑页面里面，kernel 右侧选择对应的 grub 选项，重启 vps 就可以了。如果启动失败了，就在这个选项里面，选择之前的选项重启就可以恢复。</p>

    </div>

<div class="meta">
    
    <span class="comments"><a href="/Upgrade-kernel-to-4-9-for-linode/#disqus_thread">Comments</a></span>
    
</div>
</article>

  <article class="post">
    <h2 class="title"> 
        <a href="/Python-new/">Python __new__</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2017-01-16T15:47:59.000&#43;08:00' itemprop="datePublished">2017-01-16</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/python">python</a>


</div>
    </div>
        <p>翻译一点 <a href="https://www.python.org/download/releases/2.2/descrintro/#__new__">https://www.python.org/download/releases/2.2/descrintro/#__new__</a> 有些感觉还是挺生硬的，方便自己理解吧。</p>

<p><code>__new__</code> 的一些规则:</p>

<ul>
<li><code>__new__</code> 是一个静态方法。定义它的时候并不需要执行 <code>__new__ = staticmethod(__new__)</code>，因为它的名字就包含了这个含义（这个对于类构造方法来说是个特殊的函数）</li>
<li><code>__new__</code> 的第一个参数，必须是一个类，其余的参数是留给构造方法的。</li>
<li>覆盖了基类的 <code>__new__</code> 方法的类有可能会调用基类的 <code>__new__</code> 方法。传递给基类的 <code>__new__</code> 方法的第一个参数，应该是覆盖基类的 <code>__new__</code> 方法的类，而不是基类，如果传递了基类，你得到的将是基类的示例。</li>
<li>除非你想要按照后面两条描述的方法来使用，否则 <code>__new__</code> 方法必须要调用基类的 <code>__new__</code> 方法，这个是创建你的对象的实例的唯一方法。子类的 <code>__new__</code> 方法可以从两个方面影响产生的实例：传递不同的参数给基类的 <code>__new__</code>，以及修改基类产生的对象（例如初始化一些实例变量）</li>
<li><code>__new__</code> 方法必须返回一个对象。并不一定必须返回一个新的对象，虽然通常都那么做。如果你返回一个已经存在的对象，依然会有对于 <code>__init__</code> 构造函数的调用。如果你返回一个其他函数的对象，那个对象的 <code>__init__</code> 也会被调用。如果忘记返回，python 会给你返回 None，你程序的调用方也许会觉得很奇怪。</li>
<li>对于不可变对象，<code>__new__</code> 可以返回一个之前缓存的对象。对于一些比较小的 int, str, tuple 类型就是这么做的。这也是为什么他们的 <code>__init__</code> 什么都没做：否则之前缓存的对象会被 init 很多次。（另外一个原因是本身页没有东西可以给 <code>__init__</code> 初始化的了，<code>__new__</code> 返回的就是一个已经初始化的对象）。</li>
<li>如果你想要给一个内置的不可变类型增加一些可变的状态（例如给 string 类型增加一个默认的转换方法），最好是在 <code>__init__</code> 方法里面初始化可变状态，而不要在 <code>__new__</code> 里面。</li>
<li>如果你想要修改构造方法的签名，一般需要覆盖 <code>__new__</code> 和 <code>__init__</code> 方法来接受心的签名。然而，大部分内置类型都会忽视自己不用的参数，尤其是不可变类型（int，long，float，complex，str，unicode，tuple）都有一个假的 <code>__init__</code>，而可变类型（dict，list，file，super，classmethod，staticmethd，property）有一个假的 <code>__new__</code>。内置类型 <code>object</code> 有假的 <code>__init__</code> 和 <code>__new__</code> （给其他对象继承）。内置类型 <code>type</code> 在很多方面都很特别，请参考 metaclasses。</li>
<li>（这条和 <code>__new__</code> 没关系，但是页应该了解一下）如果新建一个 <code>type</code> 的子类，实例会自动给 <code>__dict__</code> 和 <code>__weakrefs__</code> 预留空间（ <code>__dict__</code> 在你使用前不会初始化，所以你不需要担心创建的所有实例被一个空的字典所占用的空间）。如果不需要这个多余的空间，可以给你的类设置 <code>__slots__ = []</code>（更多信息可以参考 <code>__slots__</code>。</li>
<li>Factoid: <code>__new__</code> 是一个静态方法，不是类方法。我开始的时候觉得他应该是一个类方法，and that&rsquo;s why I added the classmethod primitive。不幸的是，对于一个类方法，在这种情况下面 upcalls 不工作，所以我只好把他设计成一个第一个参数是一个 class 的静态方法。讽刺的是，there are now no known uses for class methods in the Python distribution (other than in the test suite). I might even get rid of classmethod in a future release if no good use for it can be found!</li>
</ul>

    </div>

<div class="meta">
    
    <span class="comments"><a href="/Python-new/#disqus_thread">Comments</a></span>
    
</div>
</article>

  <article class="post">
    <h2 class="title"> 
        <a href="/Python-inherit-and-super/">Python inherit and super</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2017-01-16T11:53:04.000&#43;08:00' itemprop="datePublished">2017-01-16</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/python">python</a>

<a href="/tags/super">super</a>

<a href="/tags/inherit">inherit</a>


</div>
    </div>
        <p>又学习了一个 python 的继承。有很多帖子都有介绍，比如<a href="https://laike9m.com/blog/li-jie-python-super,70/">理解 Python super</a>，<a href="http://www.cnblogs.com/lovemo1314/archive/2011/05/03/2035005.html">python super()</a>。</p>

<p>先看一个例子，这个是第一个文章里面的。</p>

<pre><code>class Root(object):
    def __init__(self):
        print(&quot;this is Root&quot;)


class B(Root):
    def __init__(self):
        print(&quot;enter B&quot;)
        super(B, self).__init__()
        print(&quot;leave B&quot;)


class C(Root):
    def __init__(self):
        print(&quot;enter C&quot;)
        super(C, self).__init__()
        print(&quot;leave C&quot;)


class D(C):
    def __init__(self):
        print(&quot;enter D&quot;)
        super(D, self).__init__()
        print(&quot;leave D&quot;)


class E(D, B):
    def __init__(self):
        print(&quot;enter E&quot;)
        super(E, self).__init__()
        print(&quot;leave E&quot;)

e = E()
print(e.__class__.mro())

# results:
# enter E
# enter D
# enter C
# enter B
# this is Root
# leave B
# leave C
# leave D
# leave E
# [&lt;class '__main__.E'&gt;, &lt;class '__main__.D'&gt;, &lt;class '__main__.C'&gt;, &lt;class '__main__.B'&gt;, &lt;class '__main__.Root'&gt;, &lt;class 'object'&gt;]
</code></pre>

<p>没有什么问题，所有的类都做了初始化，很完美。接着再看一个例子，这个例子其实是上面第二篇文章里面的。</p>

<pre><code>class A(object):
    def __init__(self):
        print(&quot;enter A&quot;)
        print(&quot;leave A&quot;)


class B(object):
    def __init__(self):
        print(&quot;enter B&quot;)
        print(&quot;leave B&quot;)


class C(A):
    def __init__(self):
        print(&quot;enter C&quot;)
        super(C, self).__init__()
        print(&quot;leave C&quot;)


class D(A):
    def __init__(self):
        print(&quot;enter D&quot;)
        super(D, self).__init__()
        print(&quot;leave D&quot;)


class E(B, C):
    def __init__(self):
        print(&quot;enter E&quot;)
        super(E, self).__init__()
        print(&quot;leave E&quot;)


class F(E, D):
    def __init__(self):
        print(&quot;enter F&quot;)
        super(F, self).__init__()
        print(&quot;leave F&quot;)


f = F()
print(f.__class__.mro())

# results:
# enter F
# enter E
# enter B
# leave B
# leave E
# leave F
# [&lt;class '__main__.F'&gt;, &lt;class '__main__.E'&gt;, &lt;class '__main__.B'&gt;, &lt;class '__main__.C'&gt;, &lt;class '__main__.D'&gt;, &lt;class '__main__.A'&gt;, &lt;class 'object'&gt;]
</code></pre>

<p>我发现和文章里面贴的结果不一样，里面缺少对 C，D，A 的初始化。琢磨半天才弄明白，主要原因就是，<code>A</code>，<code>B</code> 其实也是继承自 <code>object</code>，然而我们并没有调用 <code>super</code> 来初始化，所以只需要加上就可以了。</p>

<pre><code>class A(object):
    def __init__(self):
        print(&quot;enter A&quot;)
        super(A, self).__init__()
        print(&quot;leave A&quot;)


class B(object):
    def __init__(self):
        print(&quot;enter B&quot;)
        super(B, self).__init__()
        print(&quot;leave B&quot;)


class C(A):
    def __init__(self):
        print(&quot;enter C&quot;)
        super(C, self).__init__()
        print(&quot;leave C&quot;)


class D(A):
    def __init__(self):
        print(&quot;enter D&quot;)
        super(D, self).__init__()
        print(&quot;leave D&quot;)


class E(B, C):
    def __init__(self):
        print(&quot;enter E&quot;)
        super(E, self).__init__()
        print(&quot;leave E&quot;)


class F(E, D):
    def __init__(self):
        print(&quot;enter F&quot;)
        super(F, self).__init__()
        print(&quot;leave F&quot;)


f = F()
print(f.__class__.mro())

# results:
# enter F
# enter E
# enter B
# enter C
# enter D
# enter A
# leave A
# leave D
# leave C
# leave B
# leave E
# leave F
# [&lt;class '__main__.F'&gt;, &lt;class '__main__.E'&gt;, &lt;class '__main__.B'&gt;, &lt;class '__main__.C'&gt;, &lt;class '__main__.D'&gt;, &lt;class '__main__.A'&gt;, &lt;class 'object'&gt;]
</code></pre>

<p>这样就完美了。目测这个会是一个隐藏的坑。</p>

    </div>

<div class="meta">
    
    <span class="comments"><a href="/Python-inherit-and-super/#disqus_thread">Comments</a></span>
    
</div>
</article>

  <article class="post">
    <h2 class="title"> 
        <a href="/Python-metaclass/">Python metaclass</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2017-01-12T18:26:22.000&#43;08:00' itemprop="datePublished">2017-01-12</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/python">python</a>


</div>
    </div>
        <p>又理解了一下 python 的 metaclass 可以做什么，尝试记录一下。</p>

<pre><code>class Meta(type):
    register = []

    def __new__(cls, class_name, parrent_class, params):
        print(&quot;In meta new: {}, {}, {}, {}&quot;.format(cls, class_name, parrent_class, params))
        cls.register.append(class_name)
        params['test_prop'] = True
        # return super(Meta, cls).__new__(cls, class_name, parrent_class, params)
        # return type.__new__(cls, class_name, parrent_class, params)
        # return super(Meta, cls).__new__(type, class_name, parrent_class, params)
        # return type.__new__(type, class_name, parrent_class, params)
        return type(class_name, parrent_class, params)

    def __init__(self, class_name, parrent_class, params):
        print(&quot;In meta init: {}, {}, {}&quot;.format(class_name, parrent_class, params))
        super(Meta, self).__init__(class_name, parrent_class, params)


class A(object, metaclass=Meta):
    pass

print(&quot;register: {}&quot;.format(Meta.register))
print(&quot;prop: {}&quot;.format(A.test_prop))
print(&quot;register: {}&quot;.format(A.register))  # Error

# outputs:
# In meta new: &lt;class '__main__.Meta'&gt;, A, (&lt;class 'object'&gt;,), {'__module__': '__main__', '__qualname__': 'A'}
# In meta init: A, (&lt;class 'object'&gt;,), {'__module__': '__main__', '__qualname__': 'A'}
# register: ['A']
# prop: True
# AttributeError: type object 'A' has no attribute 'register'

</code></pre>

<p>可以看到，在构造 <code>A</code> 的时候，<code>Meta</code> 这个类里面，<code>__new__</code> 和 <code>__init__</code> 都会被调用到。上面代码往 <code>A</code> 里面塞了一个属性。</p>

<p>在 <code>__new__</code> 里面，有几个注释，可以去掉注释看看不同的效果。目前还有点疑惑，传给 <code>__new__</code> 第一个参数到底是什么。另外，开始对 <code>super</code> 也有点疑惑了，还在学习。</p>

    </div>

<div class="meta">
    
    <span class="comments"><a href="/Python-metaclass/#disqus_thread">Comments</a></span>
    
</div>
</article>

  <article class="post">
    <h2 class="title"> 
        <a href="/Reinvent-the-wheel/">Reinvent the wheel</a>
    </h2>
    <div class="entry-content">
    <div class="meta">
        <div class="date">Published on: <time datetime='2017-01-12T16:16:20.000&#43;08:00' itemprop="datePublished">2017-01-12</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/heart">heart</a>

<a href="/tags/tech">tech</a>


</div>
    </div>
        <p><a href="https://en.wikipedia.org/wiki/Reinventing_the_wheel">Reinvent the wheel</a> 估计技术人员都知道这个典故。</p>

<p>刚才突然想谈这个，是看到图拉鼎参加 <a href="https://weex-project.io/">weex</a> 的聚会有感而发。我要是没理解错，这个应该是类似于 React native 的一套实现，我没有仔细看过他的实现，不过说他重复造轮子应该也不为过，毕竟，大家普遍赞成的是在已有的轮子上面添砖加瓦，而不是另起一套。</p>

<p>重复造轮子到底应该不应该支持？</p>

<p>之前我司来了一个发明了 avalon 框架的牛人，之后我看好像就在很多的推介这个，新人来了先学习这个。后来还有很多这种框架，新人来了都是先学习这些框架。</p>

<p>这个事情上面，我看有几个好处
* 发明的人可以在公司内部得到很高的地位，以及相应的奖励。不管好用不好用，推行一版，一波人升天。后人再升级一版，又一波人升天。
* 学会了使用这些框架的人，如果自己本身不太灵活，到了其他公司会发现无法干活，因为使用多了会有一个很深的烙印。这样离职起来就没那么方便。
* 比较好规范和控制公司内部的技术方向。</p>

<p>坏处
* 和最新的技术方向可能有割裂，因为并不一定能及时更新适应。
* 问题解决只能依赖内部的这些人来解决，这种东西想要推广出去毕竟还是难。
* 浪费人力做基础建设。</p>

<p>其实看起来，对于基层员工来看好处还是大于坏处的。毕竟如果老板不关心这个成本或者不清楚可以节约这个成本的话，那些好处还是实实在在的，牛逼有的吹。</p>

<p>在老板关心的方面，可能还有一个点，就是创新有时候是比较难的，但是所谓的微创新其实是简单一些，造轮子的时候，一般多少都会有一些微创新。如果搞的人确实有能力，避免一些原来设计里面的鸡肋冗余的部分，让新的设计更加轻快，其实也算是有好处。</p>

    </div>

<div class="meta">
    
    <span class="comments"><a href="/Reinvent-the-wheel/#disqus_thread">Comments</a></span>
    
</div>
</article>



  <nav id="pagenavi">
    
    
        <a href="/page/2/" class="next">Next</a>
    
  <div class="center"><a href="/archives/index.html">Blog Archives</a></div>
  </nav>


    </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2017
    
    wd
    . Powered by <a href="http://gohugo.io" target="_blank">Hugo</a> |
    Theme is <a href="https://github.com/wd/hugo-fabric">hugo-fabric</a>, fork from <a href="https://github.com/wd/hexo-fabric">hexo-fabric</a> by <a href="https://wdicc.com">me</a>
</div>

    </footer>
    <script src="/js/fabric.js"></script>


</div>
</div>
<script src="/js/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
 
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery);
 
</script>
</body>
</html>
