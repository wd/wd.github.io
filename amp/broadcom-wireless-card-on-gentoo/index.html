<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>broadcom BCM wireless card on gentoo - wd and cc</title><link rel=icon type=image/png href=/favicon.ico><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="broadcom BCM wireless card on gentoo"><meta property="og:description" content="昨天又折腾了一下我的无线，是 dell 的本子，broadcom 的卡 BCM4313，准备写一下的时候，发现之前"><meta property="og:type" content="article"><meta property="og:url" content="https://wdicc.com/amp/broadcom-wireless-card-on-gentoo/"><meta property="article:published_time" content="2013-05-24T17:28:00+08:00"><meta property="article:modified_time" content="2013-05-24T17:28:00+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="broadcom BCM wireless card on gentoo"><meta name=twitter:description content="昨天又折腾了一下我的无线，是 dell 的本子，broadcom 的卡 BCM4313，准备写一下的时候，发现之前"><link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://wdicc.com/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://wdicc.com/css/main.css><link rel=stylesheet type=text/css href=https://wdicc.com//light-syntax.css media="(prefers-color-scheme: light)"><link rel=stylesheet type=text/css href=https://wdicc.com/css/dark.css media="(prefers-color-scheme: dark)"><link rel=stylesheet type=text/css href=https://wdicc.com//dark-syntax.css media="(prefers-color-scheme: dark)"><script src=https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js></script><script src=https://wdicc.com/js/main.js></script></head><body><div class="container wrapper post"><div class=header><base href=https://wdicc.com/><h1 class=site-title><a href=https://wdicc.com/>wd and cc</a></h1><div class=site-description><h2>&mdash; Happy every day</h2><nav class="nav social"><ul class=flat><a href=https://github.com/wd title=Github><i data-feather=github></i></a><a href=https://twitter.com/wd title=Twitter><i data-feather=twitter></i></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>Home</a></li><li><a href=/post>All posts</a></li><li><a href=/tags>Tags</a></li><li><a href="https://www.google.com.hk/search?sitesearch=https%3A%2F%2Fwdicc.com%2F&q=">Search</a></li><li><a href=/atom.xml>Subscribe</a></li></ul></nav></div><div class=post-header><h1 class=title>broadcom BCM wireless card on gentoo</h1><div class=meta>Posted at &mdash; May 24, 2013</div></div><div class=post-header><nav id=TableOfContents></nav></div><div class=markdown><p>昨天又折腾了一下我的无线，是 dell 的本子，broadcom 的卡 BCM4313，准备写一下的时候，发现之前居然折腾过 <a href=/bcm4312broadcom-stawpa_supplicantkernel2-6-33/>BCM4312</a>。。感觉真蛋疼。。</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ lspci -vnn -d 14e4:
02:00.0 Network controller <span class=o>[</span>0280<span class=o>]</span>: Broadcom Corporation BCM4313 802.11b/g/n Wireless LAN Controller <span class=o>[</span>14e4:4727<span class=o>]</span> <span class=o>(</span>rev 01<span class=o>)</span>
        Subsystem: Dell Inspiron M5010 / XPS <span class=m>8300</span> <span class=o>[</span>1028:0010<span class=o>]</span>
        Flags: fast devsel, IRQ <span class=m>17</span>
        Memory at e5300000 <span class=o>(</span>64-bit, non-prefetchable<span class=o>)</span> <span class=o>[</span><span class=nv>size</span><span class=o>=</span>16K<span class=o>]</span>
        Capabilities: &lt;access denied&gt;
        Kernel modules: bcma
</code></pre></div><p>根据 <a href=http://wireless.kernel.org/en/users/Drivers/b43#bcm43xx.2C_b43legacy.2C_b43.2C_softmac.2C..._the_full_story>这里</a> ， BCM 的网卡有三种可用驱动</p><ul><li>b43，kernel 自带，源自 broadcom linux 驱动的逆向工程</li><li>brcmsmac, kernel 自带，似乎源自 broadcom 某个开源的驱动</li><li>wl, broadcom 发布的 linux 驱动</li></ul><p>另外，kernel 自带的 b43 和 brcmsmac 支持标准的 802.11 栈，可以通过 iw iwconfig 之类的工具来配置，获取状态。wl 就不行了。</p><p>如果想使用 b43 或者 brcmsmac，需要选择下面的 kernel 选项，要注意都选择成 module，因为还需要加载 firmware，如果编译进内核那需要把 firmware 也编译到内核才可以。</p><pre><code>Networking support  ---&gt;  Wireless  ---&gt; Generic IEEE 802.11 Networking Stack (mac80211)
Device Drivers  ---&gt; Broadcom specific AMBA  ---&gt;  BCMA support
</code></pre><p>针对 b43 选择 <code>Device Drivers ---> Network device support ---> Wireless LAN ---> Broadcom 43xx wireless support (mac80211 stack)</code>, 还需要安装 <code>sys-firmware/b43-firmware</code>。</p><p>针对 brcmsmac 选择 <code>Device Drivers ---> Network device support ---> Wireless LAN ---> Broadcom IEEE802.11n PCIe SoftMAC WLAN driver</code>，还需要安装 <code>sys-kernel/linux-firmware</code>。</p><p>对于 wl，需要安装 <code>net-wireless/broadcom-sta</code>，安装的时候会自动检查必要的内核选项，按照提示选择好就可以了。主要是要注意去掉上面的 kernel 的选项，另外可能还需要一个 ipw2100 来提供某一个隐藏的 kernel 选项。此外还有个 PREEMPT_RCU 检查，需要选择下面的内核选项 <code>Processor type and features ---> Preemption Model (Voluntary Kernel Preemption (Desktop)) ---> Voluntary Kernel Preemption (Desktop) </code>。</p><p>如此之后编译安装重启就可以了。</p></div><div class=post-tags><nav class="nav tags"><ul class=flat><li><a href=/tags/linux>linux</a></li></ul></nav></div><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")
return;var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='wdicc';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by
Disqus.</a></noscript><a href=http://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><div class="footer wrapper"><nav class=nav><div>Copyright © 2020 wd. All Rights Reserved | <a href=https://github.com/vividvilla/ezhil>Ezhil theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></nav></div><script>feather.replace()</script></body></html>