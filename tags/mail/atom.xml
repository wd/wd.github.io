<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Mail on wd and cc</title><link>https://wdicc.com/tags/mail/</link><description>Recent content in Mail on wd and cc</description><generator>Hugo</generator><language>en</language><copyright>wd © 2025</copyright><lastBuildDate>Mon, 01 Dec 2008 00:00:00 +0000</lastBuildDate><atom:link href="https://wdicc.com/tags/mail/atom.xml" rel="self" type="application/rss+xml"/><item><title>命令行发送有附件的邮件</title><link>https://wdicc.com/send-mail-with-attachment/</link><pubDate>Mon, 01 Dec 2008 00:00:00 +0000</pubDate><guid>https://wdicc.com/send-mail-with-attachment/</guid><description>命令行下面发送邮件比较简单，恐怕都会使用。&lt;br />

&lt;pre class="prettyprint lang-bash">
$ echo "hello .. " | mail -s subject xxx@abc.com
$ cat /path/to/file | mail -s subject xxx@abc.com
$ mail -s subject xxx@abc.com &lt;&lt; EOF
hi
the end..
EOF
&lt;/pre>&lt;br />

上面这些方法都可以发送邮件。还有一种方法。&lt;br />

&lt;pre class="prettyprint lang-bash">
$ cat a.txt
Subject: test
From: xxx@abc.com
To: xxx@abc.com

hi
sdfsdfsdf
the end.
$ cat a.txt | sendmail -t
&lt;/pre>&lt;br />

这样可以把邮件头信息写到文件里面的，你也可以用 php，perl 来打印类似的信息给 sendmail -t ，让他来发。&lt;br />

那么如果有附件应该怎么办？可以使用 uuencode。&lt;br />

&lt;pre class="prettyprint lang-bash">
$ uuencode a.txt a.txt | mail -s test xxx@abc.com
$ (cat a.txt; uuencode b.txt b.txt; cat c.txt) |sendmail -t
&lt;/pre>&lt;br />

应该说的很明白了吧？&lt;br /></description></item><item><title>ORA-00257 和 ORA-19815</title><link>https://wdicc.com/ora-00257-and-ora-19815/</link><pubDate>Sat, 06 Sep 2008 00:00:00 +0000</pubDate><guid>https://wdicc.com/ora-00257-and-ora-19815/</guid><description>这几天遇到了这两个错误，记录一下。&lt;br />

使用 perl 的 DBI 连接的时候，会提示 ora-00257 错误，这个用 三qlplus 估计也是一样的错误，注意时远程连接才出错。&lt;br />

&lt;pre class="prettyprint lang-txt">
CRITICAL : Can't connect "db8.sds.cnb.yahoo.com"&lt;/pre>

同时，数据库的alert 里面有下面的信息

&lt;pre class="prettyprint lang-txt">
ORA-19815: WARNING: db_recovery_file_dest_size of 268435456000 bytes is 100.00% used, and has 0 remaining bytes available.
************************************************************************
You have following choices to free up space from flash recovery area:
1. Consider changing RMAN RETENTION POLICY. If you are using Data Guard,
 then consider changing RMAN ARCHIVELOG DELETION POLICY.
2. Back up files to tertiary device such as tape using RMAN
 BACKUP RECOVERY AREA command.
3. Add disk space and increase db_recovery_file_dest_size parameter to
 reflect the new space.
4. Delete unnecessary files using RMAN DELETE command. If an operating
 system command was used to delete files, then use RMAN CROSSCHECK and
 DELETE EXPIRED commands.
************************************************************************
ARCH: Archival stopped, error occurred. Will continue retrying
ORACLE Instance nirv3 - Archival Error&lt;/pre>

登陆上数据库看看

&lt;pre class="prettyprint lang-txt">

NAME TYPE VALUE
------------------------------------ ---------------------- ------------------------------
archive_lag_target integer 0
log_archive_config string dg_config=(stb1)
log_archive_dest string
log_archive_dest_1 string location="USE_DB_RECOVERY_FILE
log_archive_dest_10 string
log_archive_dest_2 string
log_archive_dest_3 string
log_archive_dest_4 string
log_archive_dest_5 string
log_archive_dest_6 string
log_archive_dest_7 string

NAME TYPE VALUE
------------------------------------ ---------------------- ------------------------------
log_archive_dest_8 string
log_archive_dest_9 string
log_archive_dest_state_1 string ENABLE
log_archive_dest_state_10 string enable
log_archive_dest_state_2 string ENABLE
log_archive_dest_state_3 string enable
log_archive_dest_state_4 string enable
log_archive_dest_state_5 string enable
log_archive_dest_state_6 string enable
log_archive_dest_state_7 string enable
log_archive_dest_state_8 string enable

NAME TYPE VALUE
------------------------------------ ---------------------- ------------------------------
log_archive_dest_state_9 string enable
log_archive_duplex_dest string
log_archive_format string %s_%t_%r_%a.arc
log_archive_local_first boolean TRUE
log_archive_max_processes integer 4
log_archive_min_succeed_dest integer 1
log_archive_start boolean FALSE
log_archive_trace integer 0
standby_archive_dest string ?/dbs/arch

SQL&amp;gt; select * from v$log;

 GROUP# THREAD# SEQUENCE# BYTES MEMBERS ARCHIV STATUS FIRST_CHANGE# FIRST_TIME
---------- ---------- ---------- ---------- ---------- ------ -------------------------------- ------------- ------------
 1 1 221250 52428800 1 YES INACTIVE 5082709437 05-SEP-08
 2 1 221252 52428800 1 NO INACTIVE 5082713458 05-SEP-08
 3 2 270972 52428800 1 YES INACTIVE 5082699510 05-SEP-08
 4 2 270975 52428800 1 NO CURRENT 5082713581 05-SEP-08
 9 1 221251 52428800 1 NO INACTIVE 5082712943 05-SEP-08
 10 2 270973 52428800 1 YES INACTIVE 5082705151 05-SEP-08
 11 1 221253 52428800 1 NO CURRENT 5082713765 05-SEP-08
 12 2 270974 52428800 1 NO INACTIVE 5082711887 05-SEP-08
 13 3 275581 52428800 1 NO INACTIVE 5082712519 05-SEP-08
 14 3 275582 52428800 1 NO CURRENT 5082713078 05-SEP-08
 15 3 275579 52428800 1 NO INACTIVE 5082710114 05-SEP-08

 GROUP# THREAD# SEQUENCE# BYTES MEMBERS ARCHIV STATUS FIRST_CHANGE# FIRST_TIME
---------- ---------- ---------- ---------- ---------- ------ -------------------------------- ------------- ------------
 16 3 275580 52428800 1 NO INACTIVE 5082711321 05-SEP-08

12 rows selected.

SQL&amp;gt; ????select value from v$diag_info where name ='Diag Trace';

VALUE
------------------------------------------------------------------------------------------------------------------------------------------------------
/home/oracle/app/diag/rdbms/nirv/nirv3/trace

SQL&amp;gt; select * from V$FLASH_RECOVERY_AREA_USAGE;

FILE_TYPE PERCENT_SPACE_USED PERCENT_SPACE_RECLAIMABLE NUMBER_OF_FILES
---------------------------------------- ------------------ ------------------------- ---------------
CONTROL FILE 0 0 0
REDO LOG 0 0 0
ARCHIVED LOG 100 0 13109
BACKUP PIECE 0 0 0
IMAGE COPY 0 0 0
FLASHBACK LOG 0 0 0
FOREIGN ARCHIVED LOG 0 0 0

7 rows selected.

SQL&amp;gt; show parameter db_recovery_file_dest_size

NAME TYPE VALUE
------------------------------------ ---------------------- ------------------------------
db_recovery_file_dest_size big integer 250G
SQL&amp;gt; show parameter DB_RECOVERY_FILE_DEST

NAME TYPE VALUE
------------------------------------ ---------------------- ------------------------------
db_recovery_file_dest string /sds/oradata
db_recovery_file_dest_size big integer 250G
SQL&amp;gt; alter system set db_recovery_file_dest_size=300G; 

System altered.

SQL&amp;gt; show parameter DB_RECOVERY_FILE_DEST

NAME TYPE VALUE
------------------------------------ ---------------------- ------------------------------
db_recovery_file_dest string /sds/oradata
db_recovery_file_dest_size big integer 300G
SQL&amp;gt; select * from V$FLASH_RECOVERY_AREA_USAGE;

FILE_TYPE PERCENT_SPACE_USED PERCENT_SPACE_RECLAIMABLE NUMBER_OF_FILES
---------------------------------------- ------------------ ------------------------- ---------------
CONTROL FILE 0 0 0
REDO LOG 0 0 0
ARCHIVED LOG 83.41 0 13115
BACKUP PIECE 0 0 0
IMAGE COPY 0 0 0
FLASHBACK LOG 0 0 0
FOREIGN ARCHIVED LOG 0 0 0

7 rows selected.&lt;/pre>

可以看到空间是 83% 了，数据库应该就好了。不过这个是治标不治本的操作，需要把archive log删掉才行，具体怎么搞我也不会。。。汗。。</description></item><item><title>sendmail 中自动抄送某个用户的邮件给别人</title><link>https://wdicc.com/howto-cc-an-email-to-others-in-sendmail/</link><pubDate>Tue, 26 Jun 2007 00:00:00 +0000</pubDate><guid>https://wdicc.com/howto-cc-an-email-to-others-in-sendmail/</guid><description>&lt;p>sendmail有个 /etc/aliases 配置文件，在里面可以给某个帐号设置alias，这样给这个alias发的邮件，都会给设置好的用户转发过去。要知道sendmail的帐号是和系统帐号联系在一起的，添加mail帐号得给系统添加帐号（qmail可以实现虚拟用户，或许sendmail也可以，而我不知道罢了）。而这个alias帐号却不是必须有得有系统帐号的，只要设置了alias，就可以给alias用户发邮件，就好像系统真有这么一个帐号一样。&lt;/p></description></item><item><title>mutt的两个问题以及解决办法</title><link>https://wdicc.com/2-problems-in-mutt/</link><pubDate>Wed, 01 Nov 2006 00:00:00 +0000</pubDate><guid>https://wdicc.com/2-problems-in-mutt/</guid><description>mutt&lt;a target="_blank" href="http://blog.wdicc.com/wordpress/2006/09/03/242/">用了一段时间&lt;/a>之后发现对方发过来的附件的名字都是乱码，多次之后就觉得比较郁闷，每次都得自己修改名字，还得猜文件类型，很郁闷。google了一下，发现了&lt;a target="_blank" title="gnus/mutt 邮件乱码问题" href="http://learn.tsinghua.edu.cn:8080/2002315162/muttpatched.html">解决办法&lt;/a>，是因为mutt默认使用的是rfc2331来解码的，所以添加一个set rfc2047_parameters=yes就可以了，这样对方发过来的邮件就可以正常显示文件名称了。但是同时从那个网址得知，我发出去的附件，也是用rfc2331来编码的，这样到了对方那里，显然会乱码了。测试了一下，outlook里面提示有附件，可是打开是乱码，并且附件名称也不是实际的附件名称。foxmail里面不提示有附件，内容后面会显示几个乱码。&lt;br />

按照前面那个网址，找到了&lt;a target="_blank" title="mutt的rfc2047补丁" href="http://www.emaillab.org/mutt/download1510.html.en">mutt的补丁&lt;/a>，尝试了半天，不能在muttng上面正常使用，没办法只好不用muttng用mutt了。打上补丁之后，设置了 set create_rfc2047_parameters=yes  发出去的邮件就正常了。在mutt的&lt;a target="_blank" title="mutt patch list" href="http://wiki.mutt.org/index.cgi?PatchList">patch list&lt;/a>列表里面找到&lt;a target="_blank" title="mutt的sidebar补丁" href="http://lunar-linux.org/index.php?page=mutt-sidebar">sidebar补丁&lt;/a>，给mutt打了sidebar的补丁，用起来也还行了。同时，也把我的mutt升级到了1.5.13，比源里面的都新了。呵呵。&lt;br />

此外，还有一个问题就是如何对应不同的账号使用不同的smtp server。 本来从网上找了一个文章说到了这个操作如何实现，我也照搬了，发现似乎可以实现这个功能。可是最近才发现，我完全错了，实际上用的总是msmtp里面设置的那个default smtp server，郁闷坏啦，给头以及同事发了好多邮件了，用的都是我的gmail邮箱。&lt;br />

现在我已经解决了这个问题，用的是send-hook，如下。&lt;br />
send-hook . 'my_hdr from:wd@aaa.com'&lt;br />
send-hook . 'set sendmail="/usr/bin/msmtp -a gmail"'&lt;br />
send-hook '~t .*@bbb\.com\.cn$' 'my_hdr from:stef@bbb.com.cn'&lt;br />
send-hook '~t .*@bbb\.com\.cn$' 'set sendmail="/usr/bin/msmtp -a bbb"'&lt;br />

这样，针对不同的mail，使用不同的sendmail程序。&lt;br />

发现mutt发送邮件的时候使用的是我的gmail邮箱的时候，我很郁闷，再加上发现他发送的附件在别人那里居然不认，让我就更郁闷了。立刻安装了thunderbird，并且设置好了他，打算以后就用他了。但是发现我已经习惯了mutt了，所以还是回头来给mutt打了补丁，做了修改，让他按照我的习惯来了。 用thunderbird后发现，很多事情不能按照我的意思来，很郁闷。&lt;br /></description></item><item><title>Qmail邮件队列工作原理zz</title><link>https://wdicc.com/qmail-queue/</link><pubDate>Thu, 30 Mar 2006 00:00:00 +0000</pubDate><guid>https://wdicc.com/qmail-queue/</guid><description>http://www.gbunix.com/htmldata/2005_06/15/25/article_1223_1.html&lt;br />

以下是qmail的数据流简图&lt;br />

 qmail-smtpd --- &amp;gt;&amp;gt;qmail-queue ---&amp;gt;&amp;gt; qmail-send &amp;lt;&amp;lt;--- qmail-rspawn &amp;lt;&amp;lt;--- qmail-remote&lt;br />
 &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; / &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp; | &lt;br />
 &amp;nbsp; &amp;nbsp; &amp;nbsp; qmail-inject _/ qmail-clean \_ qmail-lspawn &amp;lt;&amp;lt;--- qmail-local&lt;br />

 &amp;nbsp; &amp;nbsp;qmail中，每一条消息都发送到中央队列等待发送，由qmail-queue进程控制。它在以下情况被调用：&lt;br />
 &amp;nbsp; &amp;nbsp;1、当产生本地消息时，qmail-inject进程调用qmail-queue。&lt;br />
 &amp;nbsp; &amp;nbsp;2、qmail-smtpd准备SMTP协议下的投递邮件任务时调用它。&lt;br />
 &amp;nbsp; &amp;nbsp;3、向前（forwarded）发送邮件时，qmail－local调用它。&lt;br />
 &amp;nbsp; &amp;nbsp;4、退回邮件时，qmail－send调用它。&lt;br />

 &amp;nbsp; &amp;nbsp;每封邮件接着由qmail-lspawn 和qmail-rspawn协助qmail－sned进程完成投递，最后由qmail－clean清除邮件队列。这四个进程是系统由始至终都在运行的，十分重要。&lt;br />

由smtpd从域外接受邮件之后，会交给queue处理（也就是2），之后转到qmal-send，然后看是域内还是域外，域内用qmail-lspawn，域外用qmail-rspawn。域内邮件调用qmail-local处理，如果遇到.qmail文件转发邮件（也就是上面的3），还会交给queue处理，如果没有，就直接投递给用户（？）。域外邮件调用qmail-remote处理，如果对方拒收邮件，他就会产生一个新的邮件（bounce），交给qmail-send，然后交给queue（也就是4？）。&lt;br />

本地用户发送mail的时候调用qmail-inject，然后交给queue（也就是1）。&lt;br />

有几个问题。&lt;br />
1&amp;nbsp; 收到域外邮件之后，判断本机是否有这个用户后才接受邮件呢，还是先接受进来放到queue里等qmail-local处理的时候再说？&lt;br />

2&amp;nbsp; qmail-clean这个程序是怎么工作的？实时扫描queue的文件夹？&lt;br /></description></item><item><title>邮件如何从A点到达B点zz</title><link>https://wdicc.com/how-mail-from-a-to-b/</link><pubDate>Thu, 30 Mar 2006 00:00:00 +0000</pubDate><guid>https://wdicc.com/how-mail-from-a-to-b/</guid><description>&lt;p>当一个主机上的用户想要发送一个邮件给另一个主机上的用户时, 许多事情发生了, 这个场景后面的东西很多是不必要知道的那么确切的. &lt;/p> &lt;p>假设一个用户 Alice, alice@alpha.example.com 想要发送一个邮件给 Bob, bob@beta.example.com, 下面是发送接收过程: &lt;/p> &lt;p>1. Alice 用她的邮件用户代理(MUA)编写邮件, 比如使用 mutt 或者 pine. 她在 To 这一栏指定接收者, Subject 这一栏填写邮件主题, 加上邮件本身的文本部分. 整个邮件看起来是下面这样的: &lt;/p></description></item><item><title>caphit qmail 配置</title><link>https://wdicc.com/caphit-qmail-conf/</link><pubDate>Mon, 16 Jan 2006 00:00:00 +0000</pubDate><guid>https://wdicc.com/caphit-qmail-conf/</guid><description>参考网址&lt;br />
http://lifewithqmail.org(中文版http://lifewithqmail.org/LWQ-CN.html)&lt;br />
http://qmail.te8.com/rpms/glibc-2.3.1/(patch下载地址)&lt;br />
http://www.fehcom.de/qmail/qmail.html&lt;br />
http://www.pipeline.com.au/staff/mbowe/isp/vpopmail-mysql.htm&lt;br />
http://bbs.chinaunix.net/forum/viewtopic.php?t=254662&lt;br />

ucspi-tcp&lt;br />
http://cr.yp.to/ucspi-tcp.html&lt;br />
ucspi-tcp-0.88.a_record.patch，ucspi-tcp-0.88.errno.patch，ucspi-tcp-0.88.nodefaultrbl.patch&lt;br />
（或者）ucspi-tcp-0.88.a_record.patch，ucspi-tcp-0.88.errno.patch，ucspi-tcp-0.88.nobase.patch&lt;br />
patch -d ucspi-tcp.xxx -p1 &amp;lt; ucspi-tcp-xxx.patch&lt;br />
make&amp;amp;&amp;amp;make setup check&lt;br />

daemontools&lt;br />
http://cr.yp.to/daemontools.html&lt;br />
daemontools-0.76.errno.patch&lt;br />
package/install&lt;br />
Adding svscanboot to inittab...init should start svscan now.&lt;br />

cmd5checkpw&lt;br />
http://www.fehcom.de/qmail/auth/cmd5checkpw-030_tgz.bin&lt;br />
make&amp;amp;&amp;amp;make setup&lt;br />

qmail 1.03&lt;br />
http://cr.yp.to/qmail.html&lt;br />
http://www.fehcom.de/qmail/qmail.html&lt;br />
http://www.fehcom.de/qmail/spamcontrol/spamcontrol-2311_tgz.bin&lt;br />
tar zxvf spamcontrol-2311_tgz.bin&lt;br />
编辑conf-spamcontrol&lt;br />
建立用户组&lt;br />
groupadd nofiles&lt;br />
useradd -g nofiles -d /var/qmail qmaild -s /sbin/nologin&lt;br />
useradd -g nofiles -d /var/qmail qmaill -s /sbin/nologin&lt;br />
useradd -g nofiles -d /var/qmail qmailp -s /sbin/nologin&lt;br />
useradd -g nofiles -d /var/qmail/alias alias -s /sbin/nologin&lt;br />
groupadd qmail&lt;br />
useradd -g qmail -d /var/qmail qmailq -s /sbin/nologin&lt;br />
useradd -g qmail -d /var/qmail qmailr -s /sbin/nologin&lt;br />
useradd -g qmail -d /var/qmail qmails -s /sbin/nologin&lt;br />
./install_spamcontrol.sh&lt;br />
make setup check&lt;br />
./config-fast xxxx.com&lt;br />

vpopmail&lt;br />
http://sourceforge.net/projects/vpopmail/&lt;br />
groupadd vchkpw;useradd vpopmail&lt;br />
CREATE DATABASE vpopmail;&lt;br />
GRANT select,insert,update,delete,create,drop ON vpopmail.* TO vpopmailuser@localhost IDENTIFIED BY 'vpoppasswd';&lt;br />
配置(用igenus需要enable-many-domains)&lt;br />
./configure --enable-logging=p&lt;br />
--enable-domain-quotas=y&lt;br />
--enable-auth-module=mysql&lt;br />
--enable-tcprules-prog=/usr/local/bin/tcprules&lt;br />
--enable-tcpserver-file=/etc/tcp.smtp&lt;br />
--disable-mysql-limits&lt;br />
--enable-mysql-logging&lt;br />
--enable-many-domains&lt;br />
make&amp;amp;&amp;amp;make install-strip&lt;br />
vi vpopmail.mysql&lt;br />
vi vlimits.default&lt;br />
echo "xxxx.com" &amp;gt; /home/vpopmail/etc/defaultdomain&lt;br />
vi /home/vpopmail/domains/.quotawarn.msg&lt;br />
From: CAPH Postmaster&lt;br />
&lt;postmaster@xxx.com> Reply-To: postmaster@xxx.com&lt;br />
To: SomeCompany User:;&lt;br />
Subject: Mail quota warning&lt;br />
Mime-Version: 1.0&lt;br />
Content-Type: text/plain; charset=iso-8859-1&lt;br />
Content-Transfer-Encoding: 7bit&lt;/postmaster@xxx.com>&lt;br />

Your mailbox on the server is now more than 90% full.&lt;br />

So that you can continue to receive mail,&lt;br />
you need to remove some messages from your mailbox.&lt;br />

If you require assistance with this,&lt;br />
please contact our support department :&lt;br />

email : postmaster@xxx.com&lt;br />
Tel : 010 68372647&lt;br />
echo "Message rejected. Not enough storage space in user's mailbox to accept message." &amp;gt; /home/vpopmail/domains/.over-quota.msg&lt;br />

/var/qmail/rc&lt;br />
vi /var/qmail/rc&lt;br />
#!/bin/sh&lt;br />

# Using stdout for logging&lt;br />
# Using control/defaultdelivery from qmail-local to deliver messages by default&lt;br />

exec env - PATH="/var/qmail/bin:$PATH"&lt;br />
qmail-start "`cat /var/qmail/control/defaultdelivery`"&lt;br />

echo ./Maildir/ &amp;gt;/var/qmail/control/defaultdelivery&lt;br />
chmod 755 /var/qmail/rc&lt;br />
mkdir /var/log/qmail&lt;br />

/var/qmail/bin/qmailctl&lt;br />

vi /var/qmail/bin/qmailctl&lt;br />
#!/bin/sh&lt;br />

# description: the qmail MTA&lt;br />

PATH=/var/qmail/bin:/bin:/usr/bin:/usr/local/bin:/usr/local/sbin&lt;br />
export PATH&lt;br />
LOG_AUTH=1&lt;br />
export LOG_AUTH&lt;br />

QMAILDUID=`id -u qmaild`&lt;br />
NOFILESGID=`id -g qmaild`&lt;br />

case "$1" in&lt;br />
start)&lt;br />
echo "Starting qmail"&lt;br />
if svok /service/qmail-send ; then&lt;br />
svc -u /service/qmail-send /service/qmail-send/log&lt;br />
else&lt;br />
echo "qmail-send supervise not running"&lt;br />
fi&lt;br />
if svok /service/qmail-smtpd ; then&lt;br />
svc -u /service/qmail-smtpd /service/qmail-smtpd/log&lt;br />
else&lt;br />
echo "qmail-smtpd supervise not running"&lt;br />
fi&lt;br />
if svok /service/qmail-pop3d ; then&lt;br />
svc -u /service/qmail-pop3d /service/qmail-pop3d/log&lt;br />
else&lt;br />
echo qmail-pop3d supervise not running&lt;br />
fi&lt;br />
if [ -d /var/lock/subsys ]; then&lt;br />
touch /var/lock/subsys/qmail&lt;br />
fi&lt;br />
;;&lt;br />
stop)&lt;br />
echo "Stopping qmail..."&lt;br />
echo " qmail-smtpd"&lt;br />
svc -d /service/qmail-smtpd /service/qmail-smtpd/log&lt;br />
echo " qmail-smtpd"&lt;br />
svc -d /service/qmail-smtpd /service/qmail-smtpd/log&lt;br />
echo " qmail-send"&lt;br />
svc -d /service/qmail-send /service/qmail-send/log&lt;br />
echo " qmail-pop3d"&lt;br />
svc -d /service/qmail-pop3d /service/qmail-pop3d/log&lt;br />
if [ -f /var/lock/subsys/qmail ]; then&lt;br />
rm /var/lock/subsys/qmail&lt;br />
fi&lt;br />
;;&lt;br />
stat)&lt;br />
svstat /service/qmail-send&lt;br />
svstat /service/qmail-send/log&lt;br />
svstat /service/qmail-smtpd&lt;br />
svstat /service/qmail-smtpd/log&lt;br />
svstat /service/qmail-pop3d&lt;br />
svstat /service/qmail-pop3d/log&lt;br />
qmail-qstat&lt;br />
;;&lt;br />
doqueue|alrm|flush)&lt;br />
echo "Flushing timeout table and sending ALRM signal to qmail-send."&lt;br />
/var/qmail/bin/qmail-tcpok&lt;br />
svc -a /service/qmail-send&lt;br />
;;&lt;br />
queue)&lt;br />
qmail-qstat&lt;br />
qmail-qread&lt;br />
;;&lt;br />
reload|hup)&lt;br />
echo "Sending HUP signal to qmail-send."&lt;br />
svc -h /service/qmail-send&lt;br />
;;&lt;br />
pause)&lt;br />
echo "Pausing qmail-send"&lt;br />
svc -p /service/qmail-send&lt;br />
echo "Pausing qmail-smtpd"&lt;br />
svc -p /service/qmail-smtpd&lt;br />
echo "Pausing qmail-pop3d"&lt;br />
svc -p /service/qmail-smtpd&lt;br />
echo "Pausing qmail-pop3d"&lt;br />
svc -p /service/qmail-pop3d&lt;br />
;;&lt;br />
cont)&lt;br />
echo "Continuing qmail-send"&lt;br />
svc -c /service/qmail-send&lt;br />
echo "Continuing qmail-smtpd"&lt;br />
svc -c /service/qmail-smtpd&lt;br />
echo "Continuing qmail-pop3d"&lt;br />
svc -c /service/qmail-pop3d&lt;br />
;;&lt;br />
restart)&lt;br />
echo "Restarting qmail:"&lt;br />
echo "* Stopping qmail-smtpd."&lt;br />
svc -d /service/qmail-smtpd /service/qmail-smtpd/log&lt;br />
echo "* Sending qmail-send SIGTERM and restarting."&lt;br />
svc -t /service/qmail-send /service/qmail-send/log&lt;br />
echo "* Restarting qmail-smtpd."&lt;br />
svc -u /service/qmail-smtpd /service/qmail-smtpd/log&lt;br />
echo "* Restarting qmail-pop3d."&lt;br />
svc -t /service/qmail-pop3d /service/qmail-pop3d/log&lt;br />
;;&lt;br />
cdb)&lt;br />
tcprules /etc/tcp.smtp.cdb /etc/tcp.smtp.tmp &amp;lt; /etc/tcp.smtp&lt;br />
tcprules /etc/tcp.pop3.cdb /etc/tcp.pop3.tmp &amp;lt; /etc/tcp.pop3&lt;br />
chmod 644 /etc/tcp.smtp.cdb&lt;br />
chmod 644 /etc/tcp.pop3.cdb&lt;br />
echo "Reloaded /etc/tcp.smtp."&lt;br />
echo "Reloaded /etc/tcp.pop3."&lt;br />
;;&lt;br />
help)&lt;br />
cat &amp;lt; stop -- stops mail service (smtp connections refused, nothing goes out)&lt;br />
start -- starts mail service (smtp connection accepted, mail can go out)&lt;br />
pause -- temporarily stops mail service (connections accepted, nothing leaves)&lt;br />
cont -- continues paused mail service&lt;br />
stat -- displays status of mail service&lt;br />
cont -- continues paused mail service&lt;br />
stat -- displays status of mail service&lt;br />
cdb -- rebuild the tcpserver cdb file for smtp&lt;br />
restart -- stops and restarts smtp, sends qmail-send a TERM &amp;amp; restarts it&lt;br />
doqueue -- schedules queued messages for immediate delivery&lt;br />
reload -- sends qmail-send HUP, rereading locals and virtualdomains&lt;br />
queue -- shows status of queue&lt;br />
alrm -- same as doqueue&lt;br />
flush -- same as doqueue&lt;br />
hup -- same as reload&lt;br />
HELP&lt;br />
;;&lt;br />
*)&lt;br />
echo "Usage: $0 {start|stop|restart|doqueue|flush|reload|stat|pause|cont|cdb|queue|help}"&lt;br />
exit 1&lt;br />
;;&lt;br />
esac&lt;br />

exit 0&lt;br />

chmod 755 /var/qmail/bin/qmailctl&lt;br />
ln -s /var/qmail/bin/qmailctl /usr/bin&lt;br />
echo 20 &amp;gt; /var/qmail/control/concurrencyincoming&lt;br />
chmod 644 /var/qmail/control/concurrencyincoming&lt;br />

supervise 脚本&lt;br />
mkdir -p /var/qmail/supervise/qmail-send/log&lt;br />
mkdir -p /var/qmail/supervise/qmail-smtpd/log&lt;br />
mkdir -p /var/qmail/supervise/qmail-pop3d/log&lt;br />

qmail-send&lt;br />

/var/qmail/supervise/qmail-send/run&lt;br />

#!/bin/sh&lt;br />
exec /var/qmail/rc&lt;br />

/var/qmail/supervise/qmail-send/log/run&lt;br />

#!/bin/sh&lt;br />
exec /usr/local/bin/setuidgid qmaill /usr/local/bin/multilog t /var/log/qmail&lt;br />

qmail-smtpd&lt;br />

/var/qmail/supervise/qmail-smtpd/run&lt;br />

#!/bin/sh&lt;br />

#QMAILDUID=`id -u qmaild`&lt;br />
NOFILESGID=`id -g qmaild`&lt;br />
QMAILDUID=`id -u vpopmail`&lt;br />
QMAILDGID=`id -g vpopmail`&lt;br />

MAXSMTPD=`cat /var/qmail/control/concurrencyincoming`&lt;br />
LOCAL=`head -1 /var/qmail/control/me`&lt;br />
if [ -z "$QMAILDUID" -o -z "$NOFILESGID" -o -z "$MAXSMTPD" -o -z "$LOCAL" ]; then&lt;br />
echo QMAILDUID, NOFILESGID, MAXSMTPD, or LOCAL is unset in&lt;br />
echo /var/qmail/supervise/qmail-smtpd/run&lt;br />
exit 1&lt;br />
fi&lt;br />
if [ ! -f /var/qmail/control/rcpthosts ]; then&lt;br />
echo "No /var/qmail/control/rcpthosts!"&lt;br />
echo "Refusing to start SMTP listener because it'll create an open relay"&lt;br />
exit 1&lt;br />
fi&lt;br />
exec /usr/local/bin/softlimit -m 30000000&lt;br />
/usr/local/bin/tcpserver -v -H -R -l "$LOCAL" -x /etc/tcp.smtp.cdb -c "$MAXSMTPD"&lt;br />
-u "$QMAILDUID" -g "$QMAILDGID" 0 smtp /usr/local/bin/rblsmtpd -r relays.ordb.org&lt;br />
/var/qmail/bin/qmail-smtpd&lt;br />
/home/vpopmail/bin/vchkpw /bin/true /bin/cmd5checkpw /bin/true 2&amp;gt;&amp;amp;1&lt;br />

/var/qmail/supervise/qmail-smtpd/log/run&lt;br />

#!/bin/sh&lt;br />
exec /usr/local/bin/setuidgid qmaill /usr/local/bin/multilog t&lt;br />
/var/log/qmail/smtpd&lt;br />

qmail-pop3d&lt;br />

/var/qmail/supervise/qmail-pop3d/run&lt;br />

#!/bin/sh&lt;br />

LOCAL=`head -1 /var/qmail/control/me`&lt;br />

exec /usr/local/bin/softlimit -m 30000000&lt;br />
/usr/local/bin/tcpserver -x /etc/tcp.pop3.cdb&lt;br />
-H -l $LOCAL&lt;br />
-v -c 20 -R 0 pop3&lt;br />
/var/qmail/bin/qmail-popup $LOCAL&lt;br />
/home/vpopmail/bin/vchkpw /var/qmail/bin/qmail-pop3d Maildir 2&amp;gt;&amp;amp;1&lt;br />

/var/qmail/supervise/qmail-pop3d/log/run&lt;br />

#!/bin/sh&lt;br />
exec /usr/local/bin/setuidgid qmaill /usr/local/bin/multilog t&lt;br />
/var/log/qmail/pop3d&lt;br />

chmod 755 /var/qmail/supervise/qmail-send/run;chmod 755 /var/qmail/supervise/qmail-send/log/run&lt;br />
chmod 755 /var/qmail/supervise/qmail-smtpd/run;chmod 755 /var/qmail/supervise/qmail-smtpd/log/run&lt;br />
chmod 755 /var/qmail/supervise/qmail-pop3d/run;chmod 755 /var/qmail/supervise/qmail-pop3d/log/run&lt;br />
mkdir -p /var/log/qmail/smtpd;chown qmaill /var/log/qmail /var/log/qmail/smtpd&lt;br />
ln -s /var/qmail/supervise/qmail-send /var/qmail/supervise/qmail-smtpd /var/qmail/supervise/qmail-pop3d /service&lt;br />
touch .qmail-root .qmail-postmaster&lt;br />
ln -s .qmail-postmaster /var/qmail/alias/.qmail-mailer-daemon&lt;br />
chmod 644 /var/qmail/alias/.qmail-root /var/qmail/alias/.qmail-postmaster&lt;br />

clamav&lt;br />
http://www.clamav.net/&lt;br />
groupadd clamav&lt;br />
useradd -g clamav -s /sbin/nologin clamav -d /tmp&lt;br />
./configure&lt;br />
make check&lt;br />
make install&lt;br />

maildrop&lt;br />

./configure&lt;br />
make;make install-strip;make install-man&lt;br />

spamassassin&lt;br />

perl Makefile.PL&lt;br />
make&lt;br />
make install&lt;br />
cp spamd/redhat-rc-script.sh /etc/init.d/spamd&lt;br />

qmail-scanner&lt;br />

groupadd qscand;useradd -g qscand -s /sbin/nologin qscand -d /tmp&lt;br />
./configure --spooldir /var/qmailscan --qmaildir /var/qmail --bindir /var/qmail/bin --qmail-queue-binary&lt;br />
/var/qmail/bin/qmail-queue --admin postmaster --domain xxx.com --notify sender,admin --local-domains "xxx.com,xxx.com.cn,xxx.com.cn" --silent-viruses auto --debug yes --unzip 1&lt;br />
--block-password-protected 0 --add-dscr-hdrs 0 --archive 0 --redundant yes --log-details syslog --log-crypto 0&lt;br />
--fix-mime 2 --ignore-eol-check 0 --scanners "clamscan,fast_spamassassin"&lt;br />

cp qmail-scanner-queue.pl /var/qmail/bin&lt;br />
chown qscand:qscand /var/qmail/bin/qmail-scanner-queue.pl&lt;br />
chmod 4755 /var/qmail/bin/qmail-scanner-queue.pl&lt;br />
vi /etc/tcp.smtp&lt;br />

127.:allow,RELAYCLIENT="",MFDNSCHECK="",BADMIMETYPE="",RBLSMTPD="",QMAILQUEUE="/var/&lt;br />
qmail/bin/qmail-scanner-queue.pl"&lt;br />

qmailctl cdb&lt;br />
qmailctl restart&lt;br />
contrib/test_installation.sh -doit测试&lt;br /></description></item><item><title>Howto Qmail with spamassassin</title><link>https://wdicc.com/howto-qmail-with-spamassassin/</link><pubDate>Mon, 16 Jan 2006 00:00:00 +0000</pubDate><guid>https://wdicc.com/howto-qmail-with-spamassassin/</guid><description>http://sylvestre.ledru.info/howto/howto_qmail_spamassassin.php&lt;br />

By Sylvestre Ledru June 2003&lt;br />
Version francaise&lt;br />
Return to the linux page&lt;br />

(02/04/2002), Bug fix :&lt;br />
I just add a little bug fix for some OS which remove the +x on qmail-queue (the qmail-scanner is not concerned)&lt;br />
(01/11/2003), Qmail-scanner :&lt;br />
I had a new way of calling spamassassin client using qmail-scanner.&lt;br />
(23/07/2003), Preferences :&lt;br />
Matthew Francis sent me a quite good howto explaining how to get user preferences for spamassassin. It is available here.&lt;br />
(08/06/2003), Localisation :&lt;br />
If you want to change the language of the spam report (ie why the email has been tagged as a spam), just change the locales to your language (dpkg-reconfigure locales under debian) and install gettext (apt-get install gettext) and you will have the appropriate version (french for example)...&lt;br />
(11/03/2005), Update :&lt;br />
After almost two years without updates, my other howto about qmail is much more complet and uptodate, I clean this one :&lt;br />
- first method deprecated&lt;br />
- new version of spamassassin 3.0.X&lt;br />
- use of netqmail instead of qmail&lt;br />
- new version of qmail-scanner with the q-s-st patch (activation of Spamassassin just for a domain)&lt;br />

If you like this howto and you want to thank me for my work : here is my wishlist on Amazon - France or my Amazon US wishlist :)&lt;br />
If you are a corporation and you make some business thanks to my howto, we'll love to have a present from you (or just tell me who is using my howto).&lt;br />
Thank to Scott Kinkade for his cash donation. I really do appreciate.&lt;br />

If you want more informations about the intallation of qmail, I wrote a long howto about.&lt;br />
I wrote this howto because there is a lack of documentation about qmail with spamassassin.&lt;br />

This howto has been designed for qmail with vpopmail but it should work without a lot of modifications with something else than vpopmail.&lt;br />

Spamassassin is a very powerfull program which checks if the receveid email is a spam or not. The analys is based on a list of mark. If the sum of all the mark exceed a specified amount (for example 5), the email will be tagged (****SPAM**** in the topic).&lt;br />
With this, it is very easy to create a rule which will move all emails into a specific directory (i.e. trash:)&lt;br />

If you want to link Qmail with spamassassin, it is quite easy.&lt;br />
First, install spamassassin and install razor and pyzor if you want to use it.&lt;br />
Under debian :&lt;br />
apt-get install spamassassin You should use the "debian unstable or testing" version of spamassassin which, most of the time, will find more spam.&lt;br />

Under other system (Redhat, Suse, Solaris ...) : The latest version of spamassassin today is the version 3.0.2. The installation is almost the same, only a few directives changed.&lt;br />
wget http://useast.spamassassin.org/released/Mail-SpamAssassin-2.55.tar.gz&lt;br />
tar -zxvf Mail-SpamAssassin-2.55.tar.gz&lt;br />
cd Mail-SpamAssassin-2.55&lt;br />
perl Makefile.PL&lt;br />
make&lt;br />
make install&lt;br />
cp spamd/debian-rc-script.sh /etc/init.d/spamassassin You can replace debian by redhat, solaris, netbsd, suse ...&lt;br />
chmod +x /etc/init.d/spamassassin&lt;br />

Then, edit /etc/spamassassin/local.cf&lt;br />
Version 2.5X :&lt;br />
required_hits 6.0&lt;br />
rewrite_subject 1&lt;br />
report_header 1&lt;br />
use_terse_report 1&lt;br />
defang_mime 1&lt;br />
dns_available yes&lt;br />
dcc_add_header 1&lt;br />
use_pyzor 1 (Only if you have installed pyzor)&lt;br />
use_razor2 (Only if you have installed razor2)&lt;br />
use_dcc 1&lt;br />
Version 3 :&lt;br />
#Number of points to tag the spam required_hits 5.0 # Add the result in the header always_add_headers 1 # change the subject rewrite_subject 1 report_safe 1 use_terse_report 1 # dns checks (warning : increase the process length) dns_available yes dcc_add_header 0 # Don't skip the relay black list skip_rbl_checks 0 use_dcc 1 dcc_timeout 10 # Remote verification use_pyzor 1 pyzor_timeout 10 pyzor_add_header 1 # Never from the previous results auto_learn 1 # use the bayes filter use_bayes 1 # Where spamassassin must store these informations : bayes_path /var/qmail/spamassassin/ # Where he stores the auto white list results : auto_whitelist_path /var/qmail/spamassassin/auto_whitelist&lt;br />
If you want to have detailled information about spamassassin processing, add the line in the local.cf file : timelog_path /var/log/spamassassin, run the daemon with the -D option (so, specify it in the /etc/default/spamassassin file under debian), create the directory with appropriate rights (should be vpopmail). In the directory, you will have for each email a file which sum up the spamassassin process (it is a debug option !).&lt;br />

I use these rules. Feel free to change ! Documentation about this is available here : perldoc Mail::SpamAssassin::Conf&lt;br />

In /etc/default/spamassassin (if this file does not exist, create it)&lt;br />
Change ENABLED to 1, then add these options : - "-m 10 -v --auto-whitelist" for the version 2.5X.&lt;br />
- "-v -m 10 -u vpopmail --nouser-config" for the version 3&lt;br />
With that stuff, you can launch spamd which is bascilly a spamassassin deamon (provide great performances).&lt;br />
-m 10 =&amp;gt; 10 childs&lt;br />
-v =&amp;gt; vpopmail config&lt;br />
--auto-whitelist =&amp;gt; Use auto whitelist (friend list)&lt;br />
Instead of spamassassin, you have to use spamc in order to test email.&lt;br />
There are some options "-c -u vpopmail" which enabled the creation of preferences for a domain or a user but it does not work very well for me.&lt;br />
/etc/init.d/spamassassin start&lt;br />

Next, the modification of qmail in order to check emails.&lt;br />
Basically, there are two kind of configuration for qmail :&lt;br />
- the fastest/easiest way is to change the qmail-queue in order to "introduce" the spamasssin check.Deprecated&lt;br />
- the cleanest way is to use qmail-scanner.&lt;br />
Changing the qmail-queue program&lt;br />
cp /var/qmail/bin/qmail-queue /var/qmail/bin/qmail-queue.orig&lt;br />
chown qmailq:qmail qmail-queue&lt;br />
chown qmailq:qmail qmail-queue.orig&lt;br />
chmod u+s qmail-queue.orig&lt;br />
chmod o+r,+x qmail-queue.orig qmail-queue Not fundamental but sometime it is necessary (depends the system)&lt;br />

mkdir /home/vpopmail/.spamassassin&lt;br />
cd /home/vpopmail&lt;br />
chmod 777 /home/vpopmail/.spamassassin&lt;br />

chown -R qmailq:qmail .spamassassin&lt;br />
chmod u=rwx,g=rx,o= /home/vpopmail/.spamassassin&lt;br />
Now, delete the content of the executable which manage the queue.&lt;br />
echo -n &amp;gt; /var/qmail/bin/qmail-queue&lt;br />
Then, edit the qmail-queue file and add this inside :&lt;br />
#!/bin/sh&lt;br />
/usr/bin/spamc | /var/qmail/bin/qmail-queue.orig&lt;br />
I agree that it is a quick/dirty method. It causes some issues with the injection of a bounce in the queue. (qmail-queue is not planned to work this way).&lt;br />
With qmail-scanner - Visit http://sylvestre.ledru.info/howto/howto_qmail_vpopmail.php for more informations&lt;br />
First, you have to patch qmail with the qmailqueue-patch or install netqmail which has already this plugin.&lt;br />
Qmail with the patch :&lt;br />
wget http://qmail.agarik.com/qmail-1.03.tar.gz&lt;br />
tar -zxvf qmail-1.03.tar.gz&lt;br />
cd qmail-1.03&lt;br />
wget http://qmail.mirrored.ca/moni.csi.hu/pub/glibc-2.3.1/qmail-1.03.errno.patch&lt;br />
wget http://sylvestre.ledru.info/howto/qmail/qmailqueue-patch&lt;br />
patch -p1 &amp;lt; qmail-1.03.errno.patch&lt;br />
patch -p1 &amp;lt; qmailqueue-patch&lt;br />
With netqmail :&lt;br />
wget http://qmail.agarik.com/netqmail-1.05.tar.gz&lt;br />
tar -zxvf netqmail-1.05.tar.gz&lt;br />
cd netqmail-1.05/&lt;br />
./collate.sh&lt;br />
cd netqmail-1.05&lt;br />
Add the QMAILQUEUE parameter to the /etc/tcp.smtp file :&lt;br />
127.0.0.1:allow,RELAYCLIENT="",QMAILQUEUE="/var/qmail/bin/qmail-scanner-queue.pl"&lt;br />
198.168.1.:allow,RELAYCLIENT="",QMAILQUEUE="/var/qmail/bin/qmail-scanner-queue.pl"&lt;br />
:allow,QMAILQUEUE="/var/qmail/bin/qmail-scanner-queue.pl"&lt;br />
Rehash tcpserver :&lt;br />
/usr/local/bin/tcprules /etc/tcp.smtp.cdb /etc/tcp.smtp.tmp &amp;lt; /etc/tcp.smtp&lt;br />
chmod 644 /etc/tcp.smtp.cdb&lt;br />
And then, install qmail-scanner with qmail-scanner-st&lt;br />
. qmail-scanner-st is a patched version a qmail-scanner which enabled great features like auto delete/reject/quarantine spam over a specified score but also to select which scanners will be used for a domain and even for a user, then, it is possible to configure the spamassassin / antivirus just for one domain/user.&lt;br />
wget http://unc.dl.sourceforge.net/sourceforge/qmail-scanner/qmail-scanner-1.25.tgz wget http://xoomer.virgilio.it/j.toribio/qmail-scanner/download/q-s-1.25st-20050207.patch.gz&lt;br />
gunzip q-s-1.25st-20050207.patch.gz&lt;br />
tar -zxvf qmail-scanner-1.25.tgz&lt;br />
cd qmail-scanner-1.25/&lt;br />
patch -p1 &amp;lt; ../q-s-1.25st-20050207.patch&lt;br />
groupadd qscand&lt;br />
useradd -c "Qmail-Scanner Account" -g qscand -s /bin/false qscand&lt;br />
./configure --qs-user qscand --qs-group qscand --spooldir /var/spool/qmailscan --qmaildir /var/qmail --bindir /var/qmail/bin --qmail-queue-binary /var/qmail/bin/qmail-queue --admin-fromname "Mail admin" --admin postmaster --domain vladimir.avence.info --notify sender,admin,recips --local-domains `cat /var/qmail/control/rcpthosts | tr "\n" " "` --silent-viruses auto --unzip 1 --add-dscr-hdrs 1 --archive 0 --redundant yes --log-crypto 0 --scanners "fast_spamassassin" --scanners-per-domain yes --sa-subject "*****SPAM*****" --sa-delete 5 --install 1&lt;br />
After the installation, if you want to change your preferences, you have to edit the /var/qmail/bin/qmail-scanner-queue.pl file. In this file, you can also add option for the spamassassin client.&lt;br />
If you want to enable/disable some scanners, edit the /var/spool/qmailscan/scanners_per_domain.txt&lt;br />
To rehash the scanner per domain file : /var/qmail/bin/qmail-scanner-queue.pl -p&lt;br />
To rehash the quarantine attachement file : /var/qmail/bin/qmail-scanner-queue.pl -g&lt;br />
trunks.ecranbleu.org:sa,ps,clamdscan_scanner&lt;br />

# sa = spamassassin&lt;br />
# ps = perl scanner&lt;br />

This should be enough to use SpamAssassin on the whole system.&lt;br />
I have to try to find how it can be linked with vpopmail in order to create preference for a specific domain or a specific user. (if someone knows : sylvestre@ecranbleu.org)&lt;br />

Problems :&lt;br />
- link with vpopmail&lt;br />
This howto is inspired and corrected from :&lt;br />
http://www.euronet.nl/users/erhnam/linux/qmail/qmail.htm.&lt;br /></description></item><item><title>igenus</title><link>https://wdicc.com/igenus/</link><pubDate>Mon, 16 Jan 2006 00:00:00 +0000</pubDate><guid>https://wdicc.com/igenus/</guid><description>igenus需要给vpopmail数据库里添加几个表，同时还需要修改vpopmail表。添加了一个pw_id字段。没有这个这个字段，igenus里面不能修改密码（我就遇到这么一个情况）。&lt;br /></description></item><item><title>qmail中的几个error的产生的原因和解决方法</title><link>https://wdicc.com/solve-qmail-error/</link><pubDate>Mon, 16 Jan 2006 00:00:00 +0000</pubDate><guid>https://wdicc.com/solve-qmail-error/</guid><description>deferral: Unable_to_chdir_to_maildir._(#4.2.1)&lt;br />

 这个是qmail找不到用户的收信目录所致。如果你是用vpopmail的虚拟域名来管理的，那看看你的control/locals文件，里面不能有虚拟域名，只能有实际域名（这个实际域名的意思应该是使用系统用户作为用户的域，而不是使用vpopmail的虚拟用户的域）。因此呢，如果不是用 vpopmail，那么可能是系统用户的目录权限设置不正确。&lt;br />

如果发生这个错误，首先保证你没有对user/assign做过手动修改，添加域名都是使用vpopmail的vadddomin命令来添加的，没有修改过~vopmail/domins目录以及其下面目录的权限和属主，然后修改了locals文件之后重启应该就没有问题了。&lt;br />

deferral: Uh-oh:_.qmail_has_prog_delivery_but_has_x_bit_set._(#4.7.0)&lt;br />

 这个是因为你的.qmail文件设置了x属性，把.qmail文件的x去掉就ok了。这个.qmail文件就在你的domins/xxx.com下面，包括比如.qmail-default之类的文件，修改一下权限，去掉x就ok了。&lt;br />

454 oops, unable to write pipe and I can&amp;#39;t auth (#4.3.0)&lt;br />

 这个错误是在你打了smtp auth的补丁之后，却发现不能正常auth，输入了正确的用户名密码还是提示不正确。可以通过下面的命令来测试。&lt;br />

[root@caph qmail-smtpd]# telnet localhost 25&lt;br />
Trying 127.0.0.1...&lt;br />
Connected to localhost.&lt;br />
Escape character is &amp;#39;^]&amp;#39;.&lt;br />
220 xxx.com ESMTP&lt;br />
ehlo&lt;br />
250-xxx.com&lt;br />
250-PIPELINING&lt;br />
250-8BITMIME&lt;br />
250-SIZE 104857600&lt;br />
250 AUTH LOGIN PLAIN CRAM-MD5 //显示这个通常表示你已经打好了补丁，不过这个是可以通过修改qmail-smtpd.c文件来定制的。&lt;br />
auth login&lt;br />
334 VXNlcm5hbWU6&lt;br />
awefaq23rasdf&lt;br />
334 UGFzc3dvcmQ6&lt;br />
awefwaef&lt;br />
454 oops, unable to write pipe and I can&amp;#39;t auth (#4.3.0)&lt;br />
quit&lt;br />
221 xxx.com&lt;br />
Connection closed by foreign host.&lt;br />

出现了这种问题是因为smtp运行脚本没有设置正确的用户所致。将你的smtp的tcpserver命令的运行用户和组指定一下。&lt;br />

QMAILDUID=`id -u vpopmail`&lt;br />
QMAILDGID=`id -g vpopmail`&lt;br />

/usr/local/bin/tcpserver -v -H -R -l "$LOCAL" -x /etc/tcp.smtp.cdb -c "$MAXSMTPD"&lt;br />
 -u "$QMAILDUID" -g "$QMAILDGID" 0 smtp /usr/local/bin/rblsmtpd -r relays.ordb.org&lt;br />
 /var/qmail/bin/qmail-smtpd&lt;br />
 /home/vpopmail/bin/vchkpw /bin/true /bin/cmd5checkpw /bin/true 2>&amp;1&lt;br />

不需要修改~vpopmail/bin/vchkpw的属性。&lt;br />

451 qq write error or disk full (#4.3.0)&lt;br />

通常产生这个可能有2个原因：（1）你的qmail queue所在的磁盘空间不足。（2）qmail-scanner-queue的.pl权限设置不正确或者文件有问题。&lt;br />

qq temporary problem (#4.3.0)&lt;br />

看到的都是说不是suidperl就是qmail-scanner-queue.pl的权限设置不对这两个可能。&lt;br />
-rwsr-xr-x 1 qscand qscand 98594 12月 21 10:18 qmail-scanner-queue.pl&lt;br />

vchkpw-smtp: vpopmail user not found&lt;br />

查看/home/vpopmail/bin/vchkpw的属性和smtpd启动的用户名和组有没有问题。&lt;br /></description></item><item><title>Qmail的主要配置文件</title><link>https://wdicc.com/qmail-conf-file/</link><pubDate>Mon, 16 Jan 2006 00:00:00 +0000</pubDate><guid>https://wdicc.com/qmail-conf-file/</guid><description>1．Qmail的主要配置文件&lt;br />

 qmail的配置文件是由多个文件组成的，不是集中在一个文件中，每个文件控制相应&lt;br />
部分的功能和属性，一个可执行程序可能有多个配置文件控制，所有的配置文件共同决&lt;br />
定了qmail运行的实现和模式。这些配置文件都在qmail的control目录中，本文的配置文&lt;br />
件位于/var/qmail/control目录中&lt;br />

 1.1、badmailfrom&lt;br />

 这个配置文件是控制邮件系统拒绝接收的邮件地址和邮件域，主要是为了防止垃圾&lt;br />
邮件。如果一个邮件地址或者邮件域被列入到这个文件中，系统就会拒绝接收这个邮件&lt;br />
地址发来的邮件，或者拒绝邮件域下所有邮件地址发来的邮件。不过这个配置文件只是&lt;br />
一般的垃圾邮件防范手段，对于比较全面的垃圾邮件过滤技术还要靠第三方软件来实现&lt;br />
。该文件的格式如下：&lt;br />

 11@11.com //拒绝这个地址发来的邮件&lt;br />
 22@2w.com&lt;br />
 @33.com //拒绝这个邮件域下的所有帐号发来的邮件&lt;br />
 @44.com&lt;br />
&lt;br></description></item><item><title>qss不正常显示的问题</title><link>https://wdicc.com/a-bug-of-qss/</link><pubDate>Mon, 16 Jan 2006 00:00:00 +0000</pubDate><guid>https://wdicc.com/a-bug-of-qss/</guid><description>1 php3.x版本以上不正常显示&lt;br />

设置php.ini的&lt;font color="#FF0000">register_globals = On&lt;/font>&lt;br />

或者&lt;br />

修改getGraph.php添加&lt;br />
&lt;font color="#FF0000">$data=$_GET[&amp;#39;data&amp;#39;];&lt;br />
$t=$_GET[&amp;#39;t&amp;#39;];&lt;br />
修改getGraph1.php添加&lt;br />
$data=$_GET[&amp;#39;data&amp;#39;];&lt;br />
$s=$_GET[&amp;#39;s&amp;#39;];&lt;/font>&lt;br />

2 还不能正常显示&lt;br />

那可能你的qmail-scanner的版本是1.2以上的，此版本以上的log文件格式有些变化，qss却没有做相应更新，所以会有问题。你可以看看你的log文件的日期是不是下面这种格式&lt;br />
Mon, 03 Jan 2005 04:01:57 CST&lt;br />
如果是，那么差不多就是这个问题了。&lt;br />

解决方法是在index.php里面查找&lt;br />
&lt;font color="#FF0000"># Calc the date timestamp&lt;/font>&lt;br />
把他下面的5行语句用下面的替换&lt;br />
&lt;font color="#FF0000"> if ( eregi("(^[0-9]+)", $val[0]) )&lt;br />
 {&lt;br />
 # Calc the date timestamp&lt;br />
 $date = explode("/",$val[0]);&lt;br />
 $dateT = $date[0];&lt;br />
 $date[0] = $date[1];&lt;br />
 $date[1] = $dateT;&lt;br />
 $date = strtotime(implode("/",$date));&lt;br />
 }&lt;br />
 else&lt;br />
 {&lt;br />
 $date = strtotime ($val[0]);&lt;br />
 };&lt;br />
&lt;/font>&lt;br />

参考网址&lt;br />
&lt;a href="http://www.tnpi.biz/internet/mail/toaster/faq.shtml#how_do_i_get_qmailscanner_statistics_to_work" target="_blank">here&lt;/a>&lt;br /></description></item></channel></rss>